{
  "version": 3,
  "file": "xwing.js",
  "sourceRoot": "",
  "sources": [
    "xwing.src.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "###\r\n    X-Wing Squad Builder 2.5\r\n    Stephen Kim <raithos@gmail.com>\r\n    https://yasb.app\r\n###\r\n\r\nexportObj = exports ? this\r\n\r\nclass exportObj.SquadBuilderBackend\r\n    ###\r\n        Usage:\r\n\r\n            rebel_builder = new SquadBuilder\r\n                faction: 'Rebel Alliance'\r\n                ...\r\n            empire_builder = new SquadBuilder\r\n                faction: 'Galactic Empire'\r\n                ...\r\n            backend = new SquadBuilderBackend\r\n                server: 'https://xwing.example.com'\r\n                builders: [ rebel_builder, empire_builder ]\r\n                login_logout_button: '#login-logout'\r\n                auth_status: '#auth-status'\r\n\r\n    ###\r\n    constructor: (args) ->\r\n        # Might as well do this right away\r\n        $.ajaxSetup\r\n            dataType: \"json\" # Because Firefox sucks for some reason\r\n            xhrFields:\r\n                withCredentials: true\r\n\r\n        # args\r\n        @server = args.server\r\n        @builders = args.builders\r\n        @login_logout_button = $ args.login_logout_button\r\n        @auth_status = $ args.auth_status\r\n\r\n        @authenticated = false\r\n        @ui_ready = false\r\n        @oauth_window = null\r\n\r\n        @method_metadata =\r\n            google_oauth2:\r\n                icon: 'fab fa-google'\r\n                text: 'Google'\r\n            twitter:\r\n                icon: 'fab fa-twitter'\r\n                text: 'Twitter'\r\n            discord:\r\n                icon: 'fab fa-discord'\r\n                text: 'Discord'\r\n\r\n        @squad_display_mode = 'all'\r\n\r\n        @show_archived = false\r\n\r\n        @collection_save_timer = null\r\n        @collection_reset_timer = null\r\n\r\n        @setupHandlers()\r\n        @setupUI()\r\n\r\n        # Check initial authentication status\r\n        @authenticate () =>\r\n            @auth_status.hide()\r\n            @login_logout_button.removeClass 'd-none'\r\n\r\n        # Finally, hook up the builders\r\n        for builder in @builders\r\n            builder.setBackend this\r\n\r\n        @updateAuthenticationVisibility()\r\n\r\n    updateAuthenticationVisibility: () ->\r\n        if @authenticated\r\n            $('.show-authenticated').show()\r\n            $('.hide-authenticated').hide()\r\n        else\r\n            $('.show-authenticated').hide()\r\n            $('.hide-authenticated').show()\r\n\r\n    save: (serialized, id=null, name, faction, additional_data={}, cb) ->\r\n        if serialized == \"\"\r\n            cb\r\n                id: null\r\n                success: false\r\n                error: \"You cannot save an empty squad\"\r\n        else if $.trim(name) == \"\"\r\n            cb\r\n                id: null\r\n                success: false\r\n                error: \"Squad name cannot be empty\"\r\n        else if not faction? or faction == \"\"\r\n            throw \"Faction unspecified to save()\"\r\n        else\r\n            post_args =\r\n                name: $.trim(name)\r\n                faction: $.trim(faction)\r\n                serialized: serialized\r\n                additional_data: additional_data\r\n            if id?\r\n                post_url = \"#{@server}/squads/#{id}\"\r\n            else\r\n                post_url = \"#{@server}/squads/new\"\r\n                post_args['_method'] = 'put'\r\n            $.post post_url, post_args, (data, textStatus, jqXHR) =>\r\n                cb\r\n                    id: data.id\r\n                    success: data.success\r\n                    error: data.error\r\n\r\n    delete: (id, cb) ->\r\n        post_args =\r\n            '_method': 'delete'\r\n        $.post \"#{@server}/squads/#{id}\", post_args, (data, textStatus, jqXHR) =>\r\n            cb\r\n                success: data.success\r\n                error: data.error\r\n\r\n    archive: (data, faction, cb) ->\r\n        data.additional_data[\"archived\"] = true\r\n        @save(data.serialized, data.id, data.name, faction, data.additional_data, cb)\r\n\r\n    list: (builder) ->\r\n        # TODO: Pagination\r\n        @squad_list_modal.find('.modal-header .squad-list-header-placeholder').text(exportObj.translate('ui', \"yourXYsquads\", builder.faction))\r\n        list_ul = $ @squad_list_modal.find('ul.squad-list')\r\n        list_ul.text ''\r\n        list_ul.hide()\r\n        loading_pane = $ @squad_list_modal.find('p.squad-list-loading')\r\n        loading_pane.show()\r\n        @show_all_squads_button.click()\r\n        @squad_list_modal.modal 'show'\r\n\r\n        # This counter keeps tracked of the number of squads marked to be deleted (to hide the delete-selected button if none is selected)\r\n        @number_of_selected_squads_to_be_deleted = 0\r\n\r\n        #setup tag list\r\n        tag_list = []\r\n\r\n        url = \"#{@server}/squads/list\"\r\n        $.get url, (data, textStatus, jqXHR) =>\r\n            hasNotArchivedSquads = false\r\n            for squad in data[builder.faction]\r\n                li = $ document.createElement('LI')\r\n                li.addClass 'squad-summary'\r\n                li.data 'squad', squad\r\n                li.data 'builder', builder\r\n                li.data 'selectedForDeletion', false\r\n                list_ul.append li\r\n                \r\n                if squad.additional_data?.tag? and (squad.additional_data?.tag != \"\") and (tag_list.indexOf(squad.additional_data.tag) == -1)\r\n                    tag_array = squad.additional_data?.tag.split(\",\")\r\n                    for tag_entry in tag_array\r\n                        tag_list.push tag_entry\r\n                \r\n                if squad.additional_data?.archived?\r\n                    li.hide()\r\n                else\r\n                    hasNotArchivedSquads = true\r\n                \r\n                if squad.serialized.search(/v\\d+Zb/) != -1\r\n                    isxwa = \"\"\" <i class=\"xwing-miniatures-font xwing-miniatures-font-point\"></i>\"\"\"\r\n                else \r\n                    isxwa = \"\"\r\n\r\n                li.append $.trim \"\"\"\r\n                    <div class=\"row\">\r\n                        <div class=\"col-md-9\">\r\n                            <h4>#{squad.name}#{isxwa}</h4>\r\n                        </div>\r\n                        <div class=\"col-md-3\">\r\n                            <h5>#{squad.additional_data?.points} #{exportObj.translate('ui', \"Points\")}</h5>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"row squad-description\">\r\n                        <div class=\"col-md-9\">\r\n                            #{squad.additional_data?.description}\r\n                        </div>\r\n                        <div class=\"squad-buttons col-md-3\">\r\n                            <button class=\"btn btn-modal convert-squad\"><i class=\"xwing-miniatures-font xwing-miniatures-font-first-player-1\"></i></button>\r\n                            &nbsp;\r\n                            <button class=\"btn btn-modal load-squad\"><i class=\"fa fa-download\"></i></button>\r\n                            &nbsp;\r\n                            <button class=\"btn btn-danger delete-squad\"><i class=\"fa fa-times\"></i></button>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"row squad-convert-confirm\">\r\n                        <div class=\"col-md-9 translated\" defaultText=\"Convert to Extended?\">\r\n                        </div>\r\n                        <div class=\"squad-buttons col-md-3\">\r\n                            <button class=\"btn btn-danger confirm-convert-squad translated\" defaultText=\"Convert\"></button>\r\n                            &nbsp;\r\n                            <button class=\"btn btn-modal cancel-convert-squad translated\" defaultText=\"Cancel\"></button>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"row squad-delete-confirm\">\r\n                        <div class=\"col-md-6\">\r\n                            #{exportObj.translate('ui', 'reallyDeleteSquadXY', \"<em>#{squad.name}</em>\")}\r\n                        </div>\r\n                        <div class=\"col-md-6 btn-group\">\r\n                            <button class=\"btn btn-danger confirm-delete-squad translated\" defaultText=\"Delete\"></button>\r\n                            <button class=\"btn confirm-archive-squad translated\" defaultText=\"Archive\"></button>\r\n                            <button class=\"btn btn-modal cancel-delete-squad translated\" defaultText=\"Unselect\"></button>\r\n                        </div>\r\n                    </div>\r\n                \"\"\"\r\n                li.find('.squad-convert-confirm').hide()\r\n                li.find('.squad-delete-confirm').hide()\r\n                \r\n                if squad.serialized.search(/v\\d+Zh/) == -1\r\n                    li.find('button.convert-squad').hide()\r\n                \r\n                li.find('button.convert-squad').click (e) =>\r\n                    e.preventDefault()\r\n                    button = $ e.target\r\n                    li = button.closest 'li'\r\n                    builder = li.data('builder')\r\n                    li.data 'selectedToConvert', true\r\n                    do (li) =>\r\n                        li.find('.squad-description').fadeOut 'fast', ->\r\n                            li.find('.squad-convert-confirm').fadeIn 'fast'\r\n                        \r\n                li.find('button.cancel-convert-squad').click (e) =>\r\n                    e.preventDefault()\r\n                    button = $ e.target\r\n                    li = button.closest 'li'\r\n                    builder = li.data('builder')\r\n                    li.data 'selectedToConvert', false\r\n                    do (li) =>\r\n                        li.find('.squad-convert-confirm').fadeOut 'fast', ->\r\n                            li.find('.squad-description').fadeIn 'fast'\r\n\r\n                li.find('button.confirm-convert-squad').click (e) =>\r\n                    e.preventDefault()\r\n                    button = $ e.target\r\n                    li = button.closest 'li'\r\n                    builder = li.data('builder')\r\n                    li.find('.cancel-convert-squad').fadeOut 'fast'\r\n                    li.find('.confirm-convert-squad').addClass 'disabled'\r\n                    li.find('.confirm-convert-squad').text 'Converting...'\r\n                    new_serialized = li.data('squad').serialized.replace('Zh','Zs')\r\n                    @save new_serialized, li.data('squad').id, li.data('squad').name, li.data('builder').faction, li.data('squad').additional_data, (results) =>\r\n                        if results.success\r\n                            li.data('squad').serialized = new_serialized \r\n                            li.find('.squad-convert-confirm').fadeOut 'fast', ->\r\n                                li.find('.squad-description').fadeIn 'fast'\r\n                                li.find('button.convert-squad').fadeOut 'fast'\r\n                        else\r\n                            li.html $.trim \"\"\"\r\n                                Error converting #{li.data('squad').name}: <em>#{results.error}</em>\r\n                            \"\"\"\r\n                    \r\n                li.find('button.load-squad').click (e) =>\r\n                    e.preventDefault()\r\n                    button = $ e.target\r\n                    li = button.closest 'li'\r\n                    builder = li.data('builder')\r\n                    @squad_list_modal.modal 'hide'\r\n                    if builder.current_squad.dirty\r\n                        @warnUnsaved builder, () ->\r\n                            builder.container.trigger 'xwing-backend:squadLoadRequested', li.data('squad')\r\n                    else\r\n                        builder.container.trigger 'xwing-backend:squadLoadRequested', li.data('squad')\r\n\r\n                li.find('button.delete-squad').click (e) =>\r\n                    e.preventDefault()\r\n                    button = $ e.target\r\n                    li = button.closest 'li'\r\n                    builder = li.data('builder')\r\n                    li.data 'selectedForDeletion', true\r\n                    do (li) =>\r\n                        li.find('.squad-description').fadeOut 'fast', ->\r\n                            li.find('.squad-delete-confirm').fadeIn 'fast'\r\n                        # show delete multiple section if not yet shown\r\n                        if not @number_of_selected_squads_to_be_deleted\r\n                            @squad_list_modal.find('div.delete-multiple-squads').show()\r\n                    # increment counter\r\n                    @number_of_selected_squads_to_be_deleted += 1\r\n\r\n\r\n                li.find('button.cancel-delete-squad').click (e) =>\r\n                    e.preventDefault()\r\n                    button = $ e.target\r\n                    li = button.closest 'li'\r\n                    builder = li.data('builder')\r\n                    li.data 'selectedForDeletion', false\r\n                    # decrement counter\r\n                    @number_of_selected_squads_to_be_deleted -= 1\r\n                    do (li) =>\r\n                        li.find('.squad-delete-confirm').fadeOut 'fast', ->\r\n                            li.find('.squad-description').fadeIn 'fast'\r\n                        # hide delete multiple section if this was the last selected squad\r\n                        if not @number_of_selected_squads_to_be_deleted\r\n                            @squad_list_modal.find('div.delete-multiple-squads').hide()\r\n\r\n                li.find('button.confirm-delete-squad').click (e) =>\r\n                    e.preventDefault()\r\n                    button = $ e.target\r\n                    li = button.closest 'li'\r\n                    builder = li.data('builder')\r\n                    li.find('.cancel-delete-squad').fadeOut 'fast'\r\n                    li.find('.confirm-delete-squad').addClass 'disabled'\r\n                    li.find('.confirm-delete-squad').text 'Deleting...'\r\n                    @delete li.data('squad').id, (results) =>\r\n                        if results.success\r\n                            li.slideUp 'fast', ->\r\n                                $(li).remove()\r\n                            # decrement counter\r\n                            @number_of_selected_squads_to_be_deleted -= 1\r\n                            # hide delete multiple section if this was the last selected squad\r\n                            if not @number_of_selected_squads_to_be_deleted\r\n                                @squad_list_modal.find('div.delete-multiple-squads').hide()\r\n                        else\r\n                            li.html $.trim \"\"\"\r\n                                Error deleting #{li.data('squad').name}: <em>#{results.error}</em>\r\n                            \"\"\"\r\n\r\n                li.find('button.confirm-archive-squad').click (e) =>\r\n                    e.preventDefault()\r\n                    button = $ e.target\r\n                    li = button.closest 'li'\r\n                    builder = li.data('builder')\r\n                    li.find('.confirm-delete-squad').addClass 'disabled'\r\n                    li.find('.confirm-delete-squad').text exportObj.translate('ui', 'Archiving...')\r\n                    @archive li.data('squad'), li.data('builder').faction, (results) =>\r\n                        if results.success\r\n                            li.slideUp 'fast', ->\r\n                                $(li).hide()\r\n                                $(li).find('.confirm-delete-squad').removeClass 'disabled'\r\n                                $(li).find('.confirm-delete-squad').text exportObj.translate('ui', 'Delete')\r\n                                $(li).data 'selectedForDeletion', false\r\n                                $(li).find('.squad-delete-confirm').fadeOut 'fast', ->\r\n                                    $(li).find('.squad-description').fadeIn 'fast'\r\n                            # decrement counter\r\n                            @number_of_selected_squads_to_be_deleted -= 1\r\n                            # hide delete multiple section if this was the last selected squad\r\n                            if not @number_of_selected_squads_to_be_deleted\r\n                                @squad_list_modal.find('div.delete-multiple-squads').hide()\r\n                        else\r\n                            li.html $.trim \"\"\"\r\n                                Error archiving #{li.data('squad').name}: <em>#{results.error}</em>\r\n                            \"\"\"\r\n\r\n\r\n            if not hasNotArchivedSquads\r\n                list_ul.append $.trim \"\"\"\r\n                    <li class=\"translated\" defaultText=\"No saved squads\"></li>\r\n                \"\"\"\r\n                \r\n            #setup Tags\r\n            @squad_list_tags.empty()\r\n            for tag in tag_list\r\n                tagclean = tag.toLowerCase().replace(/[^a-z0-9]/g, '').replace(/\\s+/g, '-')\r\n                \r\n                @squad_list_tags.append $.trim \"\"\" \r\n                    <button class=\"btn #{tagclean}\">#{tag}</button>\r\n                \"\"\"\r\n                tag_button = $ @squad_list_tags.find(\".#{tagclean}\")\r\n                tag_button.click (e) =>\r\n                    button = $ e.target\r\n                    buttontag = button.attr('class').replace('btn ','').replace('btn-inverse ','')\r\n                    @squad_list_modal.find('.squad-display-mode .btn').removeClass 'btn-inverse'\r\n                    @squad_list_tags.find('.btn').removeClass 'btn-inverse'\r\n                    button.addClass 'btn-inverse'\r\n                    @squad_list_modal.find('.squad-list li').each (idx, elem) ->\r\n                        if $(elem).data().squad.additional_data.tag?\r\n                            tag_array = $(elem).data().squad.additional_data.tag.split(\",\")\r\n                            found_tag = false\r\n                            for tag in tag_array\r\n                                if buttontag == tag.toLowerCase().replace(/[^a-z0-9]/g, '').replace(/\\s+/g, '-') then found_tag = true\r\n                            if found_tag then $(elem).show() else $(elem).hide()\r\n                        else\r\n                            $(elem).hide()\r\n\r\n            # some of the created html needs translation (e.g. buttons). Do that now.\r\n            exportObj.translateUIElements(list_ul)\r\n            loading_pane.fadeOut 'fast'\r\n            list_ul.fadeIn 'fast'\r\n\r\n    authenticate: (cb=$.noop) ->\r\n        $(@auth_status.find('.payload')).text exportObj.translate('ui', 'Checking auth status...')\r\n        @auth_status.show()\r\n        old_auth_state = @authenticated\r\n\r\n        $.ajax\r\n            url: \"#{@server}/ping\"\r\n            success: (data) =>\r\n                if data?.success\r\n                    @authenticated = true\r\n                else\r\n                    @authenticated = false\r\n                @maybeAuthenticationChanged old_auth_state, cb\r\n            error: (jqXHR, textStatus, errorThrown) =>\r\n                @authenticated = false\r\n                @maybeAuthenticationChanged old_auth_state, cb\r\n\r\n    maybeAuthenticationChanged: (old_auth_state, cb) =>\r\n        if old_auth_state != @authenticated\r\n            $(window).trigger 'xwing-backend:authenticationChanged', [ @authenticated, this ]\r\n        @oauth_window = null\r\n        @auth_status.hide()\r\n        cb @authenticated\r\n        @authenticated\r\n\r\n    login: () ->\r\n        # Display login dialog.\r\n        if @ui_ready\r\n            @login_modal.modal 'show'\r\n\r\n    logout: (cb=$.noop) ->\r\n        $(@auth_status.find('.payload')).text exportObj.translate('ui', 'Logging out...')\r\n        @auth_status.show()\r\n        $.get \"#{@server}/auth/logout\", (data, textStatus, jqXHR) =>\r\n            @authenticated = false\r\n            $(window).trigger 'xwing-backend:authenticationChanged', [ @authenticated, this ]\r\n            @auth_status.hide()\r\n            cb()\r\n\r\n    showSaveAsModal: (builder) ->\r\n        @save_as_modal.data 'builder', builder\r\n        @save_as_input.val builder.current_squad.name\r\n        @save_as_save_button.addClass 'disabled'\r\n        @nameCheck()\r\n        @save_as_modal.modal 'show'\r\n\r\n    showDeleteModal: (builder) ->\r\n        @delete_modal.data 'builder', builder\r\n        @delete_name_container.text builder.current_squad.name\r\n        @delete_modal.modal 'show'\r\n\r\n    nameCheck: () =>\r\n        window.clearInterval @save_as_modal.data('timer')\r\n        # trivial check\r\n        name = $.trim(@save_as_input.val())\r\n        if name.length == 0\r\n            @name_availability_container.text ''\r\n            @name_availability_container.append $.trim \"\"\"\r\n                <i class=\"fa fa-thumbs-down\"></i> #{exportObj.translate('ui', \"name required\")}\r\n            \"\"\"\r\n        else\r\n            $.post \"#{@server}/squads/namecheck\", { name: name }, (data) =>\r\n                @name_availability_container.text ''\r\n                if data.available\r\n                    @name_availability_container.append $.trim \"\"\"\r\n                        <i class=\"fa fa-thumbs-up\"></i> #{exportObj.translate('ui', \"Name is available\")}\r\n                    \"\"\"\r\n                    @save_as_save_button.removeClass 'disabled'\r\n                else\r\n                    @name_availability_container.append $.trim \"\"\"\r\n                        <i class=\"fa fa-thumbs-down\"></i> #{exportObj.translate('ui', \"Name in use\")}\r\n                    \"\"\"\r\n                    @save_as_save_button.addClass 'disabled'\r\n\r\n    warnUnsaved: (builder, action) ->\r\n        @unsaved_modal.data 'builder', builder\r\n        @unsaved_modal.data 'callback', action\r\n        @unsaved_modal.modal 'show'\r\n\r\n    setupUI: () ->\r\n        @auth_status.addClass 'disabled'\r\n        @auth_status.click (e) =>\r\n            false\r\n\r\n        @login_modal = $ document.createElement('DIV')\r\n        @login_modal.addClass 'modal fade d-print-none'\r\n        @login_modal.tabindex = \"-1\"\r\n        @login_modal.role = \"dialog\"\r\n        $(document.body).append @login_modal\r\n        @login_modal.append $.trim \"\"\"\r\n    <div class=\"modal-dialog modal-dialog-centered\" role=\"document\">\r\n        <div class=\"modal-content\">\r\n            <div class=\"modal-header\">\r\n                <h3 class=\"translated\" defaultText=\"Log in with OAuth\"></h3>\r\n                <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">&times;</button>\r\n            </div>\r\n            <div class=\"modal-body\">\r\n                <p>\r\n                    <span class=\"translated\" defaultText=\"select OAuth provider\"></span>\r\n                    <a class=\"login-help translated\" href=\"#\" defaultText=\"What's this?\"></a>\r\n                </p>\r\n                <div class=\"well well-small oauth-explanation\">\r\n                    <span class=\"translated\" defaultText=\"OAuth explanation\"></span>\r\n                    <button class=\"btn btn-modal translated\" defaultText=\"Got it!\"></button>\r\n                </div>\r\n                <ul class=\"login-providers inline\"></ul>\r\n                <p class=\"translated\" defaultText=\"Continue to OAuth provider\"></p>\r\n                <p class=\"translated\" defaultText=\"iOS requires cross-site control\"></p>\r\n                <p class=\"login-in-progress\">\r\n                    <em class=\"translated\" defaultText=\"login in progress\"></em>\r\n                </p>\r\n            </div>\r\n        </div>\r\n    </div>\r\n        \"\"\"\r\n        oauth_explanation = $ @login_modal.find('.oauth-explanation')\r\n        oauth_explanation.hide()\r\n        @login_modal.find('.login-in-progress').hide()\r\n        @login_modal.find('a.login-help').click (e) =>\r\n            e.preventDefault()\r\n            unless oauth_explanation.is ':visible'\r\n                oauth_explanation.slideDown 'fast'\r\n        oauth_explanation.find('button').click (e) =>\r\n            e.preventDefault()\r\n            oauth_explanation.slideUp 'fast'\r\n        $.get \"#{@server}/methods\", (data, textStatus, jqXHR) =>\r\n            methods_ul = $ @login_modal.find('ul.login-providers')\r\n            for method in data.methods\r\n                a = $ document.createElement('A')\r\n                a.addClass 'btn btn-modal'\r\n                a.data 'url', \"#{@server}/auth/#{method}\"\r\n                a.append \"\"\"<i class=\"#{@method_metadata[method].icon}\"></i>&nbsp;#{@method_metadata[method].text}\"\"\"\r\n                a.click (e) =>\r\n                    e.preventDefault()\r\n                    methods_ul.slideUp 'fast'\r\n                    @login_modal.find('.login-in-progress').slideDown 'fast'\r\n                    @oauth_window = window.open $(e.target).data('url'), \"xwing_login\"\r\n                li = $ document.createElement('LI')\r\n                li.append a\r\n                methods_ul.append li\r\n            @ui_ready = true\r\n\r\n        # this is dynamically created UI, so we need to translate it after creation\r\n        exportObj.translateUIElements(@login_modal)\r\n\r\n        @reload_done_modal = $ document.createElement('DIV')\r\n        @reload_done_modal.addClass 'modal fade d-print-none'\r\n        @reload_done_modal.tabindex = \"-1\"\r\n        @reload_done_modal.role = \"dialog\"\r\n        $(document.body).append @reload_done_modal\r\n        @reload_done_modal.append $.trim \"\"\"\r\n    <div class=\"modal-dialog modal-dialog-centered\" role=\"document\">\r\n        <div class=\"modal-content\">\r\n            <div class=\"modal-header\">\r\n                <h3>Reload Done</h3>\r\n                <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">&times;</button>\r\n            </div>\r\n            <div class=\"modal-body\">\r\n                <p class=\"translated\" defaultText=\"Squads reloaded\"></p>\r\n            </div>\r\n            <div class=\"modal-footer\">\r\n                <button class=\"btn btn-modal btn-primary translated\" aria-hidden=\"true\" data-dismiss=\"modal\" defaultText=\"Well done!\"></button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n        \"\"\"\r\n\r\n        # this is dynamically created UI, so we need to translate it after creation\r\n        exportObj.translateUIElements(@reload_done_modal)\r\n\r\n        @squad_list_modal = $ document.createElement('DIV')\r\n        @squad_list_modal.addClass 'modal fade d-print-none squad-list'\r\n        @squad_list_modal.tabindex = \"-1\"\r\n        @squad_list_modal.role = \"dialog\"\r\n        $(document.body).append @squad_list_modal\r\n        @squad_list_modal.append $.trim \"\"\"\r\n    <div class=\"modal-dialog modal-lg modal-dialog-scrollable modal-dialog-centered\" role=\"document\">\r\n        <div class=\"modal-content\">\r\n            <div class=\"modal-header\">\r\n                <h3 class=\"squad-list-header-placeholder d-none d-lg-block\"></h3>\r\n                <h4 class=\"squad-list-header-placeholder d-lg-none\"></h4>\r\n                <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">&times;</button>\r\n            </div>\r\n            <div class=\"modal-body\">\r\n                <ul class=\"squad-list\"></ul>\r\n                <p class=\"pagination-centered squad-list-loading\">\r\n                    <i class=\"fa fa-spinner fa-spin fa-3x\"></i>\r\n                    <br />\r\n                    <span class=\"translated\" defaultText=\"Fetching squads...\"></span>\r\n                </p>\r\n            </div>\r\n            <div class=\"modal-footer\">\r\n                <div class=\"btn-group delete-multiple-squads full-row\">\r\n                    <button class=\"btn btn-modal select-all translated\" defaultText=\"Select All\"></button>\r\n                    <button class=\"btn btn-modal archive-selected translated\" defaultText=\"Archive Selected\"></button>\r\n                    <button class=\"btn btn-modal btn-danger delete-selected translated\" defaultText=\"Delete Selected\"></button>\r\n                </div>\r\n                <div class=\"btn-group squad-display-mode full-row\">\r\n                    <button class=\"btn btn-modal btn-inverse show-all-squads translated\" defaultText=\"All\"></button>\r\n                    <button class=\"btn btn-modal show-standard-squads\"><span class=\"d-none d-lg-block translated\" defaultText=\"Standard\"></span><span class=\"d-lg-none\"><i class=\"xwing-miniatures-font xwing-miniatures-font-first-player-1\"></i></span></button>\r\n                    <button class=\"btn btn-modal show-extended-squads\"><span class=\"d-none d-lg-block translated\" defaultText=\"Extended\"></span><span class=\"d-lg-none translated\" defaultText=\"Ext\"></span></button>\r\n                    <button class=\"btn btn-modal show-xwa-squads\"><span class=\"d-none d-lg-block translated\" defaultText=\"XWA\"></span><span class=\"d-lg-none\"><i class=\"xwing-miniatures-font xwing-miniatures-font-point\" title=\"Energy\"></i></span></button>\r\n                    <button class=\"btn btn-modal show-quickbuild-squads\"><span class=\"d-none d-lg-block translated\" defaultText=\"Quickbuild\"></span><span class=\"d-lg-none translated\" defaultText=\"QB\"></span></button>\r\n                    <button class=\"btn btn-modal show-epic-squads\"><span class=\"d-none d-lg-block translated\" defaultText=\"Epic\"></span><span class=\"d-lg-none\" ><i class=\"xwing-miniatures-font xwing-miniatures-font-energy\" title=\"Energy\"></i></span></button>\r\n                    <button class=\"btn btn-modal show-archived-squads\"><span class=\"d-none d-lg-block translated\" defaultText=\"Archived\"></span><span class=\"d-lg-none translated\" defaultText=\"Arc\"></span></button>\r\n                    <button class=\"btn btn-modal reload-all\" title=\"Recalculate Points\"><span><i class=\"xwing-miniatures-font xwing-miniatures-font-calculate\" title=\"Calculate\"></i></span></button>\r\n                </div>\r\n                <div class=\"btn-group tags-display full-row\">\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n        \"\"\"\r\n        @squad_list_modal.find('ul.squad-list').hide()\r\n\r\n        @squad_list_tags = $ @squad_list_modal.find('div.tags-display')\r\n        \r\n        # The delete multiple section only appeares, when somebody hits the delete button of one squad. \r\n        @squad_list_modal.find('div.delete-multiple-squads').hide() \r\n\r\n        # this is dynamically created UI, so we need to translate it after creation\r\n        exportObj.translateUIElements(@squad_list_modal)\r\n\r\n        @delete_selected_button = $ @squad_list_modal.find('button.delete-selected')\r\n        @delete_selected_button.click (e) =>\r\n            ul = @squad_list_modal.find('ul.squad-list') \r\n            for li in ul.find('li')\r\n                li = $ li\r\n                if li.data 'selectedForDeletion'\r\n                    do (li) =>\r\n                        li.find('.cancel-delete-squad').fadeOut 'fast'\r\n                        li.find('.confirm-delete-squad').addClass 'disabled'\r\n                        li.find('.confirm-delete-squad').text exportObj.translate('ui', 'Deleting...')\r\n                        @delete li.data('squad').id, (results) =>\r\n                            if results.success\r\n                                li.slideUp 'fast', ->\r\n                                    $(li).remove()\r\n                                # decrement counter\r\n                                @number_of_selected_squads_to_be_deleted -= 1\r\n                                # hide delete multiple section if this was the last selected squad\r\n                                if not @number_of_selected_squads_to_be_deleted\r\n                                    @squad_list_modal.find('div.delete-multiple-squads').hide()\r\n                            else\r\n                                li.html $.trim \"\"\"\r\n                                    Error deleting #{li.data('squad').name}: <em>#{results.error}</em>\r\n                                \"\"\"\r\n\r\n        @archive_selected_button = $ @squad_list_modal.find('button.archive-selected')\r\n        @archive_selected_button.click (e) =>\r\n            ul = @squad_list_modal.find('ul.squad-list') \r\n            for li in ul.find('li')\r\n                li = $ li\r\n                if li.data 'selectedForDeletion'\r\n                    do (li) =>\r\n                        li.find('.confirm-delete-squad').addClass 'disabled'\r\n                        li.find('.confirm-delete-squad').text exportObj.translate('ui', 'Archiving...')\r\n                        @archive li.data('squad'), li.data('builder').faction, (results) =>\r\n                            if results.success\r\n                                li.slideUp 'fast', ->\r\n                                    $(li).hide()\r\n                                    $(li).find('.confirm-delete-squad').removeClass 'disabled'\r\n                                    $(li).find('.confirm-delete-squad').text exportObj.translate('ui', 'Delete')\r\n                                    $(li).data 'selectedForDeletion', false\r\n                                    $(li).find('.squad-delete-confirm').fadeOut 'fast', ->\r\n                                        $(li).find('.squad-description').fadeIn 'fast'\r\n                                # decrement counter\r\n                                @number_of_selected_squads_to_be_deleted -= 1\r\n                                # hide delete multiple section if this was the last selected squad\r\n                                if not @number_of_selected_squads_to_be_deleted\r\n                                    @squad_list_modal.find('div.delete-multiple-squads').hide()\r\n                            else\r\n                                li.html $.trim \"\"\"\r\n                                    Error archiving #{li.data('squad').name}: <em>#{results.error}</em>\r\n                                \"\"\"\r\n\r\n        @squad_list_modal.find('button.reload-all').click (e) =>\r\n            ul = @squad_list_modal.find('ul.squad-list') \r\n            squadProcessingStack = [ () =>\r\n                @reload_done_modal.modal 'show' ]\r\n            squadDataStack = []\r\n            for li in ul.find('li')\r\n                li = $ li\r\n                squadDataStack.push li.data('squad')\r\n                builder = li.data('builder')\r\n                squadProcessingStack.push () => \r\n                    sqd = squadDataStack.pop()\r\n                    # console.log(\"loading \" + sqd.name)\r\n                    builder.container.trigger 'xwing-backend:squadLoadRequested', [ sqd, () =>\r\n                        additional_data =\r\n                            points: builder.total_points\r\n                            description: builder.describeSquad()\r\n                            cards: builder.listCards()\r\n                            notes: builder.notes.val().substr(0, 1024)\r\n                            obstacles: builder.getObstacles()\r\n                            tag: builder.tag.val().substr(0, 1024)\r\n                        # console.log(\"saving \" + builder.current_squad.name)\r\n                        @save builder.serialize(), builder.current_squad.id, builder.current_squad.name, builder.faction, additional_data, squadProcessingStack.pop() ]\r\n                        \r\n            @squad_list_modal.modal 'hide'\r\n            if builder.current_squad.dirty\r\n                    @warnUnsaved builder, squadProcessingStack.pop()\r\n            else\r\n                squadProcessingStack.pop()()\r\n\r\n\r\n        @select_all_button = $ @squad_list_modal.find('button.select-all')\r\n        @select_all_button.click (e) =>\r\n            ul = @squad_list_modal.find('ul.squad-list') \r\n            for li in ul.find('li')\r\n                li = $ li\r\n                if not li.data 'selectedForDeletion'\r\n                    li.data 'selectedForDeletion', true\r\n                    do (li) =>\r\n                        li.find('.squad-description').fadeOut 'fast', ->\r\n                             li.find('.squad-delete-confirm').fadeIn 'fast'\r\n                    @number_of_selected_squads_to_be_deleted += 1\r\n\r\n        @show_all_squads_button = $ @squad_list_modal.find('.show-all-squads')\r\n        @show_all_squads_button.click (e) =>\r\n            unless @squad_display_mode == 'all'\r\n                @squad_display_mode = 'all'\r\n                @squad_list_modal.find('.squad-display-mode .btn').removeClass 'btn-inverse'\r\n                @squad_list_tags.find('.btn').removeClass 'btn-inverse'\r\n                @show_all_squads_button.addClass 'btn-inverse'\r\n                @squad_list_modal.find('.squad-list li').show()\r\n\r\n        @show_extended_squads_button = $ @squad_list_modal.find('.show-extended-squads')\r\n        @show_extended_squads_button.click (e) =>\r\n            unless @squad_display_mode == 'extended'\r\n                @squad_display_mode = 'extended'\r\n                @squad_list_modal.find('.squad-display-mode .btn').removeClass 'btn-inverse'\r\n                @squad_list_tags.find('.btn').removeClass 'btn-inverse'\r\n                @show_extended_squads_button.addClass 'btn-inverse'\r\n                @squad_list_modal.find('.squad-list li').each (idx, elem) ->\r\n                    $(elem).toggle $(elem).data().squad.serialized.search(/v\\d+Zs/) != -1\r\n\r\n        @show_epic_squads_button = $ @squad_list_modal.find('.show-epic-squads')\r\n        @show_epic_squads_button.click (e) =>\r\n            unless @squad_display_mode == 'epic'\r\n                @squad_display_mode = 'epic'\r\n                @squad_list_modal.find('.squad-display-mode .btn').removeClass 'btn-inverse'\r\n                @squad_list_tags.find('.btn').removeClass 'btn-inverse'\r\n                @show_epic_squads_button.addClass 'btn-inverse'\r\n                @squad_list_modal.find('.squad-list li').each (idx, elem) ->\r\n                    $(elem).toggle $(elem).data().squad.serialized.search(/v\\d+Ze/) != -1\r\n\r\n        @show_standard_squads_button = $ @squad_list_modal.find('.show-standard-squads')\r\n        @show_standard_squads_button.click (e) =>\r\n            unless @squad_display_mode == 'standard'\r\n                @squad_display_mode = 'standard'\r\n                @squad_list_modal.find('.squad-display-mode .btn').removeClass 'btn-inverse'\r\n                @squad_list_tags.find('.btn').removeClass 'btn-inverse'\r\n                @show_standard_squads_button.addClass 'btn-inverse'\r\n                @squad_list_modal.find('.squad-list li').each (idx, elem) ->\r\n                    $(elem).toggle $(elem).data().squad.serialized.search(/v\\d+Zh/) != -1\r\n\r\n        @show_xwa_squads_button = $ @squad_list_modal.find('.show-xwa-squads')\r\n        @show_xwa_squads_button.click (e) =>\r\n            unless @squad_display_mode == 'xwa'\r\n                @squad_display_mode = 'xwa'\r\n                @squad_list_modal.find('.squad-display-mode .btn').removeClass 'btn-inverse'\r\n                @squad_list_tags.find('.btn').removeClass 'btn-inverse'\r\n                @show_xwa_squads_button.addClass 'btn-inverse'\r\n                @squad_list_modal.find('.squad-list li').each (idx, elem) ->\r\n                    $(elem).toggle $(elem).data().squad.serialized.search(/v\\d+Zb/) != -1\r\n\r\n\r\n        @show_quickbuild_squads_button = $ @squad_list_modal.find('.show-quickbuild-squads')\r\n        @show_quickbuild_squads_button.click (e) =>\r\n            unless @squad_display_mode == 'quickbuild'\r\n                @squad_display_mode = 'quickbuild'\r\n                @squad_list_modal.find('.squad-display-mode .btn').removeClass 'btn-inverse'\r\n                @squad_list_tags.find('.btn').removeClass 'btn-inverse'\r\n                @show_quickbuild_squads_button.addClass 'btn-inverse'\r\n                @squad_list_modal.find('.squad-list li').each (idx, elem) ->\r\n                    $(elem).toggle $(elem).data().squad.serialized.search(/v\\d+Zq/) != -1\r\n                    \r\n        @show_archived_squads_button = $ @squad_list_modal.find('.show-archived-squads')\r\n        @show_archived_squads_button.click (e) =>\r\n            @show_archived = not @show_archived\r\n            if @show_archived\r\n                @show_archived_squads_button.addClass 'btn-inverse'\r\n            else\r\n                @show_archived_squads_button.removeClass 'btn-inverse'\r\n            @squad_list_tags.find('.btn').removeClass 'btn-inverse'\r\n            @squad_list_modal.find('.squad-list li').each (idx, elem) =>\r\n                $(elem).toggle (($(elem).data().squad.additional_data.archived?) == @show_archived)\r\n\r\n        @save_as_modal = $ document.createElement('DIV')\r\n        @save_as_modal.addClass 'modal fade d-print-none'\r\n        @save_as_modal.tabindex = \"-1\"\r\n        @save_as_modal.role = \"dialog\"\r\n        $(document.body).append @save_as_modal\r\n        @save_as_modal.append $.trim \"\"\"\r\n    <div class=\"modal-dialog modal-dialog-centered\" role=\"document\">\r\n        <div class=\"modal-content\">\r\n            <div class=\"modal-header\">\r\n                <h3 class=\"translated\" defaultText=\"Save Squad As...\"></h3>\r\n                <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">&times;</button>\r\n            </div>\r\n            <div class=\"modal-body\">\r\n                <label for=\"xw-be-squad-save-as\">\r\n                    <span class=\"translated\" defaultText=\"New Squad Name\"></span>\r\n                    <input id=\"xw-be-squad-save-as\"></input>\r\n                </label>\r\n                <span class=\"name-availability\"></span>\r\n            </div>\r\n            <div class=\"modal-footer\">\r\n                <button class=\"btn btn-primary save translated\" aria-hidden=\"true\" defaultText=\"Save\"></button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n        \"\"\"\r\n        @save_as_modal.on 'shown', () =>\r\n            # Because Firefox handles this badly\r\n            window.setTimeout () =>\r\n                @save_as_input.focus()\r\n                @save_as_input.select()\r\n            , 100\r\n\r\n        @save_as_save_button = @save_as_modal.find('button.save')\r\n        @save_as_save_button.click (e) =>\r\n            e.preventDefault()\r\n            unless @save_as_save_button.hasClass('disabled')\r\n                timer = @save_as_modal.data('timer')\r\n                window.clearInterval(timer) if timer?\r\n                @save_as_modal.modal 'hide'\r\n                builder = @save_as_modal.data 'builder'\r\n                additional_data =\r\n                    points: builder.total_points\r\n                    description: builder.describeSquad()\r\n                    cards: builder.listCards()\r\n                    notes: builder.getNotes()\r\n                    obstacles: builder.getObstacles()\r\n                    tag: builder.getTag()\r\n                builder.backend_save_list_as_button.addClass 'disabled'\r\n                builder.backend_status.html $.trim \"\"\"\r\n                    <i class=\"fa fa-sync fa-spin\"></i>&nbsp;#{exportObj.translate('ui', 'Saving squad...')}\r\n                \"\"\"\r\n                builder.backend_status.show()\r\n                new_name = $.trim @save_as_input.val()\r\n                @save builder.serialize(), null, new_name, builder.faction, additional_data, (results) =>\r\n                    if results.success\r\n                        builder.current_squad.id = results.id\r\n                        builder.current_squad.name = new_name\r\n                        builder.current_squad.dirty = false\r\n                        builder.container.trigger 'xwing-backend:squadNameChanged'\r\n                        builder.container.trigger 'xwing-backend:squadDirtinessChanged'\r\n                        builder.backend_status.html $.trim \"\"\"\r\n                            <i class=\"fa fa-check\"></i>&nbsp;#{exportObj.translate('ui', 'New squad saved successfully.')}\r\n                        \"\"\"\r\n                    else\r\n                        builder.backend_status.html $.trim \"\"\"\r\n                            <i class=\"fa fa-exclamation-circle\"></i>&nbsp;#{results.error}\r\n                        \"\"\"\r\n                    builder.backend_save_list_as_button.removeClass 'disabled'\r\n\r\n        @save_as_input = $ @save_as_modal.find('input')\r\n        @save_as_input.keypress (e) =>\r\n            if e.which == 13\r\n                @save_as_save_button.click()\r\n                false\r\n            else\r\n                @name_availability_container.text ''\r\n                @name_availability_container.append $.trim \"\"\"\r\n                    <i class=\"fa fa-spin fa-spinner\"></i> #{exportObj.translate('ui', 'Checking name availability...')}\r\n                \"\"\"\r\n                timer = @save_as_modal.data('timer')\r\n                window.clearInterval(timer) if timer?\r\n                @save_as_modal.data 'timer', window.setInterval(@nameCheck, 500)\r\n\r\n        @name_availability_container = $ @save_as_modal.find('.name-availability')\r\n\r\n        # this is dynamically created UI, so we need to translate it after creation\r\n        exportObj.translateUIElements(@squad_list_modal)\r\n\r\n        @delete_modal = $ document.createElement('DIV')\r\n        @delete_modal.addClass 'modal fade d-print-none'\r\n        @delete_modal.tabindex = \"-1\"\r\n        @delete_modal.role = \"dialog\"\r\n        $(document.body).append @delete_modal\r\n        @delete_modal.append $.trim \"\"\"\r\n    <div class=\"modal-dialog modal-dialog-centered\" role=\"document\">\r\n        <div class=\"modal-content\">\r\n            <div class=\"modal-header\">\r\n                <h3><span class=\"translated\" defaultText=\"Really Delete\"></span> <span class=\"squad-name-placeholder\"></span>?</h3>\r\n                <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">&times;</button>\r\n            </div>\r\n            <div class=\"modal-body\">\r\n                <p class=\"translated\" defaultText=\"Sure to delete?\"></p>\r\n            </div>\r\n            <div class=\"modal-footer\">\r\n                <button class=\"btn btn-danger delete\" aria-hidden=\"true\"><span class=\"translated\" defaultText=\"Yes, Delete\"></span> <i class=\"squad-name-placeholder\"></i></button>\r\n                <button class=\"btn btn-modal translated\" data-dismiss=\"modal\" aria-hidden=\"true\" defaultText=\"Never Mind\"></button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n        \"\"\"\r\n\r\n        @delete_name_container = $ @delete_modal.find('.squad-name-placeholder')\r\n        @delete_button = $ @delete_modal.find('button.delete')\r\n        @delete_button.click (e) =>\r\n            e.preventDefault()\r\n            builder = @delete_modal.data 'builder'\r\n            builder.backend_status.html $.trim \"\"\"\r\n                <i class=\"fa fa-sync fa-spin\"></i>&nbsp;#{exportObj.translate('ui', \"Deleting squad...\")}\r\n            \"\"\"\r\n            builder.backend_status.show()\r\n            builder.backend_delete_list_button.addClass 'disabled'\r\n            @delete_modal.modal 'hide'\r\n            @delete builder.current_squad.id, (results) =>\r\n                if results.success\r\n                    builder.resetCurrentSquad()\r\n                    builder.current_squad.dirty = true\r\n                    builder.container.trigger 'xwing-backend:squadDirtinessChanged'\r\n                    builder.backend_status.html $.trim \"\"\"\r\n                        <i class=\"fa fa-check\"></i>&nbsp;#{exportObj.translate('ui', \"Squad deleted.\")}\r\n                    \"\"\"\r\n                else\r\n                    builder.backend_status.html $.trim \"\"\"\r\n                        <i class=\"fa fa-exclamation-circle\"></i>&nbsp;#{results.error}\r\n                    \"\"\"\r\n                    # Failed, so offer chance to delete again\r\n                    builder.backend_delete_list_button.removeClass 'disabled'\r\n\r\n        # this is dynamically created UI, so we need to translate it after creation\r\n        exportObj.translateUIElements(@delete_modal)\r\n\r\n        @unsaved_modal = $ document.createElement('DIV')\r\n        @unsaved_modal.addClass 'modal fade d-print-none'\r\n        @unsaved_modal.tabindex = \"-1\"\r\n        @unsaved_modal.role = \"dialog\"\r\n        $(document.body).append @unsaved_modal\r\n        @unsaved_modal.append $.trim \"\"\"\r\n    <div class=\"modal-dialog modal-dialog-centered\" role=\"document\">\r\n        <div class=\"modal-content\">\r\n            <div class=\"modal-header\">\r\n                <h3 class=\"translated\" defaultText=\"Unsaved Changes\"></h3>\r\n                <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">&times;</button>\r\n            </div>\r\n            <div class=\"modal-body\">\r\n                <p class=\"translated\" defaultText=\"Unsaved Changes Warning\"></p>\r\n            </div>\r\n            <div class=\"modal-footer\">\r\n                <button class=\"btn btn-modal btn-primary translated\" aria-hidden=\"true\" data-dismiss=\"modal\" defaultText=\"Go Back\"></button>\r\n                <button class=\"btn btn-danger discard translated\" aria-hidden=\"true\" defaultText=\"Discard Changes\"></button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n        \"\"\"\r\n        @unsaved_discard_button = $ @unsaved_modal.find('button.discard')\r\n        @unsaved_discard_button.click (e) =>\r\n            e.preventDefault()\r\n            @unsaved_modal.data('builder').current_squad.dirty = false\r\n            @unsaved_modal.data('callback')()\r\n            @unsaved_modal.modal 'hide'\r\n\r\n        # this is dynamically created UI, so we need to translate it after creation\r\n        exportObj.translateUIElements(@unsaved_modal)\r\n\r\n    setupHandlers: () ->\r\n        $(window).on 'xwing-backend:authenticationChanged', (e, authenticated, backend) =>\r\n            @updateAuthenticationVisibility()\r\n            if authenticated\r\n                @loadCollection()\r\n\r\n        @login_logout_button.click (e) =>\r\n            e.preventDefault()\r\n            if @authenticated\r\n                @logout()\r\n            else\r\n                @login()\r\n\r\n        $(window).on 'message', (e) =>\r\n            ev = e.originalEvent\r\n            if ev.origin == @server\r\n                switch ev.data?.command\r\n                    when 'auth_successful'\r\n                        @authenticate()\r\n                        @login_modal.modal 'hide'\r\n                        @login_modal.find('.login-in-progress').hide()\r\n                        @login_modal.find('ul.login-providers').show()\r\n                        ev.source.close()\r\n                    else\r\n                        console.log \"Unexpected command #{ev.data?.command}\"\r\n            else\r\n                console.log \"Message received from unapproved origin #{ev.origin}\"\r\n                window.last_ev = e\r\n        .on 'xwing-collection:changed', (e, collection) =>\r\n            clearTimeout(@collection_save_timer) if @collection_save_timer?\r\n            @collection_save_timer = setTimeout =>\r\n                @saveCollection collection, (res) ->\r\n                    if res\r\n                        $(window).trigger 'xwing-collection:saved', collection\r\n            , 1000\r\n        .on 'xwing-collection:reset', (e, collection) =>\r\n            clearTimeout(@collection_save_timer) if @collection_save_timer?\r\n            @collection_save_timer = setTimeout =>\r\n                @resetCollection collection, (res) ->\r\n                    if res\r\n                        $(window).trigger 'xwing-collection:reset', collection\r\n            , 1000\r\n\r\n    getSettings: (cb=$.noop) ->\r\n        $.get(\"#{@server}/settings\").done (data, textStatus, jqXHR) =>\r\n            cb data.settings\r\n\r\n    set: (setting, value, cb=$.noop) ->\r\n        post_args =\r\n            \"_method\": \"PUT\"\r\n        post_args[setting] = value\r\n        $.post(\"#{@server}/settings\", post_args).done (data, textStatus, jqXHR) =>\r\n            cb data.set\r\n\r\n    deleteSetting: (setting, cb=$.noop) ->\r\n        $.post(\"#{@server}/settings/#{setting}\", {\"_method\": \"DELETE\"}).done (data, textStatus, jqXHR) =>\r\n            cb data.deleted\r\n\r\n    getHeaders: (cb=$.noop) ->\r\n        $.get(\"#{@server}/headers\").done (data, textStatus, jqXHR) =>\r\n            cb data.headers\r\n\r\n    getLanguagePreference: (settings, cb=$.noop) =>\r\n        # check if user provided a language preference. If yes, this will override the browser preference queried in translate.coffee\r\n        if settings?.language?\r\n            # we found a language, provide it with priority 10\r\n            cb settings.language, 10\r\n        # otherwise we may parse a language out of the headers \r\n        else\r\n            await @getHeaders (headers) ->\r\n                if headers?.HTTP_ACCEPT_LANGUAGE?\r\n                    # Need to parse out language preferences\r\n                    # console.log \"#{headers.HTTP_ACCEPT_LANGUAGE}\"\r\n                    for language_range in headers.HTTP_ACCEPT_LANGUAGE.split(',')\r\n                        [ language_tag, quality ] = language_range.split ';'\r\n                        # console.log \"#{language_tag}, #{quality}\"\r\n                        if language_tag == '*'\r\n                            # let's give that half priority\r\n                            cb 'English', -0.5\r\n                        else\r\n                            language_code = language_tag.split('-')[0]\r\n                            # check if the language code is available\r\n                            if language_code of exportObj.codeToLanguage\r\n                                # yep - use as language with reasonable priority\r\n                                cb(exportObj.codeToLanguage[language_code], 8)\r\n                            else\r\n                                # bullshit priority - we can't support what the user wants\r\n                                # (maybe he gave another option though in his browser settings)\r\n                                cb 'English', -1\r\n                        break\r\n                else\r\n                    # no headers, callback with bullshit priority\r\n                    cb 'English', -1\r\n\r\n    getCollectionCheck: (settings, cb=$.noop) =>\r\n        if settings?.collectioncheck?\r\n            cb settings.collectioncheck\r\n        else\r\n            @collectioncheck = true\r\n            cb true\r\n\r\n    resetCollection: (collection, cb=$.noop) ->\r\n        post_args =\r\n            expansions: {}\r\n            singletons: {}\r\n            checks: {}\r\n        $.post(\"#{@server}/collection\", post_args).done (data, textStatus, jqXHR) ->\r\n            cb data.success\r\n\r\n    saveCollection: (collection, cb=$.noop) ->\r\n        post_args =\r\n            expansions: collection.expansions\r\n            singletons: collection.singletons\r\n            checks: collection.checks\r\n        $.post(\"#{@server}/collection\", post_args).done (data, textStatus, jqXHR) ->\r\n            cb data.success\r\n\r\n    loadCollection: ->\r\n        # Backend provides an empty collection if none exists yet for the user.\r\n        $.get(\"#{@server}/collection\").done (data, textStatus, jqXHR) ->\r\n            collection = data.collection\r\n            new exportObj.Collection\r\n                expansions: collection.expansions\r\n                singletons: collection.singletons\r\n                checks: collection.checks\r\n            \r\n\r\n###\r\n    X-Wing Card Browser\r\n    Geordan Rosario <geordan@gmail.com>\r\n    https://github.com/geordanr/xwing\r\n    Advanced search by Patrick Mischke\r\n    https://github.com/patschke\r\n###\r\nexportObj = exports ? this\r\n\r\n# Assumes cards.js has been loaded\r\n\r\nTYPES = [ 'pilots', 'upgrades', 'ships', 'damage' ]\r\n\r\nbyName = (a, b) ->\r\n    if a.display_name\r\n        a_name = a.display_name.toLowerCase().replace(/[^a-zA-Z0-9]/g, '')\r\n    else\r\n        a_name = a.name.toLowerCase().replace(/[^a-zA-Z0-9]/g, '')\r\n    if b.display_name\r\n        b_name = b.display_name.toLowerCase().replace(/[^a-zA-Z0-9]/g, '')\r\n    else\r\n        b_name = b.name.toLowerCase().replace(/[^a-zA-Z0-9]/g, '')\r\n    if a_name < b_name\r\n        -1\r\n    else if b_name < a_name\r\n        1\r\n    else\r\n        0\r\n\r\nbyPoints = (a, b) ->\r\n    if a.data.points < b.data.points\r\n        -1\r\n    else if b.data.points < a.data.points\r\n        1\r\n    else\r\n        byName a, b\r\n\r\nString::capitalize = ->\r\n    this.charAt(0).toUpperCase() + this.slice(1)\r\n\r\nclass exportObj.CardBrowser\r\n    constructor: (args) ->\r\n        # args\r\n        @container = $ args.container\r\n\r\n        # internals\r\n        @currently_selected = null\r\n        @language = exportObj.currentLanguage ? 'English'\r\n\r\n        @prepareData()\r\n\r\n        @setupUI()\r\n        @setupHandlers()\r\n\r\n        # @renderList @sort_selector.val()\r\n\r\n    setupUI: () ->\r\n        @container.append $.trim \"\"\"\r\n            <div class=\"container-fluid xwing-card-browser\">\r\n                <div class=\"row\">\r\n                    <div class=\"col-md-4\">\r\n                        <div class=\"card card-search-container\">\r\n                        <h5 class=\"card-title translated\" defaultText=\"Card Search\"></h5>\r\n                            <div class=\"advanced-search-container\">\r\n                                <div class = \"card search-container general-search-container\">\r\n                                    <h6 class=\"card-subtitle mb-3 text-muted version translated\" defaultText=\"General\"></h6>\r\n                                    <label class = \"text-search advanced-search-label\">\r\n                                    <strong class=\"translated\" defaultText=\"Textsearch:\"></strong>\r\n                                        <input type=\"search\" placeholder=\"#{exportObj.translate('ui', \"Placeholder Textsearch Browser\")}\" class = \"card-search-text\">\r\n                                    </label>\r\n                                    <div class= \"advanced-search-faction-selection-container\">\r\n                                        <label class = \"advanced-search-label select-available-slots\">\r\n                                            <strong class=\"translated\" defaultText=\"Factions:\"></strong>\r\n                                            <select class=\"advanced-search-selection faction-selection\" multiple=\"1\" data-placeholder=\"#{exportObj.translate('ui', \"All factions\")}\"></select>\r\n                                        </label>\r\n                                    </div>\r\n                                    <div class = \"advanced-search-point-selection-container\">\r\n                                        <strong class=\"translated\" defaultText=\"Point cost:\"></strong>\r\n                                        <label class = \"advanced-search-label set-minimum-points\">\r\n                                            <span class=\"translated\" defaultText=\"from\"></span> <input type=\"number\" class=\"minimum-point-cost advanced-search-number-input\" value=\"0\" /> \r\n                                        </label>\r\n                                        <label class = \"advanced-search-label set-maximum-points\">\r\n                                            <span class=\"translated\" defaultText=\"to\"></span> <input type=\"number\" class=\"maximum-point-cost advanced-search-number-input\" value=\"20\" /> \r\n                                        </label>\r\n                                    </div>\r\n                                    <div class = \"advanced-search-loadout-selection-container\">\r\n                                        <strong class=\"translated\" defaultText=\"Loadout cost:\"></strong>\r\n                                        <label class = \"advanced-search-label set-minimum-loadout\">\r\n                                            <span class=\"translated\" defaultText=\"from\"></span> <input type=\"number\" class=\"minimum-loadout-cost advanced-search-number-input\" value=\"0\" /> \r\n                                        </label>\r\n                                        <label class = \"advanced-search-label set-maximum-loadout\">\r\n                                            <span class=\"translated\" defaultText=\"to\"></span> <input type=\"number\" class=\"maximum-loadout-cost advanced-search-number-input\" value=\"99\" /> \r\n                                        </label>\r\n                                    </div>\r\n                                    <div class = \"advanced-search-collection-container\">\r\n                                        <strong class=\"translated\" defaultText=\"Owned copies:\"></strong>\r\n                                        <label class = \"advanced-search-label set-minimum-owned-copies\">\r\n                                            <span class=\"translated\" defaultText=\"from\"></span> <input type=\"number\" class=\"minimum-owned-copies advanced-search-number-input\" value=\"0\" /> \r\n                                        </label>\r\n                                        <label class = \"advanced-search-label set-maximum-owened-copies\">\r\n                                            <span class=\"translated\" defaultText=\"to\"></span> <input type=\"number\" class=\"maximum-owned-copies advanced-search-number-input\" value=\"99\" /> \r\n                                        </label>\r\n                                    </div>\r\n                                    <div class = \"advanced-search-misc-container\">\r\n                                        <strong class=\"translated\" defaultText=\"Misc:\"></strong>\r\n                                        <label class = \"advanced-search-label toggle-xwa\">\r\n                                            <input type=\"checkbox\" class=\"xwa-checkbox advanced-search-checkbox\" checked=\"checked\"/> <span class=\"translated\" defaultText=\"Use XWA points\"></span>\r\n                                        </label>\r\n                                        <label class = \"advanced-search-label toggle-unique\">\r\n                                            <input type=\"checkbox\" class=\"unique-checkbox advanced-search-checkbox\" /> <span class=\"translated\" defaultText=\"Is unique\"></span>\r\n                                        </label>\r\n                                        <label class = \"advanced-search-label toggle-non-unique\">\r\n                                            <input type=\"checkbox\" class=\"non-unique-checkbox advanced-search-checkbox\" /> <span class=\"translated\" defaultText=\"Is not unique\"></span>\r\n                                        </label>\r\n                                        <label class = \"advanced-search-label toggle-limited\">\r\n                                            <input type=\"checkbox\" class=\"limited-checkbox advanced-search-checkbox\" /> <span class=\"translated\" defaultText=\"Is limited\"></span>\r\n                                        </label>\r\n                                        <label class = \"advanced-search-label toggle-standard\">\r\n                                            <input type=\"checkbox\" class=\"standard-checkbox advanced-search-checkbox\" />  <span class=\"translated\" defaultText=\"Standard legal\"></span>\r\n                                        </label>\r\n                                    </div>\r\n                                </div>\r\n                                <div class = \"card search-container ship-search-container\">\r\n                                    <h6 class=\"card-subtitle mb-3 text-muted version translated\" defaultText=\"Ships and Pilots\"></h6>\r\n                                    <div class = \"advanced-search-slot-available-container\">\r\n                                        <label class = \"advanced-search-label select-available-slots\">\r\n                                            <strong class=\"translated\" defaultText=\"Slots:\"></strong>\r\n                                            <select class=\"advanced-search-selection slot-available-selection\" multiple=\"1\" data-placeholder=\"#{exportObj.translate('ui', \"noXYselected\", \"slots\")}\"></select>\r\n                                        </label>\r\n                                        <br />\r\n                                        <label class = \"advanced-search-label toggle-unique\">\r\n                                            <input type=\"checkbox\" class=\"duplicate-slots-checkbox advanced-search-checkbox\" /> <span class=\"translated\" defaultText=\"Has multiple of the chosen slots\"></span> \r\n                                        </label>\r\n                                    </div>\r\n                                    <div class = \"advanced-search-keyword-available-container\">\r\n                                        <label class = \"advanced-search-label select-available-keywords\">\r\n                                            <strong class=\"translated\" defaultText=\"Keywords:\"></strong>\r\n                                            <select class=\"advanced-search-selection keyword-available-selection\" multiple=\"1\" data-placeholder=\"#{exportObj.translate('ui', \"noXYselected\", \"keywords\")}\"></select>\r\n                                        </label>\r\n                                    </div>\r\n                                    <div class = \"advanced-search-actions-available-container\">\r\n                                        <label class = \"advanced-search-label select-available-actions\">\r\n                                            <strong class=\"translated\" defaultText=\"Actions:\"></strong>\r\n                                            <select class=\"advanced-search-selection action-available-selection\" multiple=\"1\" data-placeholder=\"#{exportObj.translate('ui', \"noXYselected\", \"actions\")}\"></select>\r\n                                        </label>\r\n                                    </div>\r\n                                    <div class = \"advanced-search-linkedactions-available-container\">\r\n                                        <label class = \"advanced-search-label select-available-linkedactions\">\r\n                                            <strong class=\"translated\" defaultText=\"Linked actions:\"></strong>\r\n                                            <select class=\"advanced-search-selection linkedaction-available-selection\" multiple=\"1\" data-placeholder=\"#{exportObj.translate('ui', \"noXYselected\", \"actions\")}\"></select>\r\n                                        </label>\r\n                                    </div>\r\n                                    <div class = \"advanced-search-ini-container\">\r\n                                        <strong class=\"translated\" defaultText=\"Initiative:\"></strong>\r\n                                        <label class = \"advanced-search-label set-minimum-ini\">\r\n                                            <span class=\"translated\" defaultText=\"from\"></span> <input type=\"number\" class=\"minimum-ini advanced-search-number-input\" value=\"0\" /> \r\n                                        </label>\r\n                                        <label class = \"advanced-search-label set-maximum-ini\">\r\n                                            <span class=\"translated\" defaultText=\"to\"></span> <input type=\"number\" class=\"maximum-ini advanced-search-number-input\" value=\"6\" /> \r\n                                        </label>\r\n                                    </div>\r\n                                    <div class = \"advanced-search-hull-container\">\r\n                                        <strong class=\"translated\" defaultText=\"Hull:\"></strong>\r\n                                        <label class = \"advanced-search-label set-minimum-hull\">\r\n                                            <span class=\"translated\" defaultText=\"from\"></span> <input type=\"number\" class=\"minimum-hull advanced-search-number-input\" value=\"0\" /> \r\n                                        </label>\r\n                                        <label class = \"advanced-search-label set-maximum-hull\">\r\n                                            <span class=\"translated\" defaultText=\"to\"></span> <input type=\"number\" class=\"maximum-hull advanced-search-number-input\" value=\"12\" /> \r\n                                        </label>\r\n                                    </div>\r\n                                    <div class = \"advanced-search-shields-container\">\r\n                                        <strong class=\"translated\" defaultText=\"Shields:\"></strong>\r\n                                        <label class = \"advanced-search-label set-minimum-shields\">\r\n                                            <span class=\"translated\" defaultText=\"from\"></span> <input type=\"number\" class=\"minimum-shields advanced-search-number-input\" value=\"0\" /> \r\n                                        </label>\r\n                                        <label class = \"advanced-search-label set-maximum-shields\">\r\n                                            <span class=\"translated\" defaultText=\"to\"></span> <input type=\"number\" class=\"maximum-shields advanced-search-number-input\" value=\"6\" /> \r\n                                        </label>\r\n                                    </div>\r\n                                    <div class = \"advanced-search-agility-container\">\r\n                                        <strong class=\"translated\" defaultText=\"Agility:\"></strong>\r\n                                        <label class = \"advanced-search-label set-minimum-agility\">\r\n                                            <span class=\"translated\" defaultText=\"from\"></span> <input type=\"number\" class=\"minimum-agility advanced-search-number-input\" value=\"0\" /> \r\n                                        </label>\r\n                                        <label class = \"advanced-search-label set-maximum-agility\">\r\n                                            <span class=\"translated\" defaultText=\"to\"></span> <input type=\"number\" class=\"maximum-agility advanced-search-number-input\" value=\"3\" /> \r\n                                        </label>\r\n                                    </div>\r\n                                    <div class = \"advanced-search-base-size-container\">\r\n                                        <strong class=\"translated\" defaultText=\"Base size:\"></strong>\r\n                                        <label class = \"advanced-search-label toggle-small-base\">\r\n                                            <input type=\"checkbox\" class=\"small-base-checkbox advanced-search-checkbox\" checked=\"checked\"/> <span class=\"translated\" defaultText=\"Small\"></span>\r\n                                        </label>\r\n                                        <label class = \"advanced-search-label toggle-medium-base\">\r\n                                            <input type=\"checkbox\" class=\"medium-base-checkbox advanced-search-checkbox\" checked=\"checked\"/> <span class=\"translated\" defaultText=\"Medium\"></span>\r\n                                        </label>\r\n                                        <label class = \"advanced-search-label toggle-large-base\">\r\n                                            <input type=\"checkbox\" class=\"large-base-checkbox advanced-search-checkbox\" checked=\"checked\"/> <span class=\"translated\" defaultText=\"Large\"></span>\r\n                                        </label>\r\n                                        <label class = \"advanced-search-label toggle-huge-base\">\r\n                                            <input type=\"checkbox\" class=\"huge-base-checkbox advanced-search-checkbox\" checked=\"checked\"/> <span class=\"translated\" defaultText=\"Huge\"></span>\r\n                                        </label>\r\n                                    </div>\r\n                                    <div class = \"advanced-search-attack-container\">\r\n                                        <strong><i class=\"xwing-miniatures-font xwing-miniatures-font-frontarc\"></i>:</strong>\r\n                                        <label class = \"advanced-search-label set-minimum-attack\">\r\n                                            <span class=\"translated\" defaultText=\"from\"></span> <input type=\"number\" class=\"minimum-attack advanced-search-number-input\" value=\"0\" /> \r\n                                        </label>\r\n                                        <label class = \"advanced-search-label set-maximum-attack\">\r\n                                            <span class=\"translated\" defaultText=\"to\"></span> <input type=\"number\" class=\"maximum-attack advanced-search-number-input\" value=\"5\" /> \r\n                                        </label>\r\n                                    </div>\r\n                                    <div class = \"advanced-search-attackt-container\">\r\n                                        <strong><i class=\"xwing-miniatures-font xwing-miniatures-font-singleturretarc\"></i>:</strong>\r\n                                        <label class = \"advanced-search-label set-minimum-attackt\">\r\n                                            <span class=\"translated\" defaultText=\"from\"></span> <input type=\"number\" class=\"minimum-attackt advanced-search-number-input\" value=\"0\" /> \r\n                                        </label>\r\n                                        <label class = \"advanced-search-label set-maximum-attackt\">\r\n                                            <span class=\"translated\" defaultText=\"to\"></span> <input type=\"number\" class=\"maximum-attackt advanced-search-number-input\" value=\"5\" /> \r\n                                        </label>\r\n                                    </div>\r\n                                    <div class = \"advanced-search-attackdt-container\">\r\n                                        <strong><i class=\"xwing-miniatures-font xwing-miniatures-font-doubleturretarc\"></i>:</strong>\r\n                                        <label class = \"advanced-search-label set-minimum-attackdt\">\r\n                                            <span class=\"translated\" defaultText=\"from\"></span> <input type=\"number\" class=\"minimum-attackdt advanced-search-number-input\" value=\"0\" /> \r\n                                        </label>\r\n                                        <label class = \"advanced-search-label set-maximum-attackdt\">\r\n                                            <span class=\"translated\" defaultText=\"to\"></span> <input type=\"number\" class=\"maximum-attackdt advanced-search-number-input\" value=\"5\" /> \r\n                                        </label>\r\n                                    </div>\r\n                                    <div class = \"advanced-search-attackf-container\">\r\n                                        <strong><i class=\"xwing-miniatures-font xwing-miniatures-font-fullfrontarc\"></i>:</strong>\r\n                                        <label class = \"advanced-search-label set-minimum-attackf\">\r\n                                            <span class=\"translated\" defaultText=\"from\"></span> <input type=\"number\" class=\"minimum-attackf advanced-search-number-input\" value=\"0\" /> \r\n                                        </label>\r\n                                        <label class = \"advanced-search-label set-maximum-attackf\">\r\n                                            <span class=\"translated\" defaultText=\"to\"></span> <input type=\"number\" class=\"maximum-attackf advanced-search-number-input\" value=\"5\" /> \r\n                                        </label>\r\n                                    </div>\r\n                                    <div class = \"advanced-search-attackb-container\">\r\n                                        <strong><i class=\"xwing-miniatures-font xwing-miniatures-font-reararc\"></i>:</strong>\r\n                                        <label class = \"advanced-search-label set-minimum-attackb\">\r\n                                            <span class=\"translated\" defaultText=\"from\"></span> <input type=\"number\" class=\"minimum-attackb advanced-search-number-input\" value=\"0\" /> \r\n                                        </label>\r\n                                        <label class = \"advanced-search-label set-maximum-attackb\">\r\n                                            <span class=\"translated\" defaultText=\"to\"></span> <input type=\"number\" class=\"maximum-attackb advanced-search-number-input\" value=\"5\" /> \r\n                                        </label>\r\n                                    </div>\r\n                                    <div class = \"advanced-search-attackbull-container\">\r\n                                        <strong><i class=\"xwing-miniatures-font xwing-miniatures-font-bullseyearc\"></i>:</strong>\r\n                                        <label class = \"advanced-search-label set-minimum-attackbull\">\r\n                                            <span class=\"translated\" defaultText=\"from\"></span> <input type=\"number\" class=\"minimum-attackbull advanced-search-number-input\" value=\"0\" /> \r\n                                        </label>\r\n                                        <label class = \"advanced-search-label set-maximum-attackbull\">\r\n                                            <span class=\"translated\" defaultText=\"to\"></span> <input type=\"number\" class=\"maximum-attackbull advanced-search-number-input\" value=\"5\" /> \r\n                                        </label>\r\n                                    </div>\r\n                                </div>\r\n                                <div class = \"card search-container other-stuff-search-container\">\r\n                                    <h6 class=\"card-subtitle mb-3 text-muted version translated\" defaultText=\"Other Stuff\"></h6>\r\n                                    <div class = \"advanced-search-slot-used-container\">\r\n                                        <label class = \"advanced-search-label select-used-slots\">\r\n                                            <strong class=\"translated\" defaultText=\"Used slot:\"></strong>\r\n                                            <select class=\"advanced-search-selection slot-used-selection\" multiple=\"1\" data-placeholder=\"#{exportObj.translate('ui', \"noXYselected\", \"slots\")}\"></select>\r\n                                        </label>\r\n                                    </div>\r\n                                    <div class = \"advanced-search-slot-used-second-slot-container\">\r\n                                        <label class = \"advanced-search-label select-used-second-slots\">\r\n                                            <strong class=\"translated\" defaultText=\"Used double-slot:\"></strong>\r\n                                            <select class=\"advanced-search-selection slot-used-second-selection\" multiple=\"1\" data-placeholder=\"#{exportObj.translate('ui', \"noXYselected\", \"slots\")}\"></select>\r\n                                        </label>\r\n                                        <br />\r\n                                        <label class = \"advanced-search-label has-a-second-slot\">\r\n                                            <input type=\"checkbox\" class=\"advanced-search-checkbox has-a-second-slot-checkbox\" /> <span class=\"translated\" defaultText=\"Only upgrades requiring multiple slots\"></span>\r\n                                        </label>\r\n                                    </div>\r\n                                    <div class = \"advanced-search-charge-container\">\r\n                                        <strong class=\"translated\" defaultText=\"Charges:\"></strong>\r\n                                        <label class = \"advanced-search-label set-minimum-charge\">\r\n                                            <span class=\"translated\" defaultText=\"from\"></span> <input type=\"number\" class=\"minimum-charge advanced-search-number-input\" value=\"0\" /> \r\n                                        </label>\r\n                                        <label class = \"advanced-search-label set-maximum-charge\">\r\n                                            <span class=\"translated\" defaultText=\"to\"></span> <input type=\"number\" class=\"maximum-charge advanced-search-number-input\" value=\"5\" /> \r\n                                        </label>\r\n                                        <br />\r\n                                        <label class = \"advanced-search-label has-recurring-charge\">\r\n                                            <input type=\"checkbox\" class=\"advanced-search-checkbox has-recurring-charge-checkbox\" checked=\"checked\"/> <span class=\"translated\" defaultText=\"Recurring\"></span>\r\n                                        </label>\r\n                                        <label class = \"advanced-search-label has-not-recurring-charge\">\r\n                                            <input type=\"checkbox\" class=\"advanced-search-checkbox has-not-recurring-charge-checkbox\" checked=\"checked\"/> <span class=\"translated\" defaultText=\"Not recurring\"></span>\r\n                                        </label>\r\n                                    <div class = \"advanced-search-force-container\">\r\n                                        <strong class=\"translated\" defaultText=\"Force:\"></strong>\r\n                                        <label class = \"advanced-search-label set-minimum-force\">\r\n                                            <span class=\"translated\" defaultText=\"from\"></span> <input type=\"number\" class=\"minimum-force advanced-search-number-input\" value=\"0\" /> \r\n                                        </label>\r\n                                        <label class = \"advanced-search-label set-maximum-force\">\r\n                                            <span class=\"translated\" defaultText=\"to\"></span> <input type=\"number\" class=\"maximum-force advanced-search-number-input\" value=\"3\" /> \r\n                                        </label>\r\n                                    </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"col-md-4 card-selecting-area\">\r\n                        <span class=\"translate sort-cards-by\" defaultText=\"Sort cards by\"></span><span class=\"translated\" defaultText=\"Sort by\">:</span> <select class=\"sort-by\">\r\n                            <option value=\"name\" class=\"translated\" defaultText=\"Name\"></option>\r\n                            <option value=\"source\" class=\"translated\" defaultText=\"Source\"></option>\r\n                            <option value=\"type-by-points\" class=\"translated\" defaultText=\"Type (by Points)\"></option>\r\n                            <option value=\"type-by-name\" selected=\"1\" class=\"translated\" defaultText=\"Type (by Name)\" selected=\"selected\">#{exportObj.translate('ui', 'Type (by Name)')}</option>\r\n                        </select>\r\n                        <div class=\"card-selector-container\">\r\n\r\n                        </div>\r\n                        <br>\r\n                        <div class=\"card-viewer-conditions-container\">\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"col-md-4\">\r\n                        <div class=\"card-viewer-container\">\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        \"\"\"\r\n\r\n        @card_selector_container = $ @container.find('.xwing-card-browser .card-selector-container')\r\n        @card_viewer_container = $ @container.find('.xwing-card-browser .card-viewer-container')\r\n        @card_viewer_container.append $.trim exportObj.builders[7].createInfoContainerUI(false)\r\n        @card_viewer_container.hide()\r\n        @card_viewer_conditions_container = $ @container.find('.xwing-card-browser .card-viewer-conditions-container')\r\n        @card_viewer_conditions_container.hide()\r\n        @advanced_search_container = $ @container.find('.xwing-card-browser .advanced-search-container')\r\n\r\n        @sort_selector = $ @container.find('select.sort-by')\r\n        @sort_selector.select2\r\n            minimumResultsForSearch: -1\r\n\r\n        # TODO: Make added inputs easy accessible\r\n\r\n        @card_search_text = ($ @container.find('.xwing-card-browser .card-search-text'))[0]\r\n        @faction_selection = ($ @container.find('.xwing-card-browser select.faction-selection'))\r\n        for faction, pilot of exportObj.pilotsByFactionXWS\r\n            opt = $ document.createElement('OPTION')\r\n            opt.val faction\r\n            opt.text exportObj.translate('faction', faction)\r\n            @faction_selection.append opt\r\n        factionless_option = $ document.createElement('OPTION')\r\n        factionless_option.val \"Factionless\"\r\n        factionless_option.text exportObj.translate('faction',\"Factionless\")\r\n        @faction_selection.append factionless_option\r\n        @faction_selection.select2\r\n            minimumResultsForSearch: if $.isMobile() then -1 else 0\r\n        \r\n        @minimum_point_costs = ($ @container.find('.xwing-card-browser .minimum-point-cost'))[0]\r\n        @maximum_point_costs = ($ @container.find('.xwing-card-browser .maximum-point-cost'))[0]\r\n        @minimum_loadout_costs = ($ @container.find('.xwing-card-browser .minimum-loadout-cost'))[0]\r\n        @maximum_loadout_costs = ($ @container.find('.xwing-card-browser .maximum-loadout-cost'))[0]\r\n        @use_xwa_points = ($ @container.find('.xwing-card-browser .xwa-checkbox'))[0]\r\n        @standard_checkbox = ($ @container.find('.xwing-card-browser .standard-checkbox'))[0]\r\n        @unique_checkbox = ($ @container.find('.xwing-card-browser .unique-checkbox'))[0]\r\n        @non_unique_checkbox = ($ @container.find('.xwing-card-browser .non-unique-checkbox'))[0]\r\n        @limited_checkbox = ($ @container.find('.xwing-card-browser .limited-checkbox'))[0]\r\n        @base_size_checkboxes = \r\n            Small: ($ @container.find('.xwing-card-browser .small-base-checkbox'))[0]\r\n            Medium: ($ @container.find('.xwing-card-browser .medium-base-checkbox'))[0]\r\n            Large: ($ @container.find('.xwing-card-browser .large-base-checkbox'))[0]\r\n            Huge: ($ @container.find('.xwing-card-browser .huge-base-checkbox'))[0]\r\n        @slot_available_selection = ($ @container.find('.xwing-card-browser select.slot-available-selection'))\r\n        for slot of exportObj.upgradesBySlotCanonicalName\r\n            opt = $ document.createElement('OPTION')\r\n            opt.val slot\r\n            opt.text exportObj.translate('slot', slot)\r\n            @slot_available_selection.append opt\r\n        @slot_available_selection.select2\r\n            minimumResultsForSearch: if $.isMobile() then -1 else 0\r\n        @keyword_available_selection = ($ @container.find('.xwing-card-browser select.keyword-available-selection'))\r\n        keyword_list = []\r\n        for keywords of exportObj.pilotsByKeyword\r\n            keyword_items = keywords.split(\",\")\r\n            for i in keyword_items\r\n                if (keyword_list.indexOf(i) < 0) and (i != \"undefined\")\r\n                    keyword_list.push(i)\r\n        keyword_list.sort()\r\n        for keyword_item in keyword_list\r\n            opt = $ document.createElement('OPTION')\r\n            opt.val keyword_item\r\n            opt.text exportObj.translate('keyword', keyword_item)\r\n            @keyword_available_selection.append opt\r\n        @keyword_available_selection.select2\r\n            minimumResultsForSearch: if $.isMobile() then -1 else 0\r\n        @duplicateslots = ($ @container.find('.xwing-card-browser .duplicate-slots-checkbox'))[0]\r\n        @action_available_selection = ($ @container.find('.xwing-card-browser select.action-available-selection'))\r\n        # ToDo: This does not seem like the correct place to have a list of all actions. Don't we have that elsewhere?!\r\n        for action in [\"Evade\",\"Focus\",\"Lock\",\"Boost\",\"Barrel Roll\",\"Calculate\",\"Reinforce\",\"Rotate Arc\",\"Coordinate\",\"Slam\",\"Reload\",\"Jam\",\"Cloak\"].sort()\r\n            opt = $ document.createElement('OPTION')\r\n            opt.text exportObj.translate('action', action)\r\n            opt.val action\r\n            @action_available_selection.append opt\r\n        @action_available_selection.select2\r\n            minimumResultsForSearch: if $.isMobile() then -1 else 0\r\n        @linkedaction_available_selection = ($ @container.find('.xwing-card-browser select.linkedaction-available-selection'))\r\n        for linkedaction in [\"Evade\",\"Focus\",\"Lock\",\"Boost\",\"Barrel Roll\",\"Calculate\",\"Reinforce\",\"Rotate Arc\",\"Coordinate\",\"Slam\",\"Reload\",\"Jam\",\"Cloak\"].sort()\r\n            opt = $ document.createElement('OPTION')\r\n            opt.text exportObj.translate('action', linkedaction)\r\n            opt.val linkedaction\r\n            @linkedaction_available_selection.append opt\r\n        @linkedaction_available_selection.select2\r\n            minimumResultsForSearch: if $.isMobile() then -1 else 0\r\n        @slot_used_selection = ($ @container.find('.xwing-card-browser select.slot-used-selection'))\r\n        for slot of exportObj.upgradesBySlotCanonicalName\r\n            opt = $ document.createElement('OPTION')\r\n            opt.text exportObj.translate('slot', slot)\r\n            opt.val slot\r\n            @slot_used_selection.append opt\r\n        @slot_used_selection.select2\r\n            minimumResultsForSearch: if $.isMobile() then -1 else 0\r\n        @slot_used_second_selection = ($ @container.find('.xwing-card-browser select.slot-used-second-selection'))\r\n        for slot of exportObj.upgradesBySlotCanonicalName\r\n            opt = $ document.createElement('OPTION')\r\n            opt.text exportObj.translate('slot', slot)\r\n            opt.val slot\r\n            @slot_used_second_selection.append opt\r\n        @slot_used_second_selection.select2\r\n            minimumResultsForSearch: if $.isMobile() then -1 else 0\r\n        @minimum_charge = ($ @container.find('.xwing-card-browser .minimum-charge'))[0]\r\n        @maximum_charge = ($ @container.find('.xwing-card-browser .maximum-charge'))[0]\r\n        @minimum_ini = ($ @container.find('.xwing-card-browser .minimum-ini'))[0]\r\n        @maximum_ini = ($ @container.find('.xwing-card-browser .maximum-ini'))[0]\r\n        @minimum_force = ($ @container.find('.xwing-card-browser .minimum-force'))[0]\r\n        @maximum_force = ($ @container.find('.xwing-card-browser .maximum-force'))[0]\r\n        @minimum_hull = ($ @container.find('.xwing-card-browser .minimum-hull'))[0]\r\n        @maximum_hull = ($ @container.find('.xwing-card-browser .maximum-hull'))[0]\r\n        @minimum_shields = ($ @container.find('.xwing-card-browser .minimum-shields'))[0]\r\n        @maximum_shields = ($ @container.find('.xwing-card-browser .maximum-shields'))[0]\r\n        @minimum_agility = ($ @container.find('.xwing-card-browser .minimum-agility'))[0]\r\n        @maximum_agility = ($ @container.find('.xwing-card-browser .maximum-agility'))[0]\r\n        @minimum_attack = ($ @container.find('.xwing-card-browser .minimum-attack'))[0]\r\n        @maximum_attack = ($ @container.find('.xwing-card-browser .maximum-attack'))[0]\r\n        @minimum_attackt = ($ @container.find('.xwing-card-browser .minimum-attackt'))[0]\r\n        @maximum_attackt = ($ @container.find('.xwing-card-browser .maximum-attackt'))[0]\r\n        @minimum_attackdt = ($ @container.find('.xwing-card-browser .minimum-attackdt'))[0]\r\n        @maximum_attackdt = ($ @container.find('.xwing-card-browser .maximum-attackdt'))[0]\r\n        @minimum_attackf = ($ @container.find('.xwing-card-browser .minimum-attackf'))[0]\r\n        @maximum_attackf = ($ @container.find('.xwing-card-browser .maximum-attackf'))[0]\r\n        @minimum_attackb = ($ @container.find('.xwing-card-browser .minimum-attackb'))[0]\r\n        @maximum_attackb = ($ @container.find('.xwing-card-browser .maximum-attackb'))[0]\r\n        @minimum_attackbull = ($ @container.find('.xwing-card-browser .minimum-attackbull'))[0]\r\n        @maximum_attackbull = ($ @container.find('.xwing-card-browser .maximum-attackbull'))[0]\r\n        @hassecondslot = ($ @container.find('.xwing-card-browser .has-a-second-slot-checkbox'))[0]\r\n        @recurring_charge = ($ @container.find('.xwing-card-browser .has-recurring-charge-checkbox'))[0]\r\n        @not_recurring_charge = ($ @container.find('.xwing-card-browser .has-not-recurring-charge-checkbox'))[0]\r\n        @minimum_owned_copies = ($ @container.find('.xwing-card-browser .minimum-owned-copies'))[0]\r\n        @maximum_owned_copies = ($ @container.find('.xwing-card-browser .maximum-owned-copies'))[0]\r\n\r\n        exportObj.translateUIElements(@container)\r\n\r\n    \r\n\r\n    setupHandlers: () ->\r\n        @sort_selector.change (e) =>\r\n            @renderList @sort_selector.val()\r\n        \r\n        #apparently @renderList takes a long time to load, so moving the loading to on button press\r\n        $(\"#browserTab\").on 'click', (e) =>\r\n            @renderList @sort_selector.val()\r\n\r\n        $(window).on 'xwing:afterLanguageLoad', (e, language, cb=$.noop) =>\r\n            #if @language != language\r\n            @language = language\r\n            @prepareData()\r\n            \r\n        .on 'xwing-collection:created', (e, collection) =>\r\n            @collection = collection\r\n        .on 'xwing-collection:destroyed', (e, collection) =>\r\n            @collection = null\r\n\r\n        @card_search_text.oninput = => @renderList @sort_selector.val()\r\n\r\n        # I find myself often searching for just text. To speed this up, we skip\r\n        # everything else until the first one is changed        \r\n        @skip_nontext_search = true\r\n        @faction_selection[0].onchange = => @renderList_advanced @sort_selector.val()\r\n        for basesize, checkbox of @base_size_checkboxes\r\n            checkbox.onclick = => @renderList_advanced @sort_selector.val()\r\n        @minimum_point_costs.oninput = => @renderList_advanced @sort_selector.val()\r\n        @maximum_point_costs.oninput = => @renderList_advanced @sort_selector.val()\r\n        @minimum_loadout_costs.oninput = => @renderList_advanced @sort_selector.val()\r\n        @maximum_loadout_costs.oninput = => @renderList_advanced @sort_selector.val()\r\n        @standard_checkbox.onclick = => @renderList_advanced @sort_selector.val()\r\n        @use_xwa_points.onclick = => @renderList_advanced @sort_selector.val()\r\n        @unique_checkbox.onclick = => @renderList_advanced @sort_selector.val()\r\n        @non_unique_checkbox.onclick = => @renderList_advanced @sort_selector.val()\r\n        @limited_checkbox.onclick = => @renderList_advanced @sort_selector.val()\r\n        @slot_available_selection[0].onchange = => @renderList_advanced @sort_selector.val()\r\n        @keyword_available_selection[0].onchange = => @renderList_advanced @sort_selector.val()\r\n        @duplicateslots.onclick = => @renderList_advanced @sort_selector.val()\r\n        @action_available_selection[0].onchange = => @renderList_advanced @sort_selector.val()\r\n        @linkedaction_available_selection[0].onchange = => @renderList_advanced @sort_selector.val()\r\n        @slot_used_selection[0].onchange = => @renderList_advanced @sort_selector.val()\r\n        @slot_used_second_selection[0].onchange = => @renderList_advanced @sort_selector.val()\r\n        @not_recurring_charge.onclick = => @renderList_advanced @sort_selector.val()\r\n        @recurring_charge.onclick = => @renderList_advanced @sort_selector.val()\r\n        @hassecondslot.onclick = => @renderList_advanced @sort_selector.val()\r\n        @minimum_charge.oninput = => @renderList_advanced @sort_selector.val()\r\n        @maximum_charge.oninput = => @renderList_advanced @sort_selector.val()\r\n        @minimum_ini.oninput = => @renderList_advanced @sort_selector.val()\r\n        @maximum_ini.oninput = => @renderList_advanced @sort_selector.val()\r\n        @minimum_hull.oninput = => @renderList_advanced @sort_selector.val()\r\n        @maximum_hull.oninput = => @renderList_advanced @sort_selector.val()\r\n        @minimum_force.oninput = => @renderList_advanced @sort_selector.val()\r\n        @maximum_force.oninput = => @renderList_advanced @sort_selector.val()\r\n        @minimum_shields.oninput = => @renderList_advanced @sort_selector.val()\r\n        @maximum_shields.oninput = => @renderList_advanced @sort_selector.val()\r\n        @minimum_agility.oninput = => @renderList_advanced @sort_selector.val()\r\n        @maximum_agility.oninput = => @renderList_advanced @sort_selector.val()\r\n        @minimum_attack.oninput = => @renderList_advanced @sort_selector.val()\r\n        @maximum_attack.oninput = => @renderList_advanced @sort_selector.val()\r\n        @minimum_attackt.oninput = => @renderList_advanced @sort_selector.val()\r\n        @maximum_attackt.oninput = => @renderList_advanced @sort_selector.val()\r\n        @minimum_attackdt.oninput = => @renderList_advanced @sort_selector.val()\r\n        @maximum_attackdt.oninput = => @renderList_advanced @sort_selector.val()\r\n        @minimum_attackf.oninput = => @renderList_advanced @sort_selector.val()\r\n        @maximum_attackf.oninput = => @renderList_advanced @sort_selector.val()\r\n        @minimum_attackb.oninput = => @renderList_advanced @sort_selector.val()\r\n        @maximum_attackb.oninput = => @renderList_advanced @sort_selector.val()\r\n        @minimum_attackbull.oninput = => @renderList_advanced @sort_selector.val()\r\n        @maximum_attackbull.oninput = => @renderList_advanced @sort_selector.val()\r\n        @minimum_owned_copies.oninput = => @renderList_advanced @sort_selector.val()\r\n        @maximum_owned_copies.oninput = => @renderList_advanced @sort_selector.val()\r\n\r\n\r\n    getPoints: (a) ->\r\n        if @use_xwa_points.checked and a.pointsxwa?\r\n            return a.pointsxwa\r\n        return a.points\r\n    getLoadout: (a) ->\r\n        if @use_xwa_points.checked and a.loadoutxwa?\r\n            return a.loadoutxwa\r\n        return a.loadout\r\n    getSlots: (a) ->\r\n        if @use_xwa_points.checked and a.slotsxwa?\r\n            return a.slotsxwa\r\n        return a.slots\r\n\r\n    prepareData: () ->\r\n        @all_cards = []\r\n\r\n        for type in TYPES\r\n            if type == 'upgrades'\r\n                @all_cards = @all_cards.concat ( { name: card_data.name, display_name: card_data.display_name, type: exportObj.translate('ui', 'upgradeHeader', card_data.slot), data: card_data, orig_type: card_data.slot } for card_name, card_data of exportObj[type] )\r\n            else if type == 'damage'\r\n                @all_cards = @all_cards.concat ( { name: card_data.name, display_name: card_data.display_name, type: exportObj.translate('ui', 'damageHeader', card_data.type), data: card_data, orig_type: \"Damage\" } for card_name, card_data of exportObj[type] )\r\n            else\r\n                @all_cards = @all_cards.concat ( { name: card_data.name, display_name: card_data.display_name, type: exportObj.translate('singular', type), data: card_data, orig_type: exportObj.translateToLang('English','singular', type) } for card_name, card_data of exportObj[type] )\r\n\r\n        @types = (exportObj.translate('types', type) for type in [ 'Pilot', 'Ship' ])\r\n        for card_name, card_data of exportObj.upgrades\r\n            upgrade_text = exportObj.translate 'ui', 'upgradeHeader', card_data.slot\r\n            @types.push upgrade_text if upgrade_text not in @types\r\n        for card_name, card_data of exportObj.damage\r\n            upgrade_text = exportObj.translate 'ui', 'damageHeader', card_data.type\r\n            @types.push upgrade_text if upgrade_text not in @types\r\n        \r\n\r\n        @all_cards.sort byName\r\n\r\n        @sources = []\r\n        for card in @all_cards\r\n            for source in card.data.sources\r\n                @sources.push(source) if source not in @sources\r\n\r\n        sorted_types = @types.sort()\r\n        sorted_sources = @sources.sort()\r\n\r\n        @cards_by_type_name = {}\r\n        for type in sorted_types\r\n            @cards_by_type_name[type] = ( card for card in @all_cards when card.type == type ).sort byName\r\n            # TODO: Functionality should not rely on translations. Here the translated type is used. Replace with orig_type and just display translation. Don't use it internally...\r\n\r\n        @cards_by_type_points = {}\r\n        for type in sorted_types\r\n            @cards_by_type_points[type] = ( card for card in @all_cards when card.type == type ).sort byPoints\r\n\r\n        @cards_by_source = {}\r\n        for source in sorted_sources\r\n            @cards_by_source[source] = ( card for card in @all_cards when source in card.data.sources ).sort byName\r\n\r\n    renderList_advanced: (sort_by='name') ->\r\n        @skip_nontext_search = false\r\n        @renderList sort_by\r\n\r\n    renderList: (sort_by='name') ->\r\n        # sort_by is one of `name`, `type-by-name`, `source`, `type-by-points`\r\n        #\r\n        # Renders multiselect to container\r\n        # Selects previously selected card if there is one\r\n        \r\n        if @use_xwa_points.checked?\r\n            exportObj.builders[7].isXwa = @use_xwa_points.checked\r\n\r\n        if @card_selector?\r\n            @card_selector.empty()\r\n        else\r\n            @card_selector = $ document.createElement('SELECT')\r\n            @card_selector.addClass 'card-selector'\r\n            @card_selector.attr 'size', 25\r\n            @card_selector_container.append @card_selector\r\n\r\n        @setupSearch()\r\n\r\n        switch sort_by\r\n            when 'type-by-name'\r\n                for type in @types\r\n                    optgroup = $ document.createElement('OPTGROUP')\r\n                    optgroup.attr 'label', type\r\n\r\n                    card_added = false\r\n                    for card in @cards_by_type_name[type]\r\n                        if @checkSearchCriteria card\r\n                            @addCardTo optgroup, card\r\n                            card_added = true\r\n                    if card_added\r\n                        @card_selector.append optgroup\r\n\r\n            when 'type-by-points'\r\n                for type in @types\r\n                    optgroup = $ document.createElement('OPTGROUP')\r\n                    optgroup.attr 'label', type\r\n                    \r\n                    card_added = false\r\n                    for card in @cards_by_type_points[type]\r\n                        if @checkSearchCriteria card\r\n                            @addCardTo optgroup, card\r\n                            card_added = true\r\n                    if card_added\r\n                        @card_selector.append optgroup\r\n            when 'source'\r\n                for source in @sources\r\n                    optgroup = $ document.createElement('OPTGROUP')\r\n                    optgroup.attr 'label', exportObj.translate('sources', source)\r\n                    \r\n                    card_added = false\r\n                    for card in @cards_by_source[source]\r\n                        if @checkSearchCriteria card\r\n                            @addCardTo optgroup, card\r\n                            card_added = true\r\n                    if card_added\r\n                        @card_selector.append optgroup\r\n            else\r\n                for card in @all_cards\r\n                    if @checkSearchCriteria card\r\n                        @addCardTo @card_selector, card\r\n\r\n        @card_selector.change (e) =>\r\n            @renderCard $(@card_selector.find(':selected'))\r\n\r\n    renderCard: (card) ->\r\n        # Renders card to card container\r\n        display_name = card.data 'display_name'\r\n        name = card.data 'name'\r\n        # type = card.data 'type'\r\n        data = card.data 'card'\r\n        orig_type = card.data 'orig_type'\r\n\r\n        if not (orig_type in ['Pilot', 'Ship', 'Quickbuild', 'Damage'])\r\n            add_opts = {addon_type: orig_type}\r\n            orig_type = 'Addon'\r\n\r\n        if orig_type == 'Pilot'\r\n            @card_viewer_container.find('tr.info-faction').show() # this information is not shown in the builder, since the faction is clear there, but usefull here. \r\n\r\n        @card_viewer_container.show()\r\n        exportObj.builders[7].showTooltip(orig_type, data, add_opts ? {}, @card_viewer_container) # we use the render method from the squad builder, cause it works.\r\n\r\n        # Conditions\r\n        if data?.applies_condition?\r\n            conditions = new Set()\r\n            if data.applies_condition instanceof Array\r\n                for condition in data.applies_condition\r\n                    conditions.add(exportObj.conditionsByCanonicalName[condition])\r\n            else\r\n                conditions.add(exportObj.conditionsByCanonicalName[data.applies_condition])\r\n            @card_viewer_conditions_container.text ''\r\n            conditions.forEach (condition) =>\r\n                condition_container = $ document.createElement('div')\r\n                condition_container.addClass 'conditions-container d-flex flex-wrap col-md-9'\r\n                condition_container.append conditionToHTML(condition)\r\n                @card_viewer_conditions_container.append condition_container\r\n            @card_viewer_conditions_container.show()\r\n        else\r\n            @card_viewer_conditions_container.hide()\r\n\r\n    addCardTo: (container, card) ->\r\n        option = $ document.createElement('OPTION')\r\n        option.text \"#{if card.display_name then card.display_name else card.name} (#{if @getPoints(card.data)? then @getPoints(card.data) else (if card.data.quantity? then card.data.quantity+'x' else '*')}#{if @getLoadout(card.data)? then \"/#{@getLoadout(card.data)}\" else ''})\"\r\n        option.data 'name', card.name\r\n        option.data 'display_name', card.display_name\r\n        option.data 'type', card.type\r\n        option.data 'card', card.data\r\n        option.data 'orig_type', card.orig_type\r\n        if @getCollectionNumber(card) == 0\r\n            option[0].classList.add('result-not-in-collection')\r\n        $(container).append option\r\n\r\n    getCollectionNumber: (card) ->\r\n        # returns number of copies of the given card in the collection, or -1 if no collection loaded\r\n        if not (exportObj.builders[7].collection? and exportObj.builders[7].collection.counts?)\r\n            return -1\r\n        owned_copies = 0\r\n        switch card.orig_type\r\n            when 'Pilot'\r\n                owned_copies = exportObj.builders[7].collection.counts.pilot?[card.name] ? 0\r\n            when 'Ship'\r\n                owned_copies = exportObj.builders[7].collection.counts.ship?[card.name] ? 0\r\n            else # type is e.g. astromech\r\n                owned_copies = exportObj.builders[7].collection.counts.upgrade?[card.name] ? 0\r\n        owned_copies\r\n\r\n    setupSearch: () ->\r\n        # do some stuff like fetching text inputs only once, as running it for each card is time consuming\r\n        @searchInputs = {\r\n            \"text\": @card_search_text.value.toLowerCase()\r\n            \"factions\": @faction_selection.val()            \r\n            \"required_slots\": @slot_available_selection.val()\r\n            \"required_actions\": @action_available_selection.val()\r\n            \"required_linked_actions\": @linkedaction_available_selection.val()\r\n            \"required_keywords\": @keyword_available_selection.val()\r\n            \"used_slots\": @slot_used_selection.val()\r\n            \"used_second_slots\": @slot_used_second_selection.val()\r\n        }\r\n\r\n        if \"Factionless\" in @searchInputs.factions\r\n            @searchInputs.factions.push undefined\r\n\r\n\r\n    checkSearchCriteria: (card) ->\r\n        # check for text search\r\n        if @searchInputs.text?\r\n            text_search = card.name.toLowerCase().indexOf(@searchInputs.text) > -1 or (card.data.text and card.data.text.toLowerCase().indexOf(@searchInputs.text) > -1) or (card.display_name and card.display_name.toLowerCase().indexOf(@searchInputs.text) > -1)\r\n            \r\n            if not text_search\r\n                return false unless card.data.ship\r\n                ship = card.data.ship\r\n                if ship instanceof Array\r\n                    text_in_ship = false\r\n                    for s in ship\r\n                        if s.toLowerCase().indexOf(@searchInputs.text) > -1 or (exportObj.ships[s].display_name and exportObj.ships[s].display_name.toLowerCase().indexOf(@searchInputs.text) > -1)\r\n                            text_in_ship = true\r\n                            break\r\n                    return false unless text_in_ship\r\n                else\r\n                    return false unless ship.toLowerCase().indexOf(@searchInputs.text) > -1 or (exportObj.ships[ship].display_name and exportObj.ships[ship].display_name.toLowerCase().indexOf(@searchInputs.text) > -1)\r\n    \r\n        # if no search field has changed, we are done here. \r\n        if @skip_nontext_search\r\n            return true\r\n\r\n        all_factions = (faction for faction, pilot of exportObj.pilotsByFactionXWS)\r\n        selected_factions = @searchInputs.factions\r\n        if selected_factions.length > 0\r\n            return false unless card.data.faction in selected_factions or card.orig_type == 'Ship' or card.data.faction instanceof Array\r\n            if card.data.faction instanceof Array\r\n               faction_matches = false\r\n               for faction in card.data.faction\r\n                   if faction in selected_factions\r\n                       faction_matches = true\r\n                       break\r\n               return false unless faction_matches\r\n            if card.orig_type == 'Ship'\r\n               faction_matches = false\r\n               for faction in card.data.factions\r\n                   if faction in selected_factions\r\n                       faction_matches = true\r\n                       break\r\n               return false unless faction_matches\r\n        else\r\n            selected_factions = all_factions\r\n\r\n        # check if standard only matches\r\n        if @standard_checkbox.checked\r\n            standard_legal = false\r\n            # check all factions specified by the card (which might be a single faction or an array of factions), or all selected factions if card does not specify any\r\n            for faction in (if card.data.faction? then (if Array.isArray(card.data.faction) then card.data.faction else [card.data.faction]) else selected_factions)\r\n                continue unless faction in selected_factions # e.g. ships should only be displayed if a legal faction is selected\r\n                standard_legal = standard_legal or exportObj.standardCheckBrowser(card.data, faction, card.orig_type)\r\n            return false unless standard_legal\r\n\r\n        # check for slot requirements\r\n        required_slots = @searchInputs.required_slots\r\n        if required_slots.length > 0\r\n            slots = @getSlots(card.data)\r\n            \r\n            for slot in required_slots\r\n                # special case for hardpoints\r\n                if not(((slot == \"Torpedo\") or (slot == \"Missile\") or (slot == \"Cannon\")) and (slots? and (\"HardpointShip\" in slots)))\r\n                    return false unless slots? and slot in slots\r\n                # check for duplciates\r\n                if @duplicateslots.checked\r\n                    hasDuplicates = slots.filter (x, i, self) ->\r\n                        (self.indexOf(x) == i && i != self.lastIndexOf(x)) and (x == slot)\r\n                    return false if hasDuplicates.length == 0\r\n\r\n        # check for keyword requirements\r\n        required_keywords = @searchInputs.required_keywords \r\n        if required_keywords.length > 0\r\n            keywords = card.data.keyword\r\n\r\n            for keyword in required_keywords\r\n                # special case for hardpoints\r\n                return false unless keywords? and keyword in keywords\r\n\r\n        # check for action requirements\r\n        required_actions = @searchInputs.required_actions\r\n        required_linked_actions = @searchInputs.required_linked_actions\r\n        if (required_actions.length > 0) or (required_linked_actions.length > 0)\r\n            actions = card.data.actions ? []\r\n            if card.orig_type == 'Pilot'\r\n                actions = card.data.ship_override?.actions ? exportObj.ships[card.data.ship].actions\r\n                actions = actions.concat (card.data.ship_override?.actionsred ? exportObj.ships[card.data.ship].actionsred)\r\n                if card.data.keyword? and (\"Droid\" in card.data.keyword)\r\n                    # Droid conversion of Focus to Calculate\r\n                    new_actions = []\r\n                    for action in actions\r\n                        if action?\r\n                            new_actions.push action.replace(\"Focus\",\"Calculate\")\r\n                    actions = new_actions\r\n        for action in required_actions ? []\r\n            return false unless actions? and ((action in actions) or ((\"F-\" + action) in actions) or ((\"R-\" + action) in actions))\r\n        for action in required_linked_actions ? []\r\n            return false unless actions? and (((\"R> \" + action) in actions) or ((\"> \" + action) in actions))\r\n\r\n        # check if point costs matches\r\n        if @minimum_point_costs.value > 0 or @maximum_point_costs.value < 20\r\n            return false unless (@getPoints(card.data) >= @minimum_point_costs.value and @getPoints(card.data) <= @maximum_point_costs.value) or (card.data.variablepoints?)\r\n            if card.data.variablepoints?\r\n                matching_points = false\r\n                variablepoints = @getPoints(card.data)\r\n                if Array.isArray(variablepoints)\r\n                    for points in variablepoints\r\n                        if points >= @minimum_point_costs.value and points <= @maximum_point_costs.value\r\n                            matching_points = true\r\n                            break\r\n                    return false unless matching_points\r\n            if card.orig_type == 'Ship' # check if pilot matching points exist\r\n                matching_points = false\r\n                for faction in selected_factions\r\n                    for name, pilots of exportObj.pilotsByFactionCanonicalName[faction]\r\n                        for pilot in pilots\r\n                            if pilot.ship == card.data.name\r\n                                if @getPoints(pilot) >= @minimum_point_costs.value and @getPoints(pilot) <= @maximum_point_costs.value\r\n                                    matching_points = true\r\n                                    break\r\n                        break if matching_points\r\n                    break if matching_points\r\n                return false unless matching_points\r\n\r\n        # check if loadout costs matches\r\n        if @minimum_loadout_costs.value > 0 or @maximum_loadout_costs.value < 99\r\n            return false unless (@getLoadout(card.data) >= @minimum_loadout_costs.value and @getLoadout(card.data) <= @maximum_loadout_costs.value)\r\n            if card.orig_type == 'Ship' # check if pilot matching points exist\r\n                matching_loadout = false\r\n                for faction in selected_factions\r\n                    for name, pilots of exportObj.pilotsByFactionCanonicalName[faction]\r\n                        for pilot in pilots\r\n                            if pilot.ship == card.data.name\r\n                                if @getLoadout(pilot) >= @minimum_loadout_costs.value and @getLoadout(pilot) <= @maximum_loadout_costs.value\r\n                                    matching_loadout = true\r\n                                    break\r\n                        break if matching_loadout\r\n                    break if matching_loadout\r\n                return false unless matching_loadout\r\n\r\n        # check if used slot matches\r\n        used_slots = @searchInputs.used_slots\r\n        if used_slots.length > 0\r\n            return false unless card.data.slot?\r\n            matches = false\r\n            for slot in used_slots\r\n                if card.data.slot == slot\r\n                    matches = true\r\n                    break\r\n            return false unless matches\r\n\r\n        # check if used second slot matchesexportObj.builders[7]\r\n        used_second_slots = @searchInputs.used_second_slots\r\n        if used_second_slots.length > 0\r\n            return false unless card.data.also_occupies_upgrades?\r\n            matches = false\r\n            for slot in used_second_slots\r\n                for adds in card.data.also_occupies_upgrades\r\n                    if adds == slot\r\n                        matches = true\r\n                        break\r\n            return false unless matches\r\n\r\n        # check if has a second slot\r\n        return false if not card.data.also_occupies_upgrades? and @hassecondslot.checked\r\n            \r\n        # check for uniqueness\r\n        return false unless not @unique_checkbox.checked or card.data.unique\r\n        return false unless not @non_unique_checkbox.checked or not card.data.unique\r\n        return false unless not @limited_checkbox.checked or card.data.max_per_squad\r\n        \r\n        # check charge stuff\r\n        return false unless (card.data.charge? and card.data.charge <= @maximum_charge.value and card.data.charge >= @minimum_charge.value) or (@minimum_charge.value <= 0 and not card.data.charge?)\r\n        return false if card.data.recurring and not @recurring_charge.checked\r\n        return false if card.data.charge and not card.data.recurring and not @not_recurring_charge.checked\r\n\r\n        # check collection status\r\n        if exportObj.builders[7].collection?.counts? # ignore collection stuff, if no collection available\r\n            owned_copies = @getCollectionNumber(card)\r\n            return false unless owned_copies >= @minimum_owned_copies.value and owned_copies <= @maximum_owned_copies.value\r\n\r\n        # check for ini\r\n        if card.data.skill?\r\n            return false unless card.data.skill >= @minimum_ini.value and card.data.skill <= @maximum_ini.value\r\n        else \r\n            # if the card has no ini value (is not a pilot) return false, if the ini criteria has been set (is not 0 to 6)\r\n            return false unless @minimum_ini.value <= 0 and @maximum_ini.value >= 6\r\n\r\n        # check for base size\r\n        if not (@base_size_checkboxes['Small'].checked and @base_size_checkboxes['Medium'].checked and @base_size_checkboxes['Large'].checked and @base_size_checkboxes['Huge'].checked)\r\n            size_matches = false\r\n            if card.orig_type == 'Ship'\r\n                if card.data.base?\r\n                    size_matches = size_matches or @base_size_checkboxes[card.data.base].checked\r\n                else\r\n                    size_matches = size_matches or @base_size_checkboxes['Small'].checked\r\n            else if card.orig_type == 'Pilot'\r\n                ship = exportObj.ships[card.data.ship]\r\n                if ship.base?\r\n                    size_matches = size_matches or @base_size_checkboxes[ship.base].checked\r\n                else\r\n                    size_matches = size_matches or @base_size_checkboxes['Small'].checked\r\n\r\n            return false unless size_matches\r\n\r\n        # check for hull\r\n        if @minimum_hull.value != \"0\" or @maximum_hull.value != \"12\"\r\n            return false unless (card.data.hull? and card.data.hull >= @minimum_hull.value and card.data.hull <= @maximum_hull.value) or (card.orig_type == 'Pilot' and exportObj.ships[card.data.ship].hull >= @minimum_hull.value and exportObj.ships[card.data.ship].hull <= @maximum_hull.value )\r\n       \r\n        # check for shields\r\n        if @minimum_shields.value != \"0\" or @maximum_shields.value != \"6\"\r\n            return false unless (card.data.shields? and card.data.shields >= @minimum_shields.value and card.data.shields <= @maximum_shields.value) or (card.orig_type == 'Pilot' and exportObj.ships[card.data.ship].shields >= @minimum_shields.value and exportObj.ships[card.data.ship].shields <= @maximum_shields.value )\r\n        \r\n        # check for agility\r\n        if @minimum_agility.value != \"0\" or @maximum_agility.value != \"3\"\r\n            return false unless (card.data.agility? and card.data.agility >= @minimum_agility.value and card.data.agility <= @maximum_agility.value) or (card.orig_type == 'Pilot' and exportObj.ships[card.data.ship].agility >= @minimum_agility.value and exportObj.ships[card.data.ship].agility <= @maximum_agility.value )\r\n                 \r\n        # check for attack\r\n        if @minimum_attack.value != \"0\" or @maximum_attack.value != \"5\"\r\n            return false unless (card.data.attack? and card.data.attack >= @minimum_attack.value and card.data.attack <= @maximum_attack.value) or (card.orig_type == 'Pilot' and ((exportObj.ships[card.data.ship].attack? and exportObj.ships[card.data.ship].attack >= @minimum_attack.value and exportObj.ships[card.data.ship].attack <= @maximum_attack.value ) or (not exportObj.ships[card.data.ship].attack? and @minimum_attack.value <= 0))) or (card.orig_type == 'Ship' and not card.data.attack? and @minimum_attack.value <= 0)\r\n        \r\n        # check for attackt\r\n        if @minimum_attackt.value != \"0\" or @maximum_attackt.value != \"5\"\r\n            return false unless (card.data.attackt? and card.data.attackt >= @minimum_attackt.value and card.data.attackt <= @maximum_attackt.value) or (card.orig_type == 'Pilot' and ((exportObj.ships[card.data.ship].attackt? and exportObj.ships[card.data.ship].attackt >= @minimum_attackt.value and exportObj.ships[card.data.ship].attackt <= @maximum_attackt.value ) or (not exportObj.ships[card.data.ship].attackt? and @minimum_attackt.value <= 0))) or (card.orig_type == 'Ship' and not card.data.attackt? and @minimum_attackt.value <= 0)\r\n         \r\n        # check for attackdt\r\n        if @minimum_attackdt.value != \"0\" or @maximum_attackdt.value != \"5\"\r\n            return false unless (card.data.attackdt? and card.data.attackdt >= @minimum_attackdt.value and card.data.attackdt <= @maximum_attackdt.value) or (card.orig_type == 'Pilot' and ((exportObj.ships[card.data.ship].attackdt? and exportObj.ships[card.data.ship].attackdt >= @minimum_attackdt.value and exportObj.ships[card.data.ship].attackdt <= @maximum_attackdt.value ) or (not exportObj.ships[card.data.ship].attackdt? and @minimum_attackdt.value <= 0))) or (card.orig_type == 'Ship' and not card.data.attackdt? and @minimum_attackdt.value <= 0)\r\n        \r\n        # check for attackf\r\n        if @minimum_attackf.value != \"0\" or @maximum_attackf.value != \"5\"\r\n            return false unless (card.data.attackf? and card.data.attackf >= @minimum_attackf.value and card.data.attackf <= @maximum_attackf.value) or (card.orig_type == 'Pilot' and ((exportObj.ships[card.data.ship].attackf? and exportObj.ships[card.data.ship].attackf >= @minimum_attackf.value and exportObj.ships[card.data.ship].attackf <= @maximum_attackf.value ) or (not exportObj.ships[card.data.ship].attackf? and @minimum_attackf.value <= 0))) or (card.orig_type == 'Ship' and not card.data.attackf? and @minimum_attackf.value <= 0)\r\n         \r\n        # check for attackb\r\n        if @minimum_attackb.value != \"0\" or @maximum_attackb.value != \"5\"\r\n            return false unless (card.data.attackb? and card.data.attackb >= @minimum_attackb.value and card.data.attackb <= @maximum_attackb.value) or (card.orig_type == 'Pilot' and ((exportObj.ships[card.data.ship].attackb? and exportObj.ships[card.data.ship].attackb >= @minimum_attackb.value and exportObj.ships[card.data.ship].attackb <= @maximum_attackb.value ) or (not exportObj.ships[card.data.ship].attackb? and @minimum_attackb.value <= 0))) or (card.orig_type == 'Ship' and not card.data.attackb? and @minimum_attackb.value <= 0)\r\n         \r\n        # check for attackbull\r\n        if @minimum_attackbull.value != \"0\" or @maximum_attackbull.value != \"5\"\r\n            return false unless (card.data.attackbull? and card.data.attackbull >= @minimum_attackbull.value and card.data.attackbull <= @maximum_attackbull.value) or (card.orig_type == 'Pilot' and ((exportObj.ships[card.data.ship].attackbull? and exportObj.ships[card.data.ship].attackbull >= @minimum_attackbull.value and exportObj.ships[card.data.ship].attackbull <= @maximum_attackbull.value ) or (not exportObj.ships[card.data.ship].attackbull? and @minimum_attackbull.value <= 0))) or (card.orig_type == 'Ship' and not card.data.attackbull? and @minimum_attackbull.value <= 0)\r\n         \r\n        # check for force\r\n        if @minimum_force.value != \"0\" or @maximum_force.value != \"3\"\r\n            return false unless (card.data.force? and card.data.force >= @minimum_force.value and card.data.force <= @maximum_force.value) or (card.orig_type == 'Pilot' and exportObj.ships[card.data.ship].force >= @minimum_force.value and exportObj.ships[card.data.ship].force <= @maximum_force.value ) or (!card.data.force? and @minimum_force.value == \"0\")\r\n            \r\n        #TODO: Add logic of addiditional search criteria here. Have a look at card.data, to see what data is available. Add search inputs at the todo marks above. \r\n\r\n        return true\r\n\r\n\r\n\r\n###\r\n    X-Wing Rules Browser\r\n    Stephen Kim <raithos@gmail.com>\r\n    https://github.com/raithos/xwing\r\n###\r\nexportObj = exports ? this\r\n\r\n# Assumes cards.js has been loaded\r\n\r\nclass exportObj.RulesBrowser\r\n    constructor: (args) ->\r\n        # args\r\n        @container = $ args.container\r\n\r\n        # internals\r\n        @language = exportObj.currentLanguage ? 'English'\r\n\r\n        @prepareRulesData()\r\n\r\n        @setupRuleUI()\r\n        @setupRulesHandlers()\r\n\r\n    setupRuleUI: () ->\r\n        @container.append $.trim \"\"\"\r\n            <div class=\"container-fluid xwing-rules-browser\">\r\n                <div class=\"row\">\r\n                    <div class=\"col-md-4\">\r\n                        <div class=\"card card-search-container\">\r\n                            <h5 class=\"card-title translated\" defaultText=\"Rules Search\"></h5>\r\n                            <div class=\"advanced-search-container\">\r\n                                <h6 class=\"card-subtitle mb-2 text-muted version\"><span class=\"translated\" defaultText=\"Version\"></span>: </h6>\r\n                                <label class = \"text-search advanced-search-label\">\r\n                                    <strong class=\"translated\" defaultText=\"Term:\"></strong>\r\n                                    <input type=\"search\" placeholder=\"#{exportObj.translate('ui', \"Search for game term or card\")}\" class = \"rule-search-text\">\r\n                                </label>\r\n                            </div>\r\n                            <div class=\"rules-container card-selector-container\">\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"col-md-8\">\r\n                        <div class=\"card card-viewer-container card-search-container\">\r\n                            <h4 class=\"card-title info-name\"></h4>\r\n                            <br />\r\n                            <p class=\"info-text\" />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        \"\"\"\r\n\r\n        @versionlabel = $ @container.find('.xwing-rules-browser .version')\r\n        @rule_selector_container = $ @container.find('.xwing-rules-browser .rules-container')\r\n        @rule_viewer_container = $ @container.find('.xwing-rules-browser .card-viewer-container')\r\n        @rule_viewer_container.hide()\r\n        @advanced_search_container = $ @container.find('.xwing-rules-browser .advanced-search-container')\r\n\r\n        exportObj.translateUIElements(@container)\r\n\r\n        # TODO: Make added inputs easy accessible\r\n        \r\n        version = @all_rules.version.number\r\n        date = @all_rules.version.date\r\n        @versionlabel.append \"#{version}, #{date}\"\r\n\r\n        @rule_search_rules_text = ($ @container.find('.xwing-rules-browser .rule-search-text'))[0]\r\n\r\n    setupRulesHandlers: () ->\r\n        @renderRulesList()\r\n\r\n        $(window).on 'xwing:afterLanguageLoad', (e, language, cb=$.noop) =>\r\n            @language = language\r\n            exportObj.loadRules(language)\r\n            @prepareRulesData()\r\n            @renderRulesList()\r\n        @rule_search_rules_text.oninput = => @renderRulesList()\r\n\r\n    prepareRulesData: () ->\r\n        @all_rules = exportObj.rulesEntries()\r\n\r\n        @ruletype = [ 'glossary', 'faq' ]\r\n\r\n        \r\n    renderRulesList: () ->\r\n        # sort_by is one of `name`, `type-by-name`, `source`, `type-by-points`\r\n        #\r\n        # Renders multiselect to container\r\n        # Selects previously selected rule if there is one\r\n        @rule_selector.remove() if @rule_selector?\r\n        @rule_selector = $ document.createElement('SELECT')\r\n        @rule_selector.addClass 'card-selector'\r\n        @rule_selector.attr 'size', 25\r\n        @rule_selector_container.append @rule_selector\r\n        \r\n        for type in @ruletype\r\n            optgroup = $ document.createElement('OPTGROUP')\r\n            optgroup.attr 'label', exportObj.translate('rulestypes', type)\r\n\r\n            rule_added = false\r\n            for rule_name, rule_data of @all_rules[type]\r\n                if @checkRulesSearchCriteria rule_data\r\n                    @addRulesTo optgroup, rule_data\r\n                    rule_added = true\r\n            if rule_added\r\n                @rule_selector.append optgroup\r\n                \r\n        @rule_selector.change (e) =>\r\n            @renderRules $(@rule_selector.find(':selected'))\r\n\r\n    renderRules: (rule) ->\r\n        # Renders rule to rule container\r\n        data = \r\n            name: rule.data 'name'\r\n            text: rule.data 'text'\r\n        orig_type = 'Rules'\r\n\r\n        @rule_viewer_container.show()\r\n        exportObj.builders[0].showTooltip(orig_type, data, add_opts ? {}, @rule_viewer_container) # we use the render method from the squad builder, cause it works.\r\n\r\n\r\n    addRulesTo: (container, rule) ->\r\n        option = $ document.createElement('OPTION')\r\n        option.text \"#{rule.name}\"\r\n        option.data 'name', rule.name\r\n        option.data 'text', exportObj.fixIcons rule\r\n        $(container).append option\r\n\r\n    checkRulesSearchCriteria: (rule) ->\r\n        # check for text search\r\n        search_text = @rule_search_rules_text.value.toLowerCase()\r\n        text_search = rule.name.toLowerCase().indexOf(search_text) > -1 or (rule.text and rule.text.toLowerCase().indexOf(search_text)) > -1\r\n        \r\n        if not text_search\r\n            return false\r\n            \r\n        return true\r\n\r\n###\r\n    X-Wing Squad Builder 2.5\r\n    Stephen Kim <raithos@gmail.com>\r\n    https://yasb.app\r\n###\r\n\r\nDFL_LANGUAGE = 'English' # default language\r\n\r\nSHOW_DEBUG_OUT_MISSING_TRANSLATIONS = false\r\n\r\nbuilders = []\r\n\r\nexportObj = exports ? this\r\n\r\n# TODO: create a reasonable scope for this (e.g. a translation class), so vars like currentLanguage\r\n# and methods like translateToLang are not within exportObj scope\r\n\r\n# a language change event will only affect the current language, if it has higher priority than \r\n# the current languagePriority.\r\n# -1: default language\r\n#  3: browser setting\r\n#  5: default priority (should not be used by now)\r\n#  8: parsed from html header (done in backend)\r\n# 10: backend setting\r\n# 100: manual selection\r\nexportObj.languagePriority = -1\r\n\r\n# try to set the current language according to the users choice\r\ntry\r\n  (()->\r\n    # we'll guess language from browser settings - unless a better choice has already been made\r\n    if exportObj.languagePriority > 3\r\n        return\r\n    exportObj.currentLanguage = DFL_LANGUAGE\r\n    if exportObj.languagePriority == -1\r\n        return\r\n    # some browses just provide a single navigator.language, some provide an array navigator.languages \r\n    languageCodes = [navigator.language].concat(navigator.languages)\r\n    for langc in languageCodes\r\n        # strip stuff like -US from en-US\r\n        langc = langc.split('-')[0]\r\n        if langc of exportObj.codeToLanguage\r\n            # assume that exportObj already exists. If it does not, we don't know which languages YASB supports\r\n            exportObj.currentLanguage = exportObj.codeToLanguage[langc]\r\n            # we successfully found a language the user is somewhat happy with. that's cool\r\n            exportObj.languagePriority = 3\r\n            break\r\n   )()\r\ncatch all\r\n    exportObj.currentLanguage = DFL_LANGUAGE\r\n    # throw all\r\n    \r\n\r\nexportObj.loadCards = (language) ->\r\n    exportObj.cardLoaders[language]()\r\n\r\nexportObj.loadRules = (language) ->\r\n    # console.log(\"Loading rules:\")\r\n    # console.log(language)\r\n    if language of exportObj.ruleLoaders\r\n        # console.log(\"Rules exist\")\r\n        if exportObj.rulesLang != language\r\n            # console.log(\"Not already active, currently was\")\r\n            # console.log(exportObj.rulesLang)\r\n            exportObj.ruleLoaders[language]()\r\n            exportObj.rulesLang = language\r\n        return true\r\n    else\r\n        # console.log(\"Load default instead\")\r\n        if exportObj.rulesLang != DFL_LANGUAGE\r\n            # console.log(\"Not already active\")\r\n            exportObj.ruleLoaders[DFL_LANGUAGE]()\r\n            exportObj.rulesLang = DFL_LANGUAGE\r\n        return false\r\n\r\nexportObj.translate = (category, what, args...) -> \r\n    exportObj.translateToLang(exportObj.currentLanguage, category, what, args...)\r\n\r\n# this method should be somewhat private, and not be called outside this file\r\nexportObj.translateToLang = (language, category, what, args...) ->\r\n    try\r\n        translation = exportObj.translations[language][category][what]\r\n    catch all\r\n        # well, guess something went wrong - most likely some translation did not exist in the\r\n        # current language. If that isn't the default language, we'll try that next in belows else block\r\n        # otherwise we just use whatever is the in-code text of the requested translation.\r\n        # Anyway, we want to keep running, so better catch that exception and keep going...\r\n        translation = undefined\r\n    if translation?\r\n        if translation instanceof Function\r\n            # pass this function in case we need to do further translation inside the function\r\n            translation exportObj.translate, args...\r\n        else\r\n            translation\r\n    else\r\n        if language != DFL_LANGUAGE\r\n            if SHOW_DEBUG_OUT_MISSING_TRANSLATIONS\r\n                console.log(language + ' translation for ' + String(what) + ' (category ' + String(category) + ') missing')\r\n            exportObj.translateToLang DFL_LANGUAGE, category, what, args...\r\n        else\r\n            what\r\n\r\nexportObj.setupTranslationSupport = ->\r\n    do (builders) ->\r\n        $(exportObj).on 'xwing:languageChanged', (e, language, priority=5, cb=$.noop) =>\r\n            # check if priority is high enough to do anything\r\n            if priority == 'reload' # special case - just a reload, no priority change\r\n                null\r\n            # check if a better choice than the requested one has already been made\r\n            else if priority < exportObj.languagePriority\r\n                return\r\n            else\r\n                exportObj.languagePriority = priority\r\n                exportObj.currentLanguage = language\r\n            if language of exportObj.translations\r\n                $('.language-placeholder').text language\r\n                current_language = \"\"\r\n                builders_before = []\r\n                for builder in builders\r\n                    current_language = builder.language\r\n                    builders_before.push new Promise((resolve,reject) => builder.container.trigger 'xwing:beforeLanguageLoad', resolve)\r\n                await Promise.all builders_before\r\n                if language != current_language\r\n                    exportObj.loadCards language\r\n                exportObj.translateUIElements()\r\n                for builder in builders\r\n                    builder.container.trigger 'xwing:afterLanguageLoad', language\r\n\r\n    # Load cards one time\r\n    basic_cards = exportObj.basicCardData()\r\n    quick_builds = exportObj.basicQuickBuilds()\r\n    exportObj.canonicalizeShipNames basic_cards\r\n    exportObj.ships = basic_cards.ships\r\n\r\n    # Set up the common card data (e.g. stats)\r\n    exportObj.setupCommonCardData basic_cards\r\n    exportObj.setupQuickBuilds quick_builds\r\n\r\n    # do we need to load dfl as well? Not sure...\r\n    exportObj.loadCards DFL_LANGUAGE\r\n    exportObj.loadRules exportObj.currentLanguage\r\n    if DFL_LANGUAGE != exportObj.currentLanguage\r\n        exportObj.loadCards exportObj.currentLanguage \r\n    $(exportObj).trigger 'xwing:languageChanged', [exportObj.currentLanguage, 'reload']\r\n\r\nexportObj.translateUIElements = (context=undefined) ->\r\n    # translate all UI elements that are marked as translateable\r\n    for translateableNode in $('.translated', context)\r\n        translateableNode.innerHTML = (exportObj.translate('ui', translateableNode.getAttribute('defaultText')))\r\n\r\nexportObj.setupTranslationUI = (backend) ->\r\n    for language in Object.keys(exportObj.cardLoaders).sort()\r\n        li = $ document.createElement 'LI'\r\n        li.text language\r\n        do (language, backend) ->\r\n            li.click (e) ->\r\n                backend.set('language', language) if backend?\r\n                # setting a language manually has pretty high priority\r\n                $(exportObj).trigger 'xwing:languageChanged', [ language, 100 ]\r\n        $('.language-picker .dropdown-menu').append li\r\n\r\nexportObj.registerBuilderForTranslation = (builder) ->\r\n    builders.push(builder) if builder not in builders\r\n\r\n###\r\n    X-Wing Squad Builder 2.5\r\n    Stephen Kim <raithos@gmail.com>\r\n    https://yasb.app\r\n###\r\nexportObj = exports ? this\r\n\r\nexportObj.sortHelper = (a, b) ->\r\n    if a.points == b.points\r\n        a_name = a.text.replace(/[^a-z0-9]/ig, '')\r\n        b_name = b.text.replace(/[^a-z0-9]/ig, '')\r\n        if a_name == b_name\r\n            0\r\n        else\r\n            if a_name > b_name then 1 else -1\r\n    else if typeof(a.points) == \"string\" # handling cases where points value is \"*\" instead of a number\r\n        1\r\n    else \r\n        if a.points > b.points then 1 else -1\r\n\r\nexportObj.toTTS = (txt) ->\r\n    if not txt?\r\n        null\r\n    else \r\n        txt.replace(/\\(.*\\)/g,\"\").replace(\"�\",'\"').replace(\"�\",'\"')\r\n\r\nexportObj.slotsMatching = (slota, slotb) ->\r\n    return true if slota == slotb\r\n    switch slota\r\n        when 'HardpointShip'\r\n            return true if slotb == 'Torpedo' or slotb == 'Cannon' or slotb == 'Missile'\r\n        when 'VersatileShip'\r\n            return true if slotb == 'Torpedo' or slotb == 'Missile'\r\n    switch slotb\r\n        when 'HardpointShip'\r\n            return true if slota == 'Torpedo' or slota == 'Cannon' or slota == 'Missile'\r\n        when 'VersatileShip'\r\n            return true if slota == 'Torpedo' or slota == 'Missile'\r\n    return false\r\n\r\n$.isMobile = ->\r\n    if (navigator.userAgent.match /(iPhone|iPod|iPad|Android)/i) or navigator.maxTouchPoints > 1\r\n        return true\r\n    return false\r\n    \r\n\r\n$.randomInt = (n) ->\r\n    Math.floor(Math.random() * n)\r\n\r\n$.isElementInView = (element, fullyInView) ->\r\n    pageTop = $(window).scrollTop()\r\n    pageBottom = pageTop + $(window).height()\r\n    elementTop = $(element)?.offset()?.top\r\n    elementBottom = elementTop + $(element).height()\r\n\r\n    if fullyInView\r\n        return ((pageTop < elementTop) && (pageBottom > elementBottom))\r\n    else\r\n        return ((elementTop <= pageBottom) && (elementBottom >= pageTop))\r\n\r\n\r\n# ripped from http://stackoverflow.com/questions/901115/how-can-i-get-query-string-values\r\n$.getParameterByName = (name) ->\r\n    name = name.replace(/[\\[]/, \"\\\\\\[\").replace(/[\\]]/, \"\\\\\\]\")\r\n    regexS = \"[\\\\?&]\" + name + \"=([^&#]*)\"\r\n    regex = new RegExp(regexS)\r\n    results = regex.exec(window.location.search)\r\n    if results == null\r\n        return \"\"\r\n    else\r\n        return decodeURIComponent(results[1].replace(/\\+/g, \" \"))\r\n\r\nArray::intersects = (other) ->\r\n    for item in this\r\n        if item in other\r\n            return true\r\n    return false\r\n\r\nArray::removeItem = (item) ->\r\n    idx = @indexOf item\r\n    @splice(idx, 1) unless idx == -1\r\n    this\r\n\r\nString::capitalize = ->\r\n    @charAt(0).toUpperCase() + @slice(1)\r\n\r\nString::getXWSBaseName = ->\r\n    @split('-')[0]\r\n\r\nURL_BASE = \"#{window.location.protocol}//#{window.location.host}#{window.location.pathname}\"\r\nSQUAD_DISPLAY_NAME_MAX_LENGTH = 24\r\n\r\nstatAndEffectiveStat = (base_stat, effective_stats, key) ->\r\n    if base_stat?\r\n        \"\"\"#{base_stat}#{if (effective_stats? and effective_stats[key]? and effective_stats[key] != base_stat) then \" (#{effective_stats[key]})\" else \"\"}\"\"\"\r\n    else if effective_stats? and effective_stats[key]?\r\n        \"\"\"0 (#{effective_stats[key]})\"\"\"\r\n    else\r\n        \"0\"\r\n\r\ngetPrimaryFaction = (faction) ->\r\n    switch faction\r\n        when 'Rebel Alliance'\r\n            'Rebel Alliance'\r\n        when 'Galactic Empire'\r\n            'Galactic Empire'\r\n        else\r\n            faction\r\n\r\nconditionToHTML = (condition) ->\r\n    html = $.trim \"\"\"\r\n        <div class=\"condition\">\r\n            <div class=\"name\">#{if condition.unique then \"&middot;&nbsp;\" else \"\"}#{if condition.display_name then condition.display_name else condition.name}</div>\r\n            <div class=\"text\">#{condition.text}</div>\r\n        </div>\r\n    \"\"\"\r\n\r\n# Assumes cards.js will be loaded\r\n\r\nclass exportObj.SquadBuilder\r\n    constructor: (args) ->\r\n        # args\r\n        @container = $ args.container\r\n        @faction = $.trim args.faction\r\n        @printable_container = $ args.printable_container\r\n        @tab = $ args.tab\r\n        @show_points_destroyed = false\r\n        \r\n        @isCurrentlyLoadingSquad = false\r\n\r\n        # internal state\r\n        @ships = []\r\n        @uniques_in_use =\r\n            Pilot:\r\n                []\r\n            Upgrade:\r\n                []\r\n            Slot:\r\n                []\r\n        @standard_list =\r\n            Upgrade:\r\n                []\r\n            Ship:\r\n                []\r\n        @suppress_automatic_new_ship = false\r\n        @tooltip_currently_displaying = null\r\n        @randomizer_options =\r\n            sources: null\r\n            points: 50\r\n            ship_limit: 0\r\n            collection_only: true\r\n            fill_zero_pts: false\r\n        @total_points = 0\r\n        # a squad given in the link is loaded on construction of that builder. It will set all gamemodes of already existing builders accordingly, but we did not exists back than. So we copy over the gamemode\r\n        @isStandard = exportObj.builders[0]?.isStandard ? false\r\n        @isEpic = exportObj.builders[0]?.isEpic ? false\r\n        @isBeta = exportObj.builders[0]?.isBeta ? true\r\n        @isQuickbuild = exportObj.builders[0]?.isQuickbuild ? false\r\n\r\n        @backend = null\r\n        @current_squad = {}\r\n\r\n        # todo: remove? The translation file should take care of languge management. \r\n        @language = exportObj.currentLanguage ? 'English'\r\n\r\n        @collection = null\r\n\r\n        @current_obstacles = []\r\n\r\n        @setupUI()\r\n        if @faction == \"All\"\r\n            @game_type_selector.val(\"epic\").trigger('change')\r\n        else\r\n            @game_type_selector.val((exportObj.builders[0] ? @).game_type_selector.val()).trigger('change')\r\n        @setupEventHandlers()\r\n\r\n        window.setInterval @updatePermaLink, 250\r\n\r\n        @isUpdatingPoints = false\r\n\r\n        if $.getParameterByName('f') == @faction\r\n            @resetCurrentSquad(true)\r\n            @loadFromSerialized $.getParameterByName('d')\r\n        else\r\n            @resetCurrentSquad()\r\n            @addShip()\r\n\r\n    resetCurrentSquad: (initial_load=false) ->\r\n        default_squad_name = @uitranslation('Unnamed Squadron')\r\n\r\n        squad_name = $.trim(@squad_name_input.val()) or default_squad_name\r\n        if initial_load and $.trim $.getParameterByName('sn')\r\n            squad_name = $.trim $.getParameterByName('sn')\r\n\r\n        squad_obstacles = []\r\n        if initial_load and $.trim $.getParameterByName('obs')\r\n            squad_obstacles = ($.trim $.getParameterByName('obs')).split(\",\").slice(0, 3)\r\n            @updateObstacleSelect squad_obstacles\r\n        else if @current_obstacles\r\n            squad_obstacles = @current_obstacles\r\n\r\n        @current_squad =\r\n            id: null\r\n            name: squad_name\r\n            dirty: false\r\n            additional_data:\r\n                points: @total_points\r\n                description: ''\r\n                cards: []\r\n                notes: ''\r\n                obstacles: squad_obstacles\r\n                tag: ''\r\n            faction: @faction\r\n\r\n        if @total_points > 0\r\n            if squad_name == default_squad_name\r\n                @current_squad.name = @uitranslation('Unsaved Squadron')\r\n            @current_squad.dirty = true\r\n        \r\n        @old_version_container.toggleClass 'd-none', true\r\n\r\n        @container.trigger 'xwing-backend:squadNameChanged'\r\n        @container.trigger 'xwing-backend:squadDirtinessChanged'\r\n\r\n    newSquadFromScratch: (squad_name = @uitranslation('New Squadron')) ->\r\n        @squad_name_input.val squad_name\r\n        @removeAllShips()\r\n        @addShip() if not @suppress_automatic_new_ship\r\n        @updateObstacleSelect []\r\n        @resetCurrentSquad()\r\n        @notes.val ''\r\n        @tag.val ''\r\n\r\n    uitranslation: (what, args...) ->\r\n        exportObj.translate('ui', what, args)\r\n\r\n    setupUI: ->\r\n        DEFAULT_RANDOMIZER_POINTS = 50\r\n        DEFAULT_RANDOMIZER_TIMEOUT_SEC = 4\r\n        DEFAULT_RANDOMIZER_SHIP_LIMIT = 0\r\n\r\n        @status_container = $ document.createElement 'DIV'\r\n        @status_container.addClass 'container-fluid'\r\n        @status_container.append $.trim \"\"\"\r\n            <div class=\"row squad-name-and-points-row\">\r\n                <div class=\"col-md-3 squad-name-container\">\r\n                    <div class=\"display-name\">\r\n                        <span class=\"squad-name\"></span>\r\n                        <i class=\"far fa-edit\"></i>\r\n                    </div>\r\n                    <div class=\"input-append\">\r\n                        <input type=\"text\" maxlength=\"64\" placeholder=\"#{@uitranslation(\"Name your squad...\")}\" />\r\n                        <button class=\"btn save\"><i class=\"fa fa-pen-square\"></i></button>\r\n                    </div>\r\n                    <br class=\"hide-on-mobile\" />\r\n                    <select class=\"game-type-selector\">\r\n                        <option value=\"xwa\" class=\"translated\" defaultText=\"XWA\" selected=\"selected\">#{@uitranslation(\"XWA\")}</option>\r\n                        <option value=\"epic\" class=\"translated\" defaultText=\"Epic\">#{@uitranslation(\"Epic\")}</option>\r\n                        <option value=\"quickbuild\" class=\"translated\" defaultText=\"Quickbuild\">#{@uitranslation(\"Quickbuild\")}</option>\r\n                        <option value=\"beta\" class=\"translated\" defaultText=\"BETA\">#{@uitranslation(\"BETA\")}</option>\r\n                    </select>\r\n                </div>\r\n                <div class=\"col-md-4 points-display-container\">\r\n                    Points: <span class=\"total-points\">0</span> / <input type=\"number\" class=\"desired-points\" value=\"50\">\r\n                    <span class=\"points-remaining-container\">(<span class=\"points-remaining\"></span>&nbsp;left) <span class=\"points-destroyed red\"></span></span>\r\n                    <span class=\"content-warning unreleased-content-used d-none\"><br /><i class=\"fa fa-exclamation-circle\"></i>&nbsp;<span class=\"translated\" defaultText=\"Unreleased content warning\"></span></span>\r\n                    <span class=\"content-warning loading-failed-container d-none\"><br /><i class=\"fa fa-exclamation-circle\"></i>&nbsp;<span class=\"translated\" defaultText=\"Broken squad link warning\"></span></span>\r\n                    <span class=\"content-warning old-version-container d-none\"><br /><i class=\"fa fa-exclamation-circle\"></i>&nbsp;<span class=\"translated\" defaultText=\"This squad was created for an older version of X-Wing. It may not load with the correct points or at all.\"></span></span>\r\n                    <span class=\"content-warning collection-invalid d-none\"><br /><i class=\"fa fa-exclamation-circle\"></i>&nbsp;<span class=\"translated\" defaultText=\"Collection warning\"></span></span>\r\n                    <span class=\"content-warning ship-number-invalid-container d-none\"><br /><i class=\"fa fa-exclamation-circle\"></i>&nbsp;<span class=\"translated\" defaultText=\"Ship number warning\"></span></span>\r\n                    <span class=\"content-warning multi-faction-warning-container d-none\"><br /><i class=\"fa fa-exclamation-circle\"></i>&nbsp;<span class=\"translated\" defaultText=\"Multi-Faction warning\"></span></span>\r\n                    <span class=\"content-warning epic-not-legal-container d-none\"><br /><i class=\"fa fa-exclamation-circle\"></i>&nbsp;<span class=\"translated\" defaultText=\"Epic Unofficial\"></span></span>\r\n                </div>\r\n                <div class=\"col-md-5 float-right button-container\">\r\n                    <div class=\"btn-group float-right\">\r\n\r\n                        <button class=\"btn btn-info view-as-text\"><span class=\"d-none d-lg-block\"><i class=\"fa fa-print\"></i>&nbsp;<span class=\"translated\" defaultText=\"Print/Export\"></span></span><span class=\"d-lg-none\"><i class=\"fa fa-print\"></i></span></button>\r\n                        <a class=\"btn btn-primary d-none collection\"><span class=\"d-none d-lg-block\"><i class=\"fa fa-folder-open\"></i> <span class=\"translated\" defaultText=\"Your Collection\"></span></span><span class=\"d-lg-none\"><i class=\"fa fa-folder-open\"></i></span></a>\r\n                        <!-- Randomize button is marked as danger, since it creates a new squad -->\r\n                        <button class=\"btn btn-danger randomize\"><span class=\"d-none d-lg-block\"><i class=\"fa fa-random\"></i> <span class=\"translated\" defaultText=\"Randomize!\"></span></span><span class=\"d-lg-none\"><i class=\"fa fa-random\"></i></span></button>\r\n                        <button class=\"btn btn-danger dropdown-toggle\" data-toggle=\"dropdown\">\r\n                            <span class=\"caret\"></span>\r\n                        </button>\r\n                         <ul class=\"dropdown-menu dropdown-menu-right\">\r\n                            <li><a class=\"dropdown-item randomize-options translated\" defaultText=\"Randomizer Options\"></a></li>\r\n                            <li><a class=\"dropdown-item misc-settings translated\" defaultText=\"Misc Settings\"></a></li>\r\n                        </ul>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <div class=\"row squad-save-buttons\">\r\n                <div class=\"col-md-12 squad-save-buttons-container\">\r\n                    <button class=\"show-authenticated btn btn-primary save-list\"><i class=\"far fa-save\"></i>&nbsp;<span class=\"translated\" defaultText=\"Save\"></span></button>\r\n                    <button class=\"show-authenticated btn btn-primary save-list-as\"><i class=\"far fa-file\"></i>&nbsp;<span class=\"translated\" defaultText=\"Save As...\"></span></button>\r\n                    <button class=\"show-authenticated btn btn-primary delete-list disabled\"><i class=\"fa fa-trash\"></i>&nbsp;<span class=\"translated\" defaultText=\"Delete\"></span></button>\r\n                    <button class=\"show-authenticated btn btn-info backend-list-my-squads show-authenticated\"><i class=\"fa fa-download\"></i>&nbsp;<span class = \"translated\" defaultText=\"Load Squad\"></span></button>\r\n                    <button class=\"btn btn-info import-squad\"><i class=\"fa fa-file-import\"></i>&nbsp;<span class=\"translated\" defaultText=\"Import\"></span></button>\r\n                    <button class=\"btn btn-info show-points-destroyed\"><i class=\"fas fa-bullseye\"></i>&nbsp;<span class=\"show-points-destroyed-span translated\" defaultText=\"#{@uitranslation(\"Show Points Destroyed\")}\"></span></button>                    \r\n                    <button class=\"btn btn-danger clear-squad\"><i class=\"fa fa-plus-circle\"></i>&nbsp;<span class=\"translated\" defaultText=\"New Squad\"></span></button>\r\n                    <span class=\"show-authenticated backend-status\"></span>\r\n                </div>\r\n            </div>\r\n        \"\"\" \r\n        @container.append @status_container\r\n\r\n        @xws_import_modal = $ document.createElement 'DIV'\r\n        @xws_import_modal.addClass 'modal fade import-modal d-print-none'\r\n        @xws_import_modal.tabindex = \"-1\"\r\n        @xws_import_modal.role = \"dialog\"\r\n        @xws_import_modal.append $.trim \"\"\"\r\n    <div class=\"modal-dialog modal-dialog-centered\" role=\"document\">\r\n        <div class=\"modal-content\">\r\n            <div class=\"modal-header\">\r\n                <h3 class=\"translated\" defaultText=\"XWS Import\"></h3>\r\n                <button type=\"button\" class=\"close d-print-none\" data-dismiss=\"modal\" aria-hidden=\"true\">&times;</button>\r\n            </div>\r\n            <div class=\"modal-body\">\r\n                <span class=\"translated\" defaultText=\"XWS Import Dialog\"></span>\r\n                <div class=\"container-fluid\">\r\n                    <textarea class=\"xws-content\" placeholder='\"\"\"+@uitranslation(\"Paste XWS here\")+\"\"\"'></textarea>\r\n                </div>\r\n            </div>\r\n            <div class=\"modal-footer d-print-none\">\r\n                <span class=\"xws-import-status\"></span>&nbsp;\r\n                <button class=\"btn btn-danger import-xws translated\" defaultText=\"Import\"></button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n        \"\"\"\r\n        @from_xws_button = @container.find('button.import-squad')\r\n        @from_xws_button.click (e) =>\r\n            e.preventDefault()\r\n            @xws_import_modal.find('.xws-import-status').text ' '\r\n            @xws_import_modal.modal 'show'\r\n\r\n        @load_xws_button = $ @xws_import_modal.find('button.import-xws')\r\n        @load_xws_button.click (e) =>\r\n            e.preventDefault()\r\n            exportObj.loadXWSButton(@xws_import_modal)\r\n        @container.append @xws_import_modal\r\n\r\n        @list_modal = $ document.createElement 'DIV'\r\n        @list_modal.addClass 'modal fade text-list-modal'\r\n        @list_modal.tabindex = \"-1\"\r\n        @list_modal.role = \"dialog\"\r\n        @container.append @list_modal\r\n        @list_modal.append $.trim \"\"\"\r\n    <div class=\"modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable\" role=\"document\">\r\n        <div class=\"modal-content\">\r\n            <div class=\"modal-header\">\r\n                <div class=\"d-print-none\">\r\n                    <h4 class=\"modal-title\"><span class=\"squad-name\"></span> <span class=\"total-points\"></span></h4>\r\n                </div>\r\n                <div class=\"d-none d-print-block\">\r\n                    <div class=\"fancy-header\">\r\n                        <div class=\"squad-name\"></div>\r\n                        <div class=\"squad-faction\"></div>\r\n                        <div class=\"mask\">\r\n                            <div class=\"outer-circle\">\r\n                                <div class=\"inner-circle\">\r\n                                    <span class=\"total-points\"></span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"fancy-under-header\"></div>\r\n                </div>\r\n                <button type=\"button\" class=\"close d-print-none\" data-dismiss=\"modal\" aria-hidden=\"true\">&times;</button>\r\n            </div>\r\n            <div class=\"modal-body\">\r\n                <div class=\"fancy-list\"></div>\r\n                <div class=\"simple-list\"></div>\r\n                <div class=\"simplecopy-list\">\r\n                    <span class=\"translated\" defaultText=\"Copy below simple text\"></span>\r\n                    <textarea></textarea><button class=\"btn btn-modal btn-copy translated\" defaultText=\"Copy\"></button>\r\n                </div>\r\n                <div class=\"reddit-list\">\r\n                    <span class=\"translated\" defaultText=\"Copy below markdown\"></span>\r\n                    <textarea></textarea><button class=\"btn btn-modal btn-copy translated\" defaultText=\"Copy\"></button>\r\n                </div>\r\n                <div class=\"tts-list\">\r\n                    <span class=\"translated\" defaultText=\"Copy below TTS\"></span>\r\n                    <textarea></textarea><button class=\"btn btn-modal btn-copy translated\" defaultText=\"Copy\"></button>\r\n                </div>\r\n                <div class=\"xws-list\">\r\n                    <span class=\"translated\" defaultText=\"Copy below XWS\"></span>\r\n                    <div class=\"row full-row\">\r\n                        <div class=\"col d-inline-block d-none d-sm-block\"><textarea></textarea><br /><button class=\"btn btn-modal btn-copy translated\" defaultText=\"Copy\"></button></div>\r\n                        <div class=\"col d-inline-block d-none d-sm-block qrcode-container\" id=\"xws-qrcode-container\"></div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"container-fluid modal-footer d-print-none\">\r\n                <div class=\"row full-row\">\r\n                    <div class=\"col d-inline-block d-none d-sm-block right-col\">\r\n                        <label class=\"color-skip-text-checkbox\">\r\n                            <span class=\"translated\" defaultText=\"Skip Card Text\"></span> <input type=\"checkbox\" class=\"toggle-skip-text-print\" />\r\n                        </label><br />\r\n                        <label class=\"horizontal-space-checkbox\">\r\n                            <span class=\"translated\" defaultText=\"Space for Cards\"></span> <input type=\"checkbox\" class=\"toggle-horizontal-space\" />\r\n                        </label><br />\r\n                        <label class=\"maneuver-print-checkbox\">\r\n                            <span class=\"translated\" defaultText=\"Include Maneuvers Chart\"></span> <input type=\"checkbox\" class=\"toggle-maneuver-print\" />\r\n                        </label><br />\r\n                        <label class=\"expanded-shield-hull-print-checkbox\">\r\n                            <span class=\"translated\" defaultText=\"Expand Shield and Hull\"></span> <input type=\"checkbox\" class=\"toggle-expanded-shield-hull-print\" />\r\n                        </label>\r\n                    </div>\r\n                    <div class=\"col d-inline-block d-none d-sm-block right-col\">\r\n                        <label class=\"color-print-checkbox\">\r\n                            <span class=\"translated\" defaultText=\"Print Color\"></span> <input type=\"checkbox\" class=\"toggle-color-print\" checked=\"checked\" />\r\n                        </label><br />\r\n                        <label class=\"qrcode-checkbox\">\r\n                            <span class=\"translated\" defaultText=\"Include QR codes\"></span> <input type=\"checkbox\" class=\"toggle-juggler-qrcode\" checked=\"checked\" />\r\n                        </label><br />\r\n                        <label class=\"obstacles-checkbox\">\r\n                            <span class=\"translated\" defaultText=\"Include Obstacle Choices\"></span> <input type=\"checkbox\" class=\"toggle-obstacles\" checked=\"checked\" />\r\n                        </label>\r\n                    </div>\r\n                </div>\r\n                <div class=\"row btn-group list-display-mode\">\r\n                    <button class=\"btn btn-modal select-simple-view translated\" defaultText=\"Simple\"></button>\r\n                    <button class=\"btn btn-modal select-fancy-view translated\" defaultText=\"Fancy\"></button>\r\n                    <button class=\"btn btn-modal select-simplecopy-view translated\" defaultText=\"Text\"></button>\r\n                    <button class=\"btn btn-modal select-reddit-view translated\" defaultText=\"Reddit\"></button>\r\n                    <button class=\"btn btn-modal select-tts-view d-none d-sm-block translated\" defaultText=\"TTS\"></button>\r\n                    <button class=\"btn btn-modal select-xws-view translated\" defaultText=\"XWS\"></button>\r\n                </div>\r\n                <div class=\"row btn-group list-display-mode\">\r\n                    <button class=\"btn btn-modal copy-url translated\" defaultText=\"Copy URL\"></button>\r\n                    <button class=\"btn btn-modal print-list d-sm-block\"><span class=\"d-none d-lg-block\"><i class=\"fa fa-print\"></i>&nbsp;<span class=\"translated\" defaultText=\"Print\"></span></span><span class=\"d-lg-none\"><i class=\"fa fa-print\"></i></span></button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n        \"\"\"\r\n        @fancy_container = $ @list_modal.find('.fancy-list')\r\n        @fancy_total_points_container = $ @list_modal.find('div.modal-header .total-points')\r\n        @simple_container = $ @list_modal.find('div.modal-body .simple-list')\r\n        @reddit_container = $ @list_modal.find('div.modal-body .reddit-list')\r\n        @reddit_textarea = $ @reddit_container.find('textarea')\r\n        @reddit_textarea.attr 'readonly', 'readonly'\r\n        @simplecopy_container = $ @list_modal.find('div.modal-body .simplecopy-list')\r\n        @simplecopy_textarea = $ @simplecopy_container.find('textarea')\r\n        @simplecopy_textarea.attr 'readonly', 'readonly'\r\n        @tts_container = $ @list_modal.find('div.modal-body .tts-list')\r\n        @tts_textarea = $ @tts_container.find('textarea')\r\n        @tts_textarea.attr 'readonly', 'readonly'\r\n        @xws_container = $ @list_modal.find('div.modal-body .xws-list')\r\n        @xws_textarea = $ @xws_container.find('textarea')\r\n        @xws_textarea.attr 'readonly', 'readonly'\r\n        @toggle_vertical_space_container = $ @list_modal.find('.horizontal-space-checkbox')\r\n        @toggle_color_print_container = $ @list_modal.find('.color-print-checkbox')\r\n        @toggle_color_skip_text = $ @list_modal.find('.color-skip-text-checkbox')\r\n        @toggle_maneuver_dial_container = $ @list_modal.find('.maneuver-print-checkbox')\r\n        @toggle_expanded_shield_hull_container = $ @list_modal.find('.expanded-shield-hull-print-checkbox')\r\n        @toggle_qrcode_container = $ @list_modal.find('.qrcode-checkbox')\r\n        @toggle_obstacle_container = $ @list_modal.find('.obstacles-checkbox')\r\n        @btn_print_list = ($ @list_modal.find('.print-list'))[0]\r\n        @btn_copy_url = $ @list_modal.find('.copy-url')\r\n\r\n        @btn_copy_url.click (e) =>\r\n            @success =  window.navigator.clipboard.writeText(window.location.href);\r\n            @self = $(e.currentTarget)\r\n            if @success\r\n                @self.addClass 'btn-success'\r\n                setTimeout ( =>\r\n                    @self.removeClass 'btn-success'\r\n                ), 1000\r\n        \r\n        # the url copy button is only needed if the browser is hiding the address bar. This is the case for PWA links. \r\n        @btn_copy_url.hide() unless [\"fullscreen\", \"standalone\", \"minimal-ui\"].some((displayMode) => window.matchMedia('(display-mode: ' + displayMode + ')').matches)\r\n\r\n        @list_modal.on 'click', 'button.btn-copy', (e) =>\r\n            @self = $(e.currentTarget)\r\n            @self.siblings('textarea').select()\r\n            @success = document.execCommand('copy')\r\n            if @success\r\n                @self.addClass 'btn-success'\r\n                setTimeout ( =>\r\n                    @self.removeClass 'btn-success'\r\n                ), 1000\r\n\r\n        @select_simple_view_button = $ @list_modal.find('.select-simple-view')\r\n        @select_simple_view_button.click (e) =>\r\n            @select_simple_view_button.blur()\r\n            unless @list_display_mode == 'simple'\r\n                @list_modal.find('.list-display-mode .btn').removeClass 'btn-inverse'\r\n                @select_simple_view_button.addClass 'btn-inverse'\r\n                @list_display_mode = 'simple'\r\n                @simple_container.show()\r\n                @fancy_container.hide()\r\n                @simplecopy_container.hide()\r\n                @reddit_container.hide()\r\n                @tts_container.hide()\r\n                @xws_container.hide()\r\n                @toggle_vertical_space_container.hide()\r\n                @toggle_color_print_container.hide()\r\n                @toggle_color_skip_text.hide()\r\n                @toggle_maneuver_dial_container.hide()\r\n                @toggle_expanded_shield_hull_container.hide()\r\n                @toggle_qrcode_container.show()\r\n                @toggle_obstacle_container.show()\r\n                @btn_print_list.disabled = false;\r\n\r\n        @select_fancy_view_button = $ @list_modal.find('.select-fancy-view')\r\n        @select_fancy_view_button.click (e) =>\r\n            @select_fancy_view_button.blur()\r\n            unless @list_display_mode == 'fancy'\r\n                @list_modal.find('.list-display-mode .btn').removeClass 'btn-inverse'\r\n                @select_fancy_view_button.addClass 'btn-inverse'\r\n                @list_display_mode = 'fancy'\r\n                @fancy_container.show()\r\n                @simple_container.hide()\r\n                @simplecopy_container.hide()\r\n                @reddit_container.hide()\r\n                @tts_container.hide()\r\n                @xws_container.hide()\r\n                @toggle_vertical_space_container.show()\r\n                @toggle_color_print_container.show()\r\n                @toggle_color_skip_text.show()\r\n                @toggle_maneuver_dial_container.show()\r\n                @toggle_expanded_shield_hull_container.show()\r\n                @toggle_qrcode_container.show()\r\n                @toggle_obstacle_container.show()\r\n                @btn_print_list.disabled = false;\r\n                \r\n        @select_reddit_view_button = $ @list_modal.find('.select-reddit-view')\r\n        @select_reddit_view_button.click (e) =>\r\n            @select_reddit_view_button.blur()\r\n            unless @list_display_mode == 'reddit'\r\n                @list_modal.find('.list-display-mode .btn').removeClass 'btn-inverse'\r\n                @select_reddit_view_button.addClass 'btn-inverse'\r\n                @list_display_mode = 'reddit'\r\n                @reddit_container.show()\r\n                @simplecopy_container.hide()\r\n                @tts_container.hide()\r\n                @xws_container.hide()\r\n                @simple_container.hide()\r\n                @fancy_container.hide()\r\n                @reddit_textarea.select()\r\n                @reddit_textarea.focus()\r\n                @toggle_vertical_space_container.hide()\r\n                @toggle_color_print_container.hide()\r\n                @toggle_color_skip_text.hide()\r\n                @toggle_maneuver_dial_container.hide()\r\n                @toggle_expanded_shield_hull_container.hide()\r\n                @toggle_qrcode_container.hide()\r\n                @toggle_obstacle_container.hide()\r\n                @btn_print_list.disabled = true;\r\n\r\n        @select_simplecopy_view_button = $ @list_modal.find('.select-simplecopy-view')\r\n        @select_simplecopy_view_button.click (e) =>\r\n            @select_simplecopy_view_button.blur()\r\n            unless @list_display_mode == 'simplecopy'\r\n                @list_modal.find('.list-display-mode .btn').removeClass 'btn-inverse'\r\n                @select_simplecopy_view_button.addClass 'btn-inverse'\r\n                @list_display_mode = 'simplecopy'\r\n                @reddit_container.hide()\r\n                @simplecopy_container.show()\r\n                @tts_container.hide()\r\n                @xws_container.hide()\r\n                @simple_container.hide()\r\n                @fancy_container.hide()\r\n                @simplecopy_textarea.select()\r\n                @simplecopy_textarea.focus()\r\n                @toggle_vertical_space_container.hide()\r\n                @toggle_color_print_container.hide()\r\n                @toggle_color_skip_text.hide()\r\n                @toggle_maneuver_dial_container.hide()\r\n                @toggle_expanded_shield_hull_container.hide()\r\n                @toggle_qrcode_container.hide()\r\n                @toggle_obstacle_container.hide()\r\n                @btn_print_list.disabled = true;\r\n                \r\n                \r\n        @select_tts_view_button = $ @list_modal.find('.select-tts-view')\r\n        @select_tts_view_button.click (e) =>\r\n            @select_tts_view_button.blur()\r\n            unless @list_display_mode == 'tts'\r\n                @list_modal.find('.list-display-mode .btn').removeClass 'btn-inverse'\r\n                @select_tts_view_button.addClass 'btn-inverse'\r\n                @list_display_mode = 'tts'\r\n                @tts_container.show()\r\n                @xws_container.hide()\r\n                @simple_container.hide()\r\n                @simplecopy_container.hide()\r\n                @reddit_container.hide()\r\n                @fancy_container.hide()\r\n                @tts_textarea.select()\r\n                @tts_textarea.focus()\r\n                @toggle_vertical_space_container.hide()\r\n                @toggle_color_print_container.hide()\r\n                @toggle_color_skip_text.hide()\r\n                @toggle_maneuver_dial_container.hide()\r\n                @toggle_expanded_shield_hull_container.hide()\r\n                @toggle_qrcode_container.hide()\r\n                @toggle_obstacle_container.hide()\r\n                @btn_print_list.disabled = true;\r\n\r\n\r\n        @select_xws_view_button = $ @list_modal.find('.select-xws-view')\r\n        @select_xws_view_button.click (e) =>\r\n            @select_xws_view()\r\n\r\n        if $(window).width() >= 768\r\n            @simple_container.hide()\r\n            @select_fancy_view_button.click()\r\n        else\r\n            @select_simple_view_button.click()\r\n\r\n        @clear_squad_button = $ @status_container.find('.clear-squad')\r\n        @clear_squad_button.click (e) =>\r\n            if @current_squad.dirty and @backend?\r\n                @backend.warnUnsaved this, () =>\r\n                    @newSquadFromScratch()\r\n            else\r\n                @newSquadFromScratch()\r\n\r\n        @show_points_destroyed_button = $ @status_container.find('.show-points-destroyed')\r\n        @show_points_destroyed_button_span = $ @status_container.find('.show-points-destroyed-span')\r\n        @show_points_destroyed_button.click (e) =>\r\n            @show_points_destroyed = not @show_points_destroyed\r\n            if @show_points_destroyed == false\r\n                @points_destroyed_span.hide()\r\n            else\r\n                @points_destroyed_span.show()\r\n            for ship in @ships\r\n                if ship.pilot?\r\n                    if @show_points_destroyed == false\r\n                        @show_points_destroyed_button_span.text @uitranslation(\"Show Points Destroyed\")\r\n                        ship.points_destroyed_button.hide()\r\n                    else\r\n                        @show_points_destroyed_button_span.text @uitranslation(\"Hide Points Destroyed\")\r\n                        ship.points_destroyed_button.show()\r\n\r\n        @squad_name_container = $ @status_container.find('div.squad-name-container')\r\n        @squad_name_display = $ @container.find('.display-name')\r\n        @squad_name_placeholder = $ @container.find('.squad-name')\r\n        @squad_name_input = $ @squad_name_container.find('input')\r\n        @squad_name_save_button = $ @squad_name_container.find('button.save')\r\n        @squad_name_input.closest('div').hide()\r\n        @points_container = $ @status_container.find('div.points-display-container')\r\n        @total_points_span = $ @points_container.find('.total-points')\r\n        @game_type_selector = $ @status_container.find('.game-type-selector')\r\n        @game_type_selector.select2\r\n            minimumResultsForSearch: -1\r\n        @game_type_selector.change (e) =>\r\n            # $(window).trigger 'xwing:gameTypeChanged', @game_type_selector.val()\r\n            @onGameTypeChanged @game_type_selector.val()\r\n        @desired_points_input = $ @points_container.find('.desired-points')\r\n        @desired_points_input.change (e) =>\r\n            @container.trigger 'xwing:pointsUpdated'\r\n        @points_remaining_span = $ @points_container.find('.points-remaining')\r\n        @points_destroyed_span = $ @points_container.find('.points-destroyed')\r\n        @points_remaining_container = $ @points_container.find('.points-remaining-container')\r\n        @unreleased_content_used_container = $ @points_container.find('.unreleased-content-used')\r\n        @loading_failed_container = $ @points_container.find('.loading-failed-container')\r\n        @old_version_container = $ @points_container.find('.old-version-container')\r\n        @ship_number_invalid_container = $ @points_container.find('.ship-number-invalid-container')\r\n        @multi_faction_warning_container = $ @points_container.find('.multi-faction-warning-container')\r\n        @epic_not_legal_container = $ @points_container.find('.epic-not-legal-container')\r\n        @collection_invalid_container = $ @points_container.find('.collection-invalid')\r\n        @view_list_button = $ @status_container.find('div.button-container button.view-as-text')\r\n        @randomize_button = $ @status_container.find('div.button-container button.randomize')\r\n        @customize_randomizer = $ @status_container.find('div.button-container a.randomize-options')\r\n        @misc_settings = $ @status_container.find('div.button-container a.misc-settings')\r\n        @backend_status = $ @status_container.find('.backend-status')\r\n        @backend_status.hide()\r\n\r\n        @collection_button = $ @status_container.find('div.button-container a.collection')\r\n        @collection_button.click (e) =>\r\n            e.preventDefault()\r\n            unless @collection_button.prop('disabled')\r\n                @collection.modal.modal 'show'\r\n\r\n        @squad_name_input.keypress (e) =>\r\n            if e.which == 13\r\n                @squad_name_save_button.click()\r\n                false\r\n\r\n        @squad_name_input.change (e) =>\r\n            @backend_status.fadeOut 'slow'\r\n\r\n        @squad_name_input.blur (e) =>\r\n            @squad_name_input.change()\r\n            @squad_name_save_button.click()\r\n\r\n        @squad_name_display.click (e) =>\r\n            e.preventDefault()\r\n            @squad_name_display.hide()\r\n            @squad_name_input.val $.trim(@current_squad.name)\r\n            # Because Firefox handles this badly\r\n            window.setTimeout () =>\r\n                @squad_name_input.focus()\r\n                @squad_name_input.select()\r\n            , 100\r\n            @squad_name_input.closest('div').show()\r\n        @squad_name_save_button.click (e) =>\r\n            e.preventDefault()\r\n            @current_squad.dirty = true\r\n            @container.trigger 'xwing-backend:squadDirtinessChanged'\r\n            name = @current_squad.name = $.trim(@squad_name_input.val())\r\n            if name.length > 0\r\n                @squad_name_display.show()\r\n                @container.trigger 'xwing-backend:squadNameChanged'\r\n                @squad_name_input.closest('div').hide()\r\n\r\n        @randomizer_options_modal = $ document.createElement('DIV')\r\n        @randomizer_options_modal.addClass 'modal fade randomizer-modal'\r\n        @randomizer_options_modal.tabindex = \"-1\"\r\n        @randomizer_options_modal.role = \"dialog\"\r\n        $('body').append @randomizer_options_modal\r\n        @randomizer_options_modal.append $.trim \"\"\"\r\n            <div class=\"modal-dialog modal-dialog-scrollable modal-dialog-centered\" role=\"document\">\r\n                <div class=\"modal-content\">\r\n                    <div class=\"modal-header\">\r\n                        <h3 class=\"translated\" defaultText=\"Random Squad Builder Options\"></h3>\r\n                        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">&times;</button>\r\n                    </div>\r\n                    <div class=\"modal-body\">\r\n                        <form>\r\n                            <label>\r\n                                <span class=\"translated\" defaultText=\"Maximum Ship Count\"></span>\r\n                                <input type=\"number\" class=\"randomizer-ship-limit\" value=\"#{DEFAULT_RANDOMIZER_SHIP_LIMIT}\" placeholder=\"#{DEFAULT_RANDOMIZER_SHIP_LIMIT}\" />\r\n                            </label><br />\r\n                            <label>\r\n                                <input type=\"checkbox\" class=\"randomizer-collection-only\" checked=\"checked\"/> \r\n                                <span class=\"translated\" defaultText=\"Limit to collection\"></span>\r\n                            </label><br />\r\n                            <label>\r\n                                <span class=\"translated\" defaultText=\"Sets and Expansions\"></span>\r\n                                <select class=\"randomizer-sources\" multiple=\"1\" data-placeholder='\"\"\" + @uitranslation('All sets and expansions') + \"\"\"'>\r\n                                </select>\r\n                            </label><br />\r\n                            <label>\r\n                                <input type=\"checkbox\" class=\"randomizer-fill-zero-pts\" /> \r\n                                <span class=\"translated\" defaultText=\"Always fill 0-point slots\"></span>\r\n                            </label><br />\r\n                            <label>\r\n                                <span class=\"translated\" defaultText=\"Maximum Seconds to Spend Randomizing\"></span>\r\n                                <input type=\"number\" class=\"randomizer-timeout\" value=\"#{DEFAULT_RANDOMIZER_TIMEOUT_SEC}\" placeholder=\"#{DEFAULT_RANDOMIZER_TIMEOUT_SEC}\" />\r\n                            </label>\r\n                        </form>\r\n                    </div>\r\n                    <div class=\"modal-footer\">\r\n                        <button class=\"btn btn-primary do-randomize translated\" aria-hidden=\"true\" defaultText=\"Roll!\"></button>\r\n                        <button class=\"btn translated\" data-dismiss=\"modal\" aria-hidden=\"true\" defaultText=\"Close\"></button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        \"\"\"\r\n        # translate the UI we just created. \r\n        exportObj.translateUIElements(@randomizer_options_modal)\r\n        \r\n        @randomizer_source_selector = $ @randomizer_options_modal.find('select.randomizer-sources')\r\n        for expansion in exportObj.expansions\r\n            opt = $ document.createElement('OPTION')\r\n            opt.text expansion\r\n            @randomizer_source_selector.append opt\r\n        @randomizer_source_selector.select2\r\n            width: \"100%\"\r\n            minimumResultsForSearch: if $.isMobile() then -1 else 0\r\n        @randomizer_collection_selector = ($ @randomizer_options_modal.find('.randomizer-collection-only'))[0]\r\n        @randomizer_fill_zero_pts = ($ @randomizer_options_modal.find('.randomizer-fill-zero-pts'))[0]\r\n\r\n        @randomize_button.click (e) =>\r\n            e.preventDefault()\r\n            if @current_squad.dirty and @backend?\r\n                @backend.warnUnsaved this, () =>\r\n                    @randomize_button.click()\r\n            else\r\n                points = parseInt @desired_points_input.val()\r\n                points = DEFAULT_RANDOMIZER_POINTS if (isNaN(points) or points <= 0)\r\n                ship_limit = parseInt $(@randomizer_options_modal.find('.randomizer-ship-limit')).val()\r\n                ship_limit = DEFAULT_RANDOMIZER_SHIP_LIMIT if (isNaN(ship_limit) or ship_limit < 0)\r\n                timeout_sec = parseInt $(@randomizer_options_modal.find('.randomizer-timeout')).val()\r\n                timeout_sec = DEFAULT_RANDOMIZER_TIMEOUT_SEC if (isNaN(timeout_sec) or timeout_sec <= 0)\r\n                # console.log \"points=#{points}, sources=#{@randomizer_source_selector.val()}, timeout=#{timeout_sec}\"\r\n                @randomSquad(points, @randomizer_source_selector.val(), timeout_sec * 1000, ship_limit, @randomizer_collection_selector.checked, @randomizer_fill_zero_pts.checked)\r\n\r\n        @randomizer_options_modal.find('button.do-randomize').click (e) =>\r\n            e.preventDefault()\r\n            @randomizer_options_modal.modal('hide')\r\n            @randomize_button.click()\r\n            \r\n        @customize_randomizer.click (e) =>\r\n            e.preventDefault()\r\n            @randomizer_options_modal.modal()\r\n\r\n        @misc_settings_modal = $ document.createElement('DIV')\r\n        @misc_settings_modal.addClass 'modal fade'\r\n        @misc_settings_modal.tabindex = \"-1\"\r\n        @misc_settings_modal.role = \"dialog\"\r\n        $('body').append @misc_settings_modal\r\n        @misc_settings_modal.append $.trim \"\"\"\r\n    <div class=\"modal-dialog modal-dialog-centered modal-dialog-scrollable\" role=\"document\">\r\n        <div class=\"modal-content\">\r\n            <div class=\"modal-header\">\r\n                <h3 class=\"translated\" defaultText=\"Miscellaneous Settings\"></h3>\r\n                <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">&times;</button>\r\n            </div>\r\n            <div class=\"modal-body\">\r\n                <label class = \"toggle-initiative-prefix-names misc-settings-label\">\r\n                    <input type=\"checkbox\" class=\"initiative-prefix-names-checkbox misc-settings-checkbox\" /> <span class=\"translated\" defaultText=\"Use INI prefix\"></span> \r\n                </label><br />\r\n                <label class = \"enable-ban-list misc-settings-label\">\r\n                    <input type=\"checkbox\" class=\"enable-ban-list-checkbox misc-settings-checkbox\" /> <span class=\"translated\" defaultText=\"Enable Ban List (Not Standard)\"></span> \r\n                </label><br />\r\n            </div>\r\n            <div class=\"modal-footer\">\r\n                <span class=\"misc-settings-infoline\"></span>\r\n                &nbsp;\r\n                <button class=\"btn translated\" data-dismiss=\"modal\" aria-hidden=\"true\" defaultText=\"Close\"></button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n        \"\"\"\r\n        @misc_settings_infoline = $ @misc_settings_modal.find('.misc-settings-infoline')\r\n        @misc_settings_initiative_prefix = $ @misc_settings_modal.find('.initiative-prefix-names-checkbox')\r\n        @misc_settings_ban_list = $ @misc_settings_modal.find('.enable-ban-list-checkbox')\r\n        if @backend? \r\n            @backend.getSettings (st) =>\r\n                exportObj.settings ?= []\r\n                exportObj.settings.initiative_prefix = st.showInitiativeInFrontOfPilotName?\r\n                if st.showInitiativeInFrontOfPilotName? \r\n                    @misc_settings_initiative_prefix.prop('checked', true)\r\n\r\n                exportObj.settings.ban_list = st.enableBanList?\r\n                if st.enableBanList? \r\n                    @misc_settings_ban_list.prop('checked', true)\r\n        else \r\n            @waiting_for_backend ?= []\r\n            @waiting_for_backend.push => \r\n                @backend.getSettings (st) =>\r\n                    exportObj.settings ?= []\r\n                    exportObj.settings.initiative_prefix = st.showInitiativeInFrontOfPilotName?\r\n                    if st.showInitiativeInFrontOfPilotName? \r\n                        @misc_settings_initiative_prefix.prop('checked', true)\r\n                    exportObj.settings.ban_list = st.enableBanList?\r\n                    if st.enableBanList? \r\n                        @misc_settings_ban_list.prop('checked', true)\r\n                        \r\n        @misc_settings_initiative_prefix.click (e) =>\r\n            exportObj.settings ?= []\r\n            exportObj.settings.initiative_prefix = @misc_settings_initiative_prefix.prop('checked')\r\n            if @backend? \r\n                if @misc_settings_initiative_prefix.prop('checked')\r\n                    @backend.set 'showInitiativeInFrontOfPilotName', '1', (ds) =>\r\n                        @misc_settings_infoline.text @uitranslation(\"Changes Saved\")\r\n                        @misc_settings_infoline.fadeIn 100, =>\r\n                            @misc_settings_infoline.fadeOut 3000\r\n                else \r\n                    @backend.deleteSetting 'showInitiativeInFrontOfPilotName', (dd) =>\r\n                        @misc_settings_infoline.text @uitranslation(\"Changes Saved\")\r\n                        @misc_settings_infoline.fadeIn 100, =>\r\n                            @misc_settings_infoline.fadeOut 3000\r\n\r\n        @misc_settings_ban_list.click (e) =>\r\n            exportObj.settings ?= []\r\n            exportObj.settings.ban_list = @misc_settings_ban_list.prop('checked')\r\n            if @backend? \r\n                if @misc_settings_ban_list.prop('checked')\r\n                    @backend.set 'enableBanList', '1', (ds) =>\r\n                        @misc_settings_infoline.text @uitranslation(\"Changes Saved\")\r\n                        @misc_settings_infoline.fadeIn 100, =>\r\n                            @misc_settings_infoline.fadeOut 3000\r\n                else \r\n                    @backend.deleteSetting 'enableBanList', (dd) =>\r\n                        @misc_settings_infoline.text @uitranslation(\"Changes Saved\")\r\n                        @misc_settings_infoline.fadeIn 100, =>\r\n                            @misc_settings_infoline.fadeOut 3000\r\n\r\n\r\n        @misc_settings.click (e) =>\r\n            e.preventDefault()\r\n            @misc_settings_modal.modal()\r\n            @misc_settings_initiative_prefix.prop('checked', exportObj.settings?.initiative_prefix? and exportObj.settings.initiative_prefix)\r\n\r\n        exportObj.translateUIElements(@misc_settings_modal) \r\n\r\n        @choose_obstacles_modal = $ document.createElement 'DIV'\r\n        @choose_obstacles_modal.addClass 'modal fade choose-obstacles-modal'\r\n        @choose_obstacles_modal.tabindex = \"-1\"\r\n        @choose_obstacles_modal.role = \"dialog\"\r\n        @container.append @choose_obstacles_modal\r\n        @choose_obstacles_modal.append $.trim \"\"\"\r\n    <div class=\"modal-dialog modal-dialog-centered modal-dialog-scrollable\" role=\"document\">\r\n        <div class=\"modal-content\">\r\n            <div class=\"modal-header\">\r\n                <label class='choose-obstacles-description translated' defaultText=\"Choose obstacles dialog\"></label>\r\n            </div>\r\n            <div class=\"modal-body row\">\r\n                <div class=\"obstacle-select-container col-md-12\">\r\n                </div>\r\n                <div>\r\n                    <div class=\"obstacle-sources-container\">\r\n                        <span class=\"info-header obstacle-sources translated\" defaultText=\"Sources:\" style=\"padding-left: 8px;\"></span> <br>\r\n                        <div class=\"info-data obstacle-sources\" style=\"padding-left: 8px;padding-right:10px;\"></div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"modal-footer d-print-none\">\r\n                <button class=\"btn btn-danger reset-obstacles translated\" defaultText=\"Reset Obstacles\"></button>\r\n                <button class=\"btn btn-danger close-print-dialog translated\" data-dismiss=\"modal\" aria-hidden=\"true\" defaultText=\"Close\"></button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n        \"\"\"\r\n        @obstacles_reset = @choose_obstacles_modal.find('.reset-obstacles')\r\n        @obstacles_select = @choose_obstacles_modal.find('.obstacle-select-container')\r\n        @obstacles_select_sources = @choose_obstacles_modal.find('.info-data.obstacle-sources')\r\n\r\n        obstacleFormat = (state) ->\r\n            image_name = 'images/' + state.id + '.png'\r\n            return \"<img class='obstacle' src='#{image_name}' style='height: 100px;' /></br>\" + state.text\r\n\r\n        @obstacle_data = [\r\n            {\r\n                id: \"coreasteroid0\"\r\n                text: \"Core Asteroid 1\"\r\n            }\r\n            {\r\n                id: \"coreasteroid1\"\r\n                text: \"Core Asteroid 2\"\r\n            }\r\n            {\r\n                id: \"coreasteroid2\"\r\n                text: \"Core Asteroid 3\"\r\n            }\r\n            {\r\n                id: \"coreasteroid3\"\r\n                text: \"Core Asteroid 4\"\r\n            }\r\n            {\r\n                id: \"coreasteroid4\"\r\n                text: \"Core Asteroid 5\"\r\n            }\r\n            {\r\n                id: \"coreasteroid5\"\r\n                text: \"Core Asteroid 6\"\r\n            }\r\n            {\r\n                id: \"yt2400debris0\"\r\n                text: \"YT2400 Debris 1\"\r\n            }\r\n            {\r\n                id: \"yt2400debris1\"\r\n                text: \"YT2400 Debris 2\"\r\n            }\r\n            {\r\n                id: \"yt2400debris2\"\r\n                text: \"YT2400 Debris 3\"\r\n            }\r\n            {\r\n                id: \"vt49decimatordebris0\"\r\n                text: \"VT49 Debris 1\"\r\n            }\r\n            {\r\n                id: \"vt49decimatordebris1\"\r\n                text: \"VT49 Debris 2\"\r\n            }\r\n            {\r\n                id: \"vt49decimatordebris2\"\r\n                text: \"VT49 Debris 3\"\r\n            }\r\n            {\r\n                id: \"core2asteroid0\"\r\n                text: \"FA Asteroid 1\"\r\n            }\r\n            {\r\n                id: \"core2asteroid1\"\r\n                text: \"FA Asteroid 2\"\r\n            }\r\n            {\r\n                id: \"core2asteroid2\"\r\n                text: \"FA Asteroid 3\"\r\n            }\r\n            {\r\n                id: \"core2asteroid3\"\r\n                text: \"FA Asteroid 4\"\r\n            }\r\n            {\r\n                id: \"core2asteroid4\"\r\n                text: \"FA Asteroid 5\"\r\n            }\r\n            {\r\n                id: \"core2asteroid5\"\r\n                text: \"FA Asteroid 6\"\r\n            }\r\n            {\r\n                id: \"gascloud1\"\r\n                text: \"Gas Cloud 1\"\r\n            }\r\n            {\r\n                id: \"gascloud2\"\r\n                text: \"Gas Cloud 2\"\r\n            }\r\n            {\r\n                id: \"gascloud3\"\r\n                text: \"Gas Cloud 3\"\r\n            }\r\n            {\r\n                id: \"gascloud4\"\r\n                text: \"Gas Cloud 4\"\r\n            }\r\n            {\r\n                id: \"gascloud5\"\r\n                text: \"Gas Cloud 5\"\r\n            }\r\n            {\r\n                id: \"gascloud6\"\r\n                text: \"Gas Cloud 6\"\r\n            }\r\n            {\r\n                id: \"pomasteroid1\"\r\n                text: \"PoM Rock 1\"\r\n            }\r\n            {\r\n                id: \"pomasteroid2\"\r\n                text: \"PoM Rock 2\"\r\n            }\r\n            {\r\n                id: \"pomasteroid3\"\r\n                text: \"PoM Rock 3\"\r\n            }\r\n            {\r\n                id: \"pomdebris1\"\r\n                text: \"PoM Debris 1\"\r\n            }\r\n            {\r\n                id: \"pomdebris2\"\r\n                text: \"PoM Debris 2\"\r\n            }\r\n            {\r\n                id: \"pomdebris3\"\r\n                text: \"PoM Debris 3\"\r\n            }\r\n        ]\r\n\r\n        @obstacles_select.select2\r\n            data: @obstacle_data\r\n            width: '90%'\r\n            multiple: true\r\n            maximumSelectionSize: 3\r\n            placeholder: \"Select an Obstacle\"\r\n            minimumResultsForSearch: if $.isMobile() then -1 else 0\r\n            formatResult: obstacleFormat\r\n            formatSelection: obstacleFormat\r\n        # Backend\r\n\r\n        @obstacles_select.select2.minimumResultsForSearch = -1 if $.isMobile()\r\n        @backend_list_squads_button = $ @container.find('button.backend-list-my-squads')\r\n        @backend_list_squads_button.click (e) =>\r\n            e.preventDefault()\r\n            if @backend?\r\n                @backend.list this\r\n        @backend_save_list_button = $ @container.find('button.save-list')\r\n        @backend_save_list_button.click (e) =>\r\n            e.preventDefault()\r\n            if @backend? and not @backend_save_list_button.hasClass('disabled')\r\n                additional_data =\r\n                    points: @total_points\r\n                    description: @describeSquad()\r\n                    cards: @listCards()\r\n                    notes: @notes.val().substr(0, 1024)\r\n                    obstacles: @getObstacles()\r\n                    tag: @tag.val().substr(0, 1024)\r\n                @backend_status.html $.trim \"\"\"\r\n                    <i class=\"fa fa-sync fa-spin\"></i>&nbsp;<span class=\"translated\" defaultText=\"Saving squad...\"></span>\r\n                \"\"\"\r\n                @backend_status.show()\r\n                @backend_save_list_button.addClass 'disabled'\r\n                await @backend.save @serialize(), @current_squad.id, @current_squad.name, @faction, additional_data, (results)=>\r\n                    if results.success\r\n                        @current_squad.dirty = false\r\n                        if @current_squad.id?\r\n                            @backend_status.html $.trim \"\"\"\r\n                                <i class=\"fa fa-check\"></i>&nbsp;<span class=\"translated\" defaultText=\"Squad updated successfully.\"></span>\r\n                            \"\"\"\r\n                        else\r\n                            @backend_status.html $.trim \"\"\"\r\n                                <i class=\"fa fa-check\"></i>&nbsp;<span class=\"translated\" defaultText=\"New squad saved successfully.\"></span>\r\n                            \"\"\"\r\n                            @current_squad.id = results.id\r\n                        @container.trigger 'xwing-backend:squadDirtinessChanged'\r\n                    else\r\n                        @backend_status.html $.trim \"\"\"\r\n                            <i class=\"fa fa-exclamation-circle\"></i>&nbsp;#{results.error}\r\n                        \"\"\"\r\n                        @backend_save_list_button.removeClass 'disabled'\r\n        @backend_save_list_as_button = $ @container.find('button.save-list-as')\r\n        @backend_save_list_as_button.addClass 'disabled'\r\n        @backend_save_list_as_button.click (e) =>\r\n            e.preventDefault()\r\n            if @backend? and not @backend_save_list_as_button.hasClass('disabled')\r\n                @backend.showSaveAsModal this\r\n        @backend_delete_list_button = $ @container.find('button.delete-list')\r\n        @backend_delete_list_button.click (e) =>\r\n            e.preventDefault()\r\n            if @backend? and not @backend_delete_list_button.hasClass('disabled')\r\n\r\n                @backend.showDeleteModal this\r\n\r\n        content_container = $ document.createElement 'DIV'\r\n        content_container.addClass 'container-fluid'\r\n        @container.append content_container\r\n        content_container.append $.trim \"\"\"\r\n            <div class=\"row\">\r\n                <div class=\"col-md-9 ship-container\">\r\n                    <label class=\"unsortable notes-container show-authenticated col-md-10\">\r\n                        <span class=\"notes-name translated\" defaultText=\"Squad Notes:\"></span>\r\n                        <br />\r\n                        <textarea class=\"squad-notes\"></textarea>\r\n                        <br />\r\n                        <span class=\"tag-name translated\" defaultText=\"Tag:\"></span>\r\n                        <input type=\"search\" class=\"squad-tag\"></input>\r\n                    </label>\r\n                    <div class=\"unsortable obstacles-container\">\r\n                            <button class=\"btn btn-info choose-obstacles\"><i class=\"fa fa-cloud\"></i>&nbsp;<span class=\"translated\" defaultText=\"Choose Obstacles\"</span></button>\r\n                    </div>\r\n                </div>\r\n                <div class=\"col-md-3 info-container\" id=\"info-container\">\r\n                </div>\r\n            </div>\r\n        \"\"\"\r\n\r\n        @ship_container = $ content_container.find('div.ship-container')\r\n        @info_container = $ content_container.find('div.info-container')\r\n        @obstacles_container = content_container.find('.obstacles-container')\r\n        @notes_container = $ content_container.find('.notes-container')\r\n        @notes = $ @notes_container.find('textarea.squad-notes')\r\n        @tag = $ @notes_container.find('input.squad-tag')\r\n\r\n        @ship_container.sortable\r\n            cancel: '.unsortable'\r\n\r\n        @info_container.append $.trim @createInfoContainerUI()\r\n        @info_container.find('.info-well').hide()\r\n        @info_intro = @info_container.find('.intro')\r\n\r\n        @print_list_button = $ @container.find('button.print-list')\r\n\r\n        @container.find('[rel=tooltip]').tooltip()\r\n\r\n        # obstacles\r\n        @obstacles_button = $ @container.find('button.choose-obstacles')\r\n        @obstacles_button.click (e) =>\r\n            e.preventDefault()\r\n            @showChooseObstaclesModal()\r\n\r\n        # conditions\r\n        @condition_container = $ document.createElement('div')\r\n        @condition_container.addClass 'conditions-container d-flex flex-wrap col-md-9'\r\n        @container.append @condition_container\r\n\r\n        @mobile_tooltip_modal = $ document.createElement 'DIV'\r\n        @mobile_tooltip_modal.addClass 'modal fade choose-obstacles-modal d-print-none'\r\n        @mobile_tooltip_modal.tabindex = \"-1\"\r\n        @mobile_tooltip_modal.role = \"dialog\"\r\n        @container.append @mobile_tooltip_modal\r\n        @mobile_tooltip_modal.append $.trim \"\"\"\r\n    <div class=\"modal-dialog modal-dialog-centered modal-dialog-scrollable\" role=\"document\">\r\n        <div class=\"modal-content\">\r\n            <div class=\"modal-header\">\r\n            </div>\r\n            <div class=\"modal-body\">\r\n                \"\"\" + @createInfoContainerUI(false) + \"\"\"\r\n            </div>\r\n            <div class=\"modal-footer\">\r\n                <button class=\"btn btn-danger close-print-dialog translated\" data-dismiss=\"modal\" aria-hidden=\"true\" defaultText=\"Close\"></button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n        \"\"\"\r\n        @mobile_tooltip_modal.find('intro').hide()\r\n\r\n        # translate all the UI we just created to current language\r\n        exportObj.translateUIElements(@container) \r\n\r\n    createInfoContainerUI: (include_intro = true) ->\r\n        if include_intro == true\r\n            intro = \"\"\"\r\n                <div class=\"card intro translated\" defaultText=\"Intro Card YASB\">\r\n                </div>\r\n            \"\"\"\r\n        else\r\n            intro = \"\"\r\n\r\n        return \"\"\"\r\n            #{intro}\r\n            <div class=\"card info-well\">\r\n                <div class=\"info-name\"></div>\r\n                <div class=\"info-type\"></div>\r\n                <span class=\"info-collection\"></span>\r\n                <div class=\"row\">\r\n                    <div class=\"col-sm-5\">\r\n                        <table class=\"table-sm\">\r\n                            <tbody>\r\n                                <tr class=\"info-attack-bullseye\">\r\n                                    <td class=\"info-header\"><i class=\"xwing-miniatures-font header-attack xwing-miniatures-font-bullseyearc\"></i></td>\r\n                                    <td class=\"info-data info-attack\"></td>\r\n                                </tr>\r\n                                <tr class=\"info-attack\">\r\n                                    <td class=\"info-header\"><i class=\"xwing-miniatures-font header-attack xwing-miniatures-font-frontarc\"></i></td>\r\n                                    <td class=\"info-data info-attack\"></td>\r\n                                </tr>\r\n                                <tr class=\"info-attack-fullfront\">\r\n                                    <td class=\"info-header\"><i class=\"xwing-miniatures-font header-attack xwing-miniatures-font-fullfrontarc\"></i></td>\r\n                                    <td class=\"info-data info-attack\"></td>\r\n                                </tr>\r\n                                <tr class=\"info-attack-left\">\r\n                                    <td class=\"info-header\"><i class=\"xwing-miniatures-font header-attack xwing-miniatures-font-leftarc\"></i></td>\r\n                                    <td class=\"info-data info-attack\"></td>\r\n                                </tr>\r\n                                <tr class=\"info-attack-right\">\r\n                                    <td class=\"info-header\"><i class=\"xwing-miniatures-font header-attack xwing-miniatures-font-rightarc\"></i></td>\r\n                                    <td class=\"info-data info-attack\"></td>\r\n                                </tr>\r\n                                <tr class=\"info-attack-back\">\r\n                                    <td class=\"info-header\"><i class=\"xwing-miniatures-font header-attack xwing-miniatures-font-reararc\"></i></td>\r\n                                    <td class=\"info-data info-attack\"></td>\r\n                                </tr>\r\n                                <tr class=\"info-attack-turret\">\r\n                                    <td class=\"info-header\"><i class=\"xwing-miniatures-font header-attack xwing-miniatures-font-singleturretarc\"></i></td>\r\n                                    <td class=\"info-data info-attack\"></td>\r\n                                </tr>\r\n                                <tr class=\"info-attack-doubleturret\">\r\n                                    <td class=\"info-header\"><i class=\"xwing-miniatures-font header-attack xwing-miniatures-font-doubleturretarc\"></i></td>\r\n                                    <td class=\"info-data info-attack\"></td>\r\n                                </tr>\r\n                                <tr class=\"info-agility\">\r\n                                    <td class=\"info-header\"><i class=\"xwing-miniatures-font header-agility xwing-miniatures-font-agility\"></i></td>\r\n                                    <td class=\"info-data info-agility\"></td>\r\n                                </tr>\r\n                                <tr class=\"info-hull\">\r\n                                    <td class=\"info-header\"><i class=\"xwing-miniatures-font header-hull xwing-miniatures-font-hull\"></i></td>\r\n                                    <td class=\"info-data info-hull\"></td>\r\n                                </tr>\r\n                                <tr class=\"info-shields\">\r\n                                    <td class=\"info-header\"><i class=\"xwing-miniatures-font header-shield xwing-miniatures-font-shield\"></i></td>\r\n                                    <td class=\"info-data info-shields\"></td>\r\n                                </tr>\r\n                                <tr class=\"info-force\">\r\n                                    <td class=\"info-header\"><i class=\"xwing-miniatures-font header-force xwing-miniatures-font-forcecharge\"></i></td>\r\n                                    <td class=\"info-data info-force\"></td>\r\n                                </tr>\r\n                                <tr class=\"info-charge\">\r\n                                    <td class=\"info-header\"><i class=\"xwing-miniatures-font header-charge xwing-miniatures-font-charge\"></i></td>\r\n                                    <td class=\"info-data info-charge\"></td>\r\n                                </tr>\r\n                                <tr class=\"info-energy\">\r\n                                    <td class=\"info-header\"><i class=\"xwing-miniatures-font header-energy xwing-miniatures-font-energy\"></i></td>\r\n                                    <td class=\"info-data info-energy\"></td>\r\n                                </tr>\r\n                                <tr class=\"info-range\">\r\n                                    <td class=\"info-header translated\" defaultText=\"Range\"></td>\r\n                                    <td class=\"info-data info-range\"></td><td class=\"info-rangebonus\"><i class=\"xwing-miniatures-font red header-range xwing-miniatures-font-rangebonusindicator\"></i></td>\r\n                                </tr>\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                    <div class=\"col-sm-7\">\r\n                        <table class=\"table-sm\">\r\n                            <tbody>\r\n                                <tr class=\"info-skill\">\r\n                                    <td class=\"info-header translated\" defaultText=\"Initiative\"></td>\r\n                                    <td class=\"info-data info-skill\"></td>\r\n                                </tr>\r\n                                <tr class=\"info-engagement\">\r\n                                    <td class=\"info-header translated\" defaultText=\"Engagement\"></td>\r\n                                    <td class=\"info-data info-engagement\"></td>\r\n                                </tr>\r\n                                <tr class=\"info-faction\">\r\n                                    <td class=\"info-header translated\" defaultText=\"Faction\"></td>\r\n                                    <td class=\"info-data\"></td>\r\n                                </tr>\r\n                                <tr class=\"info-base\">\r\n                                    <td class=\"info-header translated\" defaultText=\"Base\"></td>\r\n                                    <td class=\"info-data\"></td> \r\n                                </tr>\r\n                                <tr class=\"info-points\">\r\n                                    <td class=\"info-header translated\" defaultText=\"Points\"></td>\r\n                                    <td class=\"info-data info-points\"></td>\r\n                                </tr>\r\n                                <tr class=\"info-loadout\">\r\n                                    <td class=\"info-header translated\" defaultText=\"Loadout\"></td>\r\n                                    <td class=\"info-data info-loadout\"></td>\r\n                                </tr>\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                </div>\r\n                <table class=\"table-sm\">\r\n                    <tbody>\r\n                        <tr class=\"info-ship\">\r\n                            <td class=\"info-header translated\" defaultText=\"Ship\"></td>\r\n                            <td class=\"info-data\"></td>\r\n                        </tr>\r\n                        <tr class=\"info-actions\">\r\n                            <td class=\"info-header translated\" defaultText=\"Actions\"></td>\r\n                            <td class=\"info-data\"></td>\r\n                        </tr>\r\n                        <tr class=\"info-upgrades\">\r\n                            <td class=\"info-header translated\" defaultText=\"Upgrades\"></td>\r\n                            <td class=\"info-data\"></td>\r\n                        </tr>\r\n                    </tbody>\r\n                </table>\r\n                <p class=\"info-restrictions\"></p>\r\n                <p class=\"info-text\"></p>\r\n                <p class=\"info-chassis\"></p>\r\n                <p class=\"info-maneuvers\"></p>\r\n                <br />\r\n                <span class=\"info-header info-sources translated\" defaultText=\"Sources:\"></span> \r\n                <span class=\"info-data info-sources\"></span>\r\n            </div>\r\n        \"\"\"\r\n\r\n    setupEventHandlers: ->\r\n        @container.on 'xwing:claimUnique', (e, unique, type, cb) =>\r\n            @claimUnique unique, type, cb\r\n        .on 'xwing:releaseUnique', (e, unique, type, cb) =>\r\n            @releaseUnique unique, type, cb\r\n        .on 'xwing:pointsUpdated', (e, cb=$.noop) =>\r\n            if @isUpdatingPoints\r\n                cb()\r\n            else\r\n                @isUpdatingPoints = true\r\n                @onPointsUpdated () =>\r\n                    @isUpdatingPoints = false\r\n                    cb()\r\n        .on 'xwing-backend:squadLoadRequested', (e, squad, cb=$.noop) =>\r\n            @onSquadLoadRequested squad, cb\r\n        .on 'xwing-backend:squadDirtinessChanged', (e) =>\r\n            @onSquadDirtinessChanged()\r\n        .on 'xwing-backend:squadNameChanged', (e) =>\r\n            @onSquadNameChanged()\r\n        .on 'xwing:beforeLanguageLoad', (e, cb=$.noop) =>\r\n            @pretranslation_serialized = @serialize()\r\n            cb()\r\n        .on 'xwing:afterLanguageLoad', (e, language, cb=$.noop) =>\r\n            if @language != language\r\n                @language = language\r\n                old_dirty = @current_squad.dirty\r\n                if @pretranslation_serialized.length?\r\n                    @loadFromSerialized @pretranslation_serialized\r\n                for ship in @ships\r\n                    ship.updateSelections()\r\n                @current_squad.dirty = old_dirty\r\n                @pretranslation_serialized = undefined\r\n            cb()\r\n        # Recently moved this here.  Did this ever work?\r\n        .on 'xwing:shipUpdated', (e, cb=$.noop) =>\r\n            all_allocated = true\r\n            for ship in @ships\r\n                ship.updateSelections()\r\n                if ship.ship_selector.val() == ''\r\n                    all_allocated = false\r\n            #console.log \"all_allocated is #{all_allocated}, suppress_automatic_new_ship is #{@suppress_automatic_new_ship}\"\r\n            #console.log \"should we add ship: #{all_allocated and not @suppress_automatic_new_ship}\"\r\n            @addShip() if all_allocated and not @suppress_automatic_new_ship\r\n\r\n        $(window).on 'xwing-backend:authenticationChanged', (e) =>\r\n            @resetCurrentSquad()\r\n        .on 'xwing-collection:created', (e, collection) =>\r\n            # console.log \"#{@faction}: collection was created\"\r\n            @collection = collection\r\n            # console.log \"#{@faction}: Collection created, checking squad\"\r\n            # @collection.onLanguageChange null, @language\r\n            @checkCollection()\r\n            @collection_button.removeClass 'd-none'\r\n        .on 'xwing-collection:changed', (e, collection) =>\r\n            # console.log \"#{@faction}: Collection changed, checking squad\"\r\n            @checkCollection()\r\n        .on 'xwing-collection:destroyed', (e, collection) =>\r\n            @collection = null\r\n            @collection_button.addClass 'd-none'\r\n        .on 'xwing:pingActiveBuilder', (e, cb) =>\r\n            cb(this) if @container.is(':visible')\r\n        .on 'xwing:activateBuilder', (e, faction, cb) =>\r\n            if faction == @faction\r\n                @tab.tab('show')\r\n                cb this\r\n        .on 'xwing:gameTypeChanged', (e, gameType, cb=$.noop) =>\r\n            @onGameTypeChanged gameType, cb\r\n            if @game_type_selector.val() != gameType\r\n                @game_type_selector.val(gameType).trigger('change')\r\n\r\n        @ship_container.on 'sortstart', (e, ui) =>\r\n            @oldIndex = ui.item.index()\r\n        .on 'sortstop', (e, ui) =>\r\n            @updateShipOrder(@oldIndex, ui.item.index())\r\n\r\n        @obstacles_reset.click (e) =>\r\n            if @current_obstacles != []\r\n                @current_obstacles = []\r\n                @obstacles_select.select2('data', null)\r\n                @current_squad.additional_data.obstacles = @current_obstacles\r\n                @current_squad.dirty = true\r\n                @container.trigger 'xwing-backend:squadDirtinessChanged'\r\n                @container.trigger 'xwing:pointsUpdated'        \r\n\r\n        @obstacles_select.change (e) =>\r\n            @current_obstacles = @obstacles_select.val().split(',')\r\n            @current_squad.additional_data.obstacles = @current_obstacles\r\n            @current_squad.dirty = true\r\n            @showObstaclesSelectInfo()\r\n            @container.trigger 'xwing-backend:squadDirtinessChanged'\r\n            @container.trigger 'xwing:pointsUpdated'\r\n\r\n        @view_list_button.click (e) =>\r\n            e.preventDefault()\r\n            @showTextListModal()\r\n\r\n        #Print Button\r\n        @print_list_button.click (e) =>\r\n            e.preventDefault()\r\n            # Copy text list to printable\r\n            @printable_container.find('.printable-header').html @list_modal.find('.modal-header').html()\r\n            @printable_container.find('.printable-body').text ''\r\n            switch @list_display_mode\r\n                when 'simple'\r\n                    @printable_container.find('.printable-body').html @simple_container.html()\r\n                else\r\n                    for ship in @ships\r\n                        @printable_container.find('.printable-body').append ship.toHTML() if ship.pilot?\r\n                    if @list_modal.find('.toggle-horizontal-space').prop('checked')then @printable_container.find('.upgrade-container').addClass('wide')\r\n                    @printable_container.find('.printable-body').toggleClass 'bw', not @list_modal.find('.toggle-color-print').prop('checked')\r\n                    if @list_modal.find('.toggle-skip-text-print').prop('checked')\r\n                        for text in @printable_container.find('.upgrade-text, .fancy-pilot-text')\r\n                            text.hidden = true\r\n                    if @list_modal.find('.toggle-maneuver-print').prop('checked')\r\n                        @printable_container.find('.printable-body').append @getSquadDialsAsHTML()\r\n                    expanded_hull_and_shield = @list_modal.find('.toggle-expanded-shield-hull-print').prop('checked')\r\n                    for container in @printable_container.find('.expanded-hull-or-shield')\r\n                        container.hidden = not expanded_hull_and_shield\r\n                    for container in @printable_container.find('.simple-hull-or-shield')\r\n                        container.hidden = expanded_hull_and_shield\r\n\r\n                    faction = switch @faction\r\n                        when 'Rebel Alliance'\r\n                            'rebel'\r\n                        when 'Galactic Empire'\r\n                            'empire'\r\n                        when 'Scum and Villainy'\r\n                            'scum'\r\n                        when 'Resistance'\r\n                            'rebel-outline'\r\n                        when 'First Order'\r\n                            'firstorder'\r\n                        when 'Galactic Republic'\r\n                            'republic'\r\n                        when 'Separatist Alliance'\r\n                            'separatists'\r\n                        when 'All'\r\n                            'first-player-4'\r\n\r\n                    if @list_modal.find('.toggle-color-print').prop('checked')then @printable_container.find('.fancy-header').addClass(faction)\r\n                    if @list_modal.find('.toggle-color-print').prop('checked')then @printable_container.find('.fancy-pilot-header').addClass(\"#{faction}-pilot\")\r\n\r\n                    @printable_container.find('.squad-faction').html \"\"\"<i class=\"xwing-miniatures-font xwing-miniatures-font-#{faction}\"></i>\"\"\"\r\n            # List type\r\n            if @isStandard\r\n                @printable_container.find('.squad-name').append \"\"\" <i class=\"xwing-miniatures-font xwing-miniatures-font-first-player-1\"></i>\"\"\"\r\n            if @isEpic\r\n                @printable_container.find('.squad-name').append \"\"\" <i class=\"xwing-miniatures-font xwing-miniatures-font-energy\"></i>\"\"\" \r\n            if @isBeta\r\n                @printable_container.find('.squad-name').append \"\"\" <i class=\"xwing-miniatures-font xwing-miniatures-font-point\"></i>\"\"\" \r\n\r\n            versioninfo = \"50P-1.0\"\r\n            rules = \"XWA\"\r\n\r\n            # Version number\r\n            @printable_container.find('.fancy-under-header').append $.trim \"\"\"\r\n                <div class=\"version\">Points Version: #{rules} - #{versioninfo}</div>\r\n            \"\"\"\r\n                    \r\n            # Notes, if present\r\n            if $.trim(@notes.val()) != ''\r\n                @printable_container.find('.printable-body').append $.trim \"\"\"\r\n                    <h5 class=\"print-notes translated\" defaultText=\"Notes:\"></h5>\r\n                    <pre class=\"print-notes\"></pre>\r\n                \"\"\"            \r\n                @printable_container.find('.printable-body pre.print-notes').text @notes.val()\r\n            else\r\n\r\n            # Conditions\r\n            @printable_container.find('.printable-body').append $.trim \"\"\"\r\n                <div class=\"print-conditions\"></div>\r\n            \"\"\"\r\n            @printable_container.find('.printable-body .print-conditions').html @condition_container.html()\r\n\r\n            # Obstacles\r\n            if @list_modal.find('.toggle-obstacles').prop('checked')\r\n                obstacles = @getObstacles()\r\n                obstaclelist = \"\"\r\n                for obstaclename in obstacles\r\n                    obstaclelist += \"\"\"<img class=\"obstacle-silhouettes\" src=\"images/#{obstaclename}.png\" />\"\"\"\r\n\r\n                @printable_container.find('.printable-body').append $.trim \"\"\"\r\n                    <div class=\"obstacles\">\r\n                        <div>Chosen Obstacles:<br>#{obstaclelist}</div>\r\n                    </div>\r\n                \"\"\"\r\n\r\n            # Add QR code\r\n            query = @getPermaLinkParams(['sn', 'obs'])\r\n            if query? and @list_modal.find('.toggle-juggler-qrcode').prop('checked')\r\n                @printable_container.find('.printable-body').append $.trim \"\"\"\r\n                <div class=\"qrcode-container\">\r\n                    <div class=\"permalink-container\">\r\n                        <div class=\"qrcode\">YASB Link</div>\r\n                        <div class=\"qrcode-text translated\" defaultText=\"Scan QR-Code\"></div>\r\n                    </div>\r\n                    <div class=\"xws-container\">\r\n                        <div class=\"qrcode\">XWS Data</div>\r\n                        <div class=\"qrcode-text translated\" defaultText=\"XWS QR-Code\"></div>\r\n                    </div>\r\n                </div>\r\n                \"\"\"\r\n                text = JSON.stringify(@toXWS())\r\n                # console.log \"#{text}\"\r\n                @printable_container.find('.xws-container .qrcode').qrcode\r\n                    render: 'div'\r\n                    ec: 'M'\r\n                    size: if text.length < 144 then 144 else 256\r\n                    text: text\r\n                text = \"https://yasb.app/#{query}\"\r\n                @printable_container.find('.permalink-container .qrcode').qrcode\r\n                    render: 'div'\r\n                    ec: 'M'\r\n                    size: if text.length < 144 then 144 else 256\r\n                    text: text\r\n\r\n            #Trigger List\r\n            triggertext = \"while you perform\"\r\n            sectiontext = \"\"\r\n            for ship in @ships\r\n                if (ship.pilot?.text?) and (ship.pilot.text.match(triggertext) > -1)\r\n                    sectiontext = sectiontext + \"#{ship.pilot.name} <br><br>\"\r\n                for upgrade in ship.upgrades\r\n                    if (upgrade.text?) and (upgrade.text.match(triggertext) > -1)\r\n                        sectiontext = sectiontext + \"#{upgrade.name} <br><br>\"\r\n\r\n            window.print()\r\n\r\n        $(window).resize =>\r\n            @select_simple_view_button.click() if $(window).width() < 768 and @list_display_mode != 'simple'\r\n            for ship in @ships\r\n                ship.checkPilotSelectorQueryModal()\r\n\r\n\r\n\r\n         @notes.change @onNotesUpdated\r\n                \r\n         @tag.change @onNotesUpdated\r\n\r\n         @notes.on 'keyup', @onNotesUpdated\r\n         @tag.on 'keyup', @onNotesUpdated\r\n\r\n    getPermaLinkParams: (ignored_params=[]) =>\r\n        params = {}\r\n        params.f = encodeURI(@faction) unless 'f' in ignored_params\r\n        params.d = encodeURI(@serialize()) unless 'd' in ignored_params\r\n        params.sn = encodeURIComponent(@current_squad.name) unless 'sn' in ignored_params\r\n        params.obs = encodeURI(@current_squad.additional_data.obstacles || '') unless 'obs' in ignored_params\r\n        return \"?\" + (\"#{k}=#{v}\" for k, v of params).join(\"&\")\r\n\r\n    getPermaLink: (params=@getPermaLinkParams()) => \"#{URL_BASE}#{params}\"\r\n\r\n    updateShipOrder: (oldpos, newpos) =>\r\n        selectedShip = @ships[oldpos]\r\n        @ships.splice(oldpos, 1)\r\n        @ships.splice(newpos, 0, selectedShip)\r\n        @updatePermaLink\r\n        if oldpos != newpos\r\n            @current_squad.dirty = true\r\n            @container.trigger 'xwing-backend:squadDirtinessChanged'\r\n\r\n    updatePermaLink: () =>\r\n        return unless @container.is(':visible') # gross but couldn't make clearInterval work\r\n        next_params = @getPermaLinkParams()\r\n        if window.location.search != next_params\r\n          window.history.replaceState(next_params, '', @getPermaLink(next_params))\r\n\r\n    onNotesUpdated: =>\r\n        if @total_points > 0\r\n            @current_squad.dirty = true\r\n            @container.trigger 'xwing-backend:squadDirtinessChanged'\r\n\r\n    onGameTypeChanged: (gametype, cb=$.noop) =>\r\n        oldQuickbuild = @isQuickbuild\r\n        @isStandard = false\r\n        @isBeta = false\r\n        @isEpic = false\r\n        @isQuickbuild = false\r\n        @epic_not_legal_container.toggleClass 'd-none', true\r\n        switch gametype\r\n            when 'beta'\r\n                @isBeta = true\r\n                @desired_points_input.val 50\r\n            when 'xwa'\r\n                @desired_points_input.val 50\r\n            when 'epic'\r\n                @isEpic = true\r\n                @isBeta = true\r\n                @desired_points_input.val 100\r\n                @epic_not_legal_container.toggleClass 'd-none', false\r\n            when 'quickbuild'\r\n                @isQuickbuild = true\r\n                @desired_points_input.val 8\r\n            else\r\n                @isStandard = true\r\n                @desired_points_input.val 50\r\n        if oldQuickbuild != @isQuickbuild\r\n            old_id = @current_squad.id\r\n            @newSquadFromScratch($.trim(@current_squad.name))\r\n            @current_squad.id = old_id # we want to keep the ID, so we allow people to use the save button\r\n        else\r\n            old_id = @current_squad.id\r\n            for ship in @ships\r\n                if ship.pilot?\r\n                    ship.setPilotById ship.pilot?.id\r\n            @container.trigger 'xwing:pointsUpdated', $.noop\r\n            @container.trigger 'xwing:shipUpdated'\r\n        cb()\r\n\r\n    addStandardizedToList: (ship) ->\r\n        ship.addStandardizedUpgrades()\r\n\r\n    onPointsUpdated: (cb=$.noop) =>\r\n        tot_points = 0\r\n        points_dest = 0\r\n        unreleased_content_used = false\r\n        # validating may remove the ship, if not only some upgrade, but the pilot himself is not valid. Thus iterate backwards over the array, so that is probably fine?\r\n        \r\n        for i in [@ships.length - 1 ... -1]\r\n            ship = @ships[i]\r\n            ship.validate()\r\n            continue unless ship # if the ship has been removed, we no longer care about it\r\n            # Standardized Loop, will integrate later for efficiency\r\n            @addStandardizedToList(ship)\r\n\r\n            tot_points += ship.getPoints()\r\n            if ship.destroystate == 1\r\n                points_dest += Math.floor ship.getPoints() / 2\r\n            else if ship.destroystate == 2\r\n                points_dest += ship.getPoints()\r\n            ship_uses_unreleased_content = ship.checkUnreleasedContent()\r\n            unreleased_content_used = ship_uses_unreleased_content if ship_uses_unreleased_content\r\n\r\n\r\n        @total_points = tot_points\r\n        @points_destroyed = points_dest\r\n        @total_points_span.text @total_points\r\n        points_left = parseInt(@desired_points_input.val()) - @total_points\r\n        points_destroyed = parseInt(@total_points)\r\n        @points_remaining_span.text points_left\r\n        @points_destroyed_span.html if points_dest != 0 then \"\"\"<i class=\"xwing-miniatures-font xwing-miniatures-font-hit\"></i>#{points_dest}\"\"\" else \"\"\r\n        @points_remaining_container.toggleClass 'red', (points_left < 0)\r\n        @unreleased_content_used_container.toggleClass 'd-none', not unreleased_content_used\r\n\r\n        if @isStandard == false then gamemode = \"(XWA)\" else gamemode = \"(HYPERSPACE)\"\r\n        if @isBeta then gamemode = \"(BETA)\" \r\n        if @isEpic then gamemode = \"(Epic)\"\r\n        @fancy_total_points_container.text \"\"\"(#{@total_points}) #{gamemode}\"\"\"\r\n        \r\n        # update text list\r\n        @updatePrintAndExportTexts()\r\n\r\n        # console.log \"#{@faction}: Squad updated, checking collection\"\r\n        @checkCollection()\r\n\r\n        # update conditions used\r\n        # this old version of phantomjs i'm using doesn't support Set\r\n        if Set?\r\n            conditions_set = new Set()\r\n            for ship in @ships\r\n                # shouldn't there be a set union\r\n                ship.getConditions().forEach (condition) ->\r\n                    conditions_set.add(condition)\r\n            conditions = []\r\n            conditions_set.forEach (condition) ->\r\n                conditions.push(condition)\r\n            conditions.sort (a, b) ->\r\n                if a.name.canonicalize() < b.name.canonicalize()\r\n                    -1\r\n                else if b.name.canonicalize() > a.name.canonicalize()\r\n                    1\r\n                else\r\n                    0\r\n            @condition_container.text ''\r\n            conditions.forEach (condition) =>\r\n                @condition_container.append conditionToHTML(condition)\r\n\r\n        cb @total_points\r\n\r\n\r\n    onSquadLoadRequested: (squad, cb=$.noop) =>\r\n        @current_squad = squad\r\n        @backend_delete_list_button.removeClass 'disabled'\r\n        @updateObstacleSelect(@current_squad.additional_data.obstacles)\r\n        afterLoading = () =>\r\n            @notes.val(squad.additional_data.notes ? '')\r\n            @tag.val(squad.additional_data.tag ? '')\r\n            @backend_status.fadeOut 'slow'\r\n            @current_squad.dirty = false\r\n            @container.trigger 'xwing-backend:squadNameChanged'\r\n            @container.trigger 'xwing-backend:squadDirtinessChanged'\r\n            cb()\r\n        if squad.serialized?.length?\r\n            @loadFromSerialized squad.serialized, afterLoading\r\n        else:\r\n            afterLoading()\r\n\r\n\r\n    onSquadDirtinessChanged: () =>\r\n        #@current_squad.name = $.trim(@squad_name_input.val())\r\n        @backend_save_list_button.toggleClass 'disabled', not (@current_squad.dirty and @total_points > 0)\r\n        @backend_save_list_as_button.toggleClass 'disabled', @total_points == 0\r\n        @backend_delete_list_button.toggleClass 'disabled', not @current_squad.id?\r\n        if @ships.length > 1\r\n            $('meta[property=\"og:description\"]').attr(\"content\", @uitranslation(\"X-Wing Squadron by YASB: \") + @current_squad.name + \": \" + @describeSquad())\r\n        else\r\n            $('meta[property=\"og:description\"]').attr(\"content\", @uitranslation(\"YASB advertisment\"))\r\n        \r\n\r\n\r\n    onSquadNameChanged: () =>\r\n        if @current_squad.name.length > SQUAD_DISPLAY_NAME_MAX_LENGTH\r\n            short_name = \"#{@current_squad.name.substr(0, SQUAD_DISPLAY_NAME_MAX_LENGTH)}&hellip;\"\r\n        else\r\n            short_name = @current_squad.name\r\n        @squad_name_placeholder.text ''\r\n        @squad_name_placeholder.append short_name\r\n        @squad_name_input.val @current_squad.name\r\n        return unless $.getParameterByName('f') == @faction\r\n        if @current_squad.name != @uitranslation(\"Unnamed Squadron\") and @current_squad.name != @uitranslation(\"Unsaved Squadron\")\r\n            if (document.title != \"YASB - \" + @current_squad.name) \r\n                document.title = \"YASB - \" + @current_squad.name\r\n        else\r\n            document.title = \"YASB\"\r\n        @updatePrintAndExportTexts()\r\n\r\n\r\n    updatePrintAndExportTexts: () =>\r\n        # update text list\r\n        @fancy_container.text ''\r\n        @simple_container.html '<table class=\"simple-table\"></table>'\r\n        simplecopy_ships = []\r\n        reddit_ships = []\r\n        tts_ships = []\r\n        for ship in @ships\r\n            if ship.pilot?\r\n                @fancy_container.append ship.toHTML()\r\n                \r\n                #for dial in @fancy_container.find('.fancy-dial')\r\n                    #dial.hidden = true\r\n\r\n                @simple_container.find('table').append ship.toTableRow()\r\n                simplecopy_ships.push ship.toSimpleCopy()\r\n                reddit_ships.push ship.toRedditText()\r\n                tts_ships.push ship.toTTSText()\r\n\r\n        @reddit_container.find('textarea').val $.trim \"\"\"#{reddit_ships.join \"    \\n\"}    \\n**#{@uitranslation('Total')}:** *#{@total_points}*    \\n    \\n[#{@uitranslation('View in YASB')}](#{@getPermaLink()})\"\"\"\r\n        @simplecopy_container.find('textarea').val $.trim \"\"\"#{simplecopy_ships.join \"\"}    \\n#{@uitranslation('Total')}: #{@total_points}    \\n    \\n#{@uitranslation('View in YASB')}: #{@getPermaLink()}\"\"\"\r\n        \r\n\r\n        #Additional code to add obstacles to TTS\r\n        obstacles = @getObstacles()\r\n        if (obstacles? and obstacles.length > 0) and (tts_ships.length > 0)\r\n            tts_ships[tts_ships.length - 1] = tts_ships[tts_ships.length - 1].slice(0, -2)\r\n            tts_obstacles = ' |'\r\n            for obstacle in obstacles\r\n                if obstacle?\r\n                    tts_obstacles +=  \"\"\" #{obstacle} /\"\"\"\r\n            tts_obstacles = tts_obstacles.slice(0, -1)\r\n            tts_ships.push tts_obstacles\r\n\r\n        @tts_textarea.val $.trim \"\"\"#{tts_ships.join \"\"}\"\"\"\r\n\r\n        @xws_textarea.val $.trim JSON.stringify(@toXWS())\r\n        $('#xws-qrcode-container').text ''\r\n        $('#xws-qrcode-container').qrcode\r\n            render: 'canvas'\r\n            text: JSON.stringify(@toMinimalXWS())\r\n            ec: 'L'\r\n            size: 128\r\n        \r\n\r\n    removeAllShips: ->\r\n        while @ships.length > 0\r\n            @removeShip @ships[0]\r\n        throw new Error(@uitranslation(\"Ships not emptied\")) if @ships.length > 0\r\n\r\n    showTextListModal: ->\r\n        # Display print/text view modal\r\n        @list_modal.modal 'show'\r\n\r\n    showXWSModal: (xws) ->\r\n        # Display xws view modal\r\n        @select_xws_view()\r\n        @showTextListModal()\r\n\r\n    showChooseObstaclesModal: ->\r\n        @obstacles_select.select2('val', @current_squad.additional_data.obstacles)\r\n        @choose_obstacles_modal.modal 'show'\r\n\r\n    showObstaclesSelectInfo: ->\r\n        obstacle_array = @obstacles_select.val().split(\",\")\r\n        if obstacle_array != []\r\n            newtext = \"\"\r\n            for obstacle in obstacle_array\r\n                sources = exportObj.obstacles[obstacle]?.sources ? []\r\n                newtext += \"<u>#{obstacle}</u>: #{(if (sources.length > 1) or (not (exportObj.translate('sources', 'Loose Ships') in sources)) then (if sources.length > 0 then sources.join(', ') else exportObj.translate('ui', 'unreleased')) else @uitranslation(\"Only available from 1st edition\"))}</br>\"\r\n            @obstacles_select_sources.html $.trim newtext\r\n        else\r\n            @obstacles_select_sources.html ''\r\n\r\n    updateObstacleSelect: (obstacles) ->\r\n        @current_obstacles = obstacles ? []\r\n        @obstacles_select.select2('val', obstacles)\r\n        @showObstaclesSelectInfo()\r\n\r\n    serialize: ->\r\n        serialization_version = 10\r\n        game_type_abbrev = switch @game_type_selector.val()\r\n            when 'xwa'\r\n                's'\r\n            when 'hyperspace'\r\n                'h'\r\n            when 'beta'\r\n                'b'\r\n            when 'epic'\r\n                'e'\r\n            when 'quickbuild'\r\n                'q'\r\n        selected_points = $.trim @desired_points_input.val()\r\n        \"\"\"v#{serialization_version}Z#{game_type_abbrev}Z#{selected_points}Z#{( ship.toSerialized() for ship in @ships when ship.pilot? and (not @isQuickbuild or ship.primary) ).join 'Y'}\"\"\"\r\n\r\n    changeGameTypeOnSquadLoad: (gametype) ->\r\n        if @game_type_selector.val() != gametype\r\n            $(window).trigger 'xwing:gameTypeChanged', gametype\r\n\r\n\r\n    loadFromSerialized: (serialized, cb=$.noop) ->\r\n        @suppress_automatic_new_ship = true\r\n        # Clear all existing ships\r\n        @removeAllShips()\r\n\r\n        re = if \"Z\" in serialized then /^v(\\d+)Z(.*)/ else /^v(\\d+)!(.*)/\r\n        matches = re.exec serialized\r\n        if matches?\r\n            # versioned\r\n            version = parseInt matches[1]\r\n            # v9: X-Wing 2.5 points rework. Due to the massive change in points structure, previous versions will no longer be supported\r\n            ship_splitter = if version > 7 then 'Y' else ';'\r\n            # parse out game type\r\n            [ game_type_abbrev, desired_points, serialized_ships ] =\r\n                if version > 7\r\n                     [g, p, s] = matches[2].split('Z')\r\n                     [g, parseInt(p), s]\r\n                else\r\n                    [ game_type_and_point_abbrev, s ] = matches[2].split('!')\r\n                    if parseInt(game_type_and_point_abbrev.split('=')[1])\r\n                        p = parseInt(game_type_and_point_abbrev.split('=')[1])\r\n                    else\r\n                        p = 20\r\n                    g = game_type_and_point_abbrev.split('=')[0]\r\n                    [ g, p, s ]\r\n\r\n            if version < 8 # old version are no longer supported\r\n                @old_version_container.toggleClass 'd-none', false\r\n                @suppress_automatic_new_ship = false\r\n                @addShip()\r\n                return\r\n            if !serialized_ships? # something went wrong, we can't load that serialization\r\n                @loading_failed_container.toggleClass 'd-none', false\r\n                @suppress_automatic_new_ship = false\r\n                @addShip()\r\n                return\r\n            if version == 9 # These may load but we will put the warning up just in case.\r\n                @old_version_container.toggleClass 'd-none', false\r\n            @isCurrentlyLoadingSquad = true\r\n            switch game_type_abbrev\r\n                when 's'\r\n                    @changeGameTypeOnSquadLoad 'xwa'\r\n                when 'h'\r\n                    @changeGameTypeOnSquadLoad 'hyperspace'\r\n                when 'b'\r\n                    @changeGameTypeOnSquadLoad 'beta'\r\n                when 'e'\r\n                    @changeGameTypeOnSquadLoad 'epic'\r\n                when 'q'\r\n                    @changeGameTypeOnSquadLoad 'quickbuild'\r\n            @desired_points_input.val desired_points\r\n            @desired_points_input.change()\r\n            ships_with_unmet_dependencies = []\r\n            if serialized_ships.length?\r\n                for serialized_ship in serialized_ships.split(ship_splitter)\r\n                    unless serialized_ship == ''\r\n                        new_ship = @addShip()\r\n                        # try to create ship. fromSerialized returns false, if some upgrade have been skipped as they are not legal until now (e.g. 0-0-0 but vader is not yet in the squad)\r\n                        # if not the entire ship is valid, we'll try again later - but keep the valid part added, so other ships may already see some upgrades\r\n                        if (not await new_ship.fromSerialized version, serialized_ship) or not new_ship.pilot # also check, if the pilot has been set (the pilot himself was not invalid)\r\n                            ships_with_unmet_dependencies.push [new_ship, serialized_ship]\r\n                for ship in ships_with_unmet_dependencies\r\n                    # 2nd attempt to load ships with unmet dependencies.\r\n                    if not ship[0].pilot\r\n                        # create ship, if the ship was so invalid, that it in fact decided to not exist\r\n                        ship[0] = @addShip()\r\n                    ship[0].fromSerialized version, ship[1]\r\n            @isCurrentlyLoadingSquad = false\r\n\r\n        @suppress_automatic_new_ship = false\r\n        # Finally, the unassigned ship\r\n        @addShip()\r\n        \r\n        @container.trigger 'xwing:pointsUpdated'\r\n        cb()\r\n\r\n\r\n    select_xws_view: () ->\r\n        @select_xws_view_button.blur()\r\n        unless @list_display_mode == 'xws'\r\n            @list_modal.find('.list-display-mode .btn').removeClass 'btn-inverse'\r\n            @select_xws_view_button.addClass 'btn-inverse'\r\n            @list_display_mode = 'xws'\r\n            @xws_container.show()\r\n            @simple_container.hide()\r\n            @simplecopy_container.hide()\r\n            @reddit_container.hide()\r\n            @fancy_container.hide()\r\n            @tts_container.hide()\r\n            @xws_textarea.select()\r\n            @xws_textarea.focus()\r\n            @toggle_vertical_space_container.hide()\r\n            @toggle_color_print_container.hide()\r\n            @toggle_color_skip_text.hide()\r\n            @toggle_maneuver_dial_container.hide()\r\n            @toggle_expanded_shield_hull_container.hide()\r\n            @toggle_qrcode_container.hide()\r\n            @toggle_obstacle_container.hide()\r\n            @btn_print_list.disabled = true;\r\n\r\n\r\n    uniqueIndex: (unique, type) ->\r\n        if type not of @uniques_in_use\r\n            throw new Error(\"Invalid unique type '#{type}'\")\r\n        @uniques_in_use[type].indexOf unique\r\n\r\n    claimUnique: (unique, type, cb) =>\r\n        if @uniqueIndex(unique, type) < 0\r\n            # Claim pilots with the same canonical name\r\n            for other in (exportObj.pilotsByUniqueName[unique.canonical_name.getXWSBaseName()] or [])\r\n                if unique != other\r\n                    if @uniqueIndex(other, 'Pilot') < 0\r\n                        # console.log \"Also claiming unique pilot #{other.canonical_name} in use\"\r\n                        @uniques_in_use['Pilot'].push other\r\n                    else\r\n                        throw new Error(\"Unique #{type} '#{unique.name}' already claimed as pilot\")\r\n\r\n            for other in (exportObj.upgradesByUniqueName[unique.canonical_name.getXWSBaseName()] or [])\r\n                if @uniqueIndex(other, 'Upgrade') < 0\r\n                    # console.log \"Also claiming unique pilot #{other.canonical_name} in use\"\r\n                    @uniques_in_use['Upgrade'].push other\r\n                else\r\n                    throw new Error(\"Unique #{type} '#{other.name}' already claimed as pilot\")\r\n\r\n            # Solitary Check\r\n            if unique.solitary?\r\n                @uniques_in_use['Slot'].push unique.slot\r\n\r\n            @uniques_in_use[type].push unique\r\n        else\r\n            throw new Error(\"Unique #{type} '#{unique.name}' already claimed\")\r\n        cb()\r\n\r\n    releaseUnique: (unique, type, cb) =>\r\n        idx = @uniqueIndex(unique, type)\r\n        if idx >= 0\r\n            # Release all uniques with the same canonical name and base name\r\n            for type, uniques of @uniques_in_use\r\n                # Removing stuff in a loop sucks, so we'll construct a new list\r\n                if type == 'Slot'\r\n                    if unique.solitary?\r\n                        @uniques_in_use[type] = []\r\n                        for u in uniques\r\n                            if u != unique.slot\r\n                                # Keep this one\r\n                                @uniques_in_use[type].push u.slot\r\n                else\r\n                    @uniques_in_use[type] = []\r\n                    for u in uniques\r\n                        if u.canonical_name.getXWSBaseName() != unique.canonical_name.getXWSBaseName()\r\n                            # Keep this one\r\n                            @uniques_in_use[type].push u\r\n                        # else\r\n                        #     console.log \"Releasing #{u.name} (#{type}) with canonical name #{unique.canonical_name}\"\r\n        else\r\n            throw new Error(\"Unique #{type} '#{unique.name}' not in use\")\r\n        cb()\r\n\r\n    addShip: ->\r\n        new_ship = new Ship\r\n            builder: this\r\n            container: @ship_container\r\n        @ships.push new_ship\r\n        @ship_number_invalid_container.toggleClass 'd-none', (@ships.length < 10 and @ships.length > 3) # bounds are 2..10 as we always have a \"empty\" ship at the bottom\r\n        @multi_faction_warning_container.toggleClass 'd-none', (@faction != \"All\")\r\n        new_ship\r\n\r\n    removeShip: (ship, cb=$.noop) ->\r\n        if ship?.destroy?\r\n            await new Promise((resolve,reject) => ship.destroy resolve)\r\n            await new Promise((resolve,reject) => @container.trigger 'xwing:pointsUpdated', resolve)\r\n            @current_squad.dirty = true\r\n            @container.trigger 'xwing-backend:squadDirtinessChanged'\r\n            @ship_number_invalid_container.toggleClass 'd-none', (@ships.length < 10 and @ships.length > 3)\r\n            @multi_faction_warning_container.toggleClass 'd-none', (@faction != \"All\")\r\n        cb()\r\n    \r\n    matcher: (item, term) ->\r\n        item.toUpperCase().indexOf(term.toUpperCase()) >= 0\r\n\r\n    isOurFaction: (faction, alt_faction = '') ->\r\n        check_faction = @faction\r\n        if @faction == \"All\"\r\n            if alt_faction != ''\r\n                check_faction = alt_faction\r\n            else\r\n                return true\r\n        if faction instanceof Array\r\n            for f in faction\r\n                if getPrimaryFaction(f) == check_faction\r\n                    return true\r\n            false\r\n        else\r\n            getPrimaryFaction(faction) == check_faction\r\n\r\n    isItemAvailable: (item_data, shipCheck=false) ->\r\n        # this method is not even invoked by most quickbuild stuff to check availability for quickbuild squads, as the method was formerly just telling apart normal play\r\n        if @isQuickbuild\r\n            return true\r\n        else if @isStandard\r\n            return exportObj.standardCheck(item_data, @faction, shipCheck)\r\n        else if (not @isEpic)\r\n            if exportObj.settings?.ban_list? and exportObj.settings.ban_list\r\n                if not exportObj.standardCheck(item_data, @faction, shipCheck, true) then return false\r\n            return exportObj.epicExclusions(item_data)\r\n        else\r\n            if exportObj.settings?.ban_list? and exportObj.settings.ban_list\r\n                if not exportObj.standardCheck(item_data, @faction, shipCheck, true) then return false\r\n            return true\r\n\r\n    getAvailableShipsMatching: (term='',sorted = true, collection_only = false) ->\r\n        ships = []\r\n        for ship_name, ship_data of exportObj.ships\r\n            if @isOurFaction(ship_data.factions) and (@matcher(ship_data.name, term) or (ship_data.display_name and @matcher(ship_data.display_name, term)))\r\n                if (@isItemAvailable(ship_data, true))\r\n                    if (not collection_only or (@collection? and (@collection.checks.collectioncheck == \"true\") and @collection.checkShelf('ship', ship_data.name)))\r\n                        ships.push\r\n                            id: ship_data.name\r\n                            text: if ship_data.display_name then ship_data.display_name else ship_data.name\r\n                            chassis: ship_data.chassis\r\n                            name: ship_data.name\r\n                            display_name: ship_data.display_name\r\n                            canonical_name: ship_data.canonical_name\r\n                            xws: ship_data.name.canonicalize()\r\n                            icon: if ship_data.icon then ship_data.icon else ship_data.name.canonicalize()\r\n        if sorted\r\n            ships.sort exportObj.sortHelper\r\n        return ships\r\n\r\n    getAvailableShipsMatchingAndCheapEnough: (points, term='', sorted=false, collection_only = false) ->\r\n        # returns a list of ships that have at least one pilot cheaper than the given points value\r\n        possible_ships = @getAvailableShipsMatching(term, sorted, collection_only)\r\n        cheap_ships = []\r\n        for ship in possible_ships\r\n            pilots = @getAvailablePilotsForShipIncluding(ship.name, null, '', true)\r\n            if pilots.length and pilots[0].points <= points\r\n                cheap_ships.push(ship)\r\n                \r\n        return cheap_ships\r\n        \r\n    getAvailablePilotsForShipIncluding: (ship, include_pilot, term='', sorted = true, ship_selector = null) ->\r\n        # Returns data formatted for Select2\r\n        retval = []\r\n        if not @isQuickbuild\r\n            # select available pilots according to ususal pilot selection\r\n            available_faction_pilots = (pilot for pilot_name, pilot of exportObj.pilots when (not ship? or pilot.ship == ship) and @isOurFaction(pilot.faction) and (@matcher(pilot_name, term) or (pilot.display_name and @matcher(pilot.display_name, term)) ) and (@isItemAvailable(pilot, true)))\r\n\r\n            # eligible_faction_pilots = (pilot for pilot_name, pilot of available_faction_pilots when (not pilot.unique? or pilot not in @uniques_in_use['Pilot'] or pilot.canonical_name.getXWSBaseName() == include_pilot?.canonical_name.getXWSBaseName()) and (not pilot.max_per_squad? or @countPilots(pilot.canonical_name) < pilot.max_per_squad or pilot.canonical_name.getXWSBaseName() == include_pilot?.canonical_name.getXWSBaseName()) and (not pilot.restricted? or @countPilots(pilot.canonical_name) < pilot.restricted or pilot.canonical_name.getXWSBaseName() == include_pilot?.canonical_name.getXWSBaseName()) and (not pilot.upgrades? or @standard_restriction_check(pilot, include_pilot)) and (not pilot.restriction_func? or pilot.restriction_func((builder: @) , pilot)))\r\n\r\n            eligible_faction_pilots = \r\n            (pilot for pilot_name, pilot of available_faction_pilots when ((pilot?.canonical_name?.getXWSBaseName() == include_pilot?.canonical_name?.getXWSBaseName()) or ((not pilot.unique? or pilot not in @uniques_in_use['Pilot']) and not @isCardOverLimit(pilot,true) and (not pilot.upgrades? or @standard_restriction_check(pilot, include_pilot)) and (not pilot.restriction_func? or pilot.restriction_func((builder: @) , pilot)))))\r\n\r\n            # Re-add selected pilot\r\n            if include_pilot? and include_pilot.unique? and (@matcher(include_pilot.name, term) or (include_pilot.display_name and @matcher(include_pilot.display_name, term)) )\r\n                eligible_faction_pilots.push include_pilot\r\n\r\n            retval = ({ id: pilot.id, text: \"#{if exportObj.settings?.initiative_prefix? and exportObj.settings.initiative_prefix then pilot.skill + ' - ' else ''}#{if pilot.display_name then pilot.display_name else pilot.name} (#{if (@isBeta and pilot.pointsbeta?) then pilot.pointsbeta else pilot.points}#{if pilot.loadout? then (if (@isBeta and pilot.loadoutbeta?) then \"/#{pilot.loadoutbeta}\" else \"/#{pilot.loadout}\") else \"\"})\", points: (if (@isBeta and pilot.pointsbeta?) then pilot.pointsbeta else pilot.points), ship: pilot.ship, name: pilot.name, display_name: pilot.display_name, disabled: pilot not in eligible_faction_pilots } for pilot in available_faction_pilots)\r\n        else\r\n            # select according to quickbuild cards\r\n            # filter for faction and ship\r\n            quickbuilds_matching_ship_and_faction = (quickbuild for id, quickbuild of exportObj.quickbuildsById when (not ship? or quickbuild.ship == ship) and @isOurFaction(quickbuild.faction) and (@matcher(quickbuild.pilot, term) or (exportObj.pilots[quickbuild.pilot].display_name? and @matcher(exportObj.pilots[quickbuild.pilot].display_name, term)) ))\r\n\r\n            # create a list of the uniques belonging to the currently selected pilot\r\n            uniques_in_use_by_pilot_in_use = []\r\n            if include_pilot? and include_pilot != -1\r\n                include_quickbuild = exportObj.quickbuildsById[include_pilot]\r\n                include_pilot_pilot = exportObj.pilots[include_quickbuild.pilot]\r\n                if include_pilot_pilot.unique?\r\n                    uniques_in_use_by_pilot_in_use.push include_pilot_pilot\r\n                    for other in (exportObj.pilotsByUniqueName[include_pilot_pilot.canonical_name.getXWSBaseName()] or [])\r\n                        if other?\r\n                            uniques_in_use_by_pilot_in_use.push other\r\n                for include_upgrade_name in include_quickbuild.upgrades ? []\r\n                    include_upgrade = exportObj.upgrades[include_upgrade_name]\r\n                    if include_upgrade.unique? \r\n                        uniques_in_use_by_pilot_in_use.push other\r\n                        for other in (exportObj.pilotsByUniqueName[include_upgrade.canonical_name.getXWSBaseName()] or [])\r\n                            if other? \r\n                                uniques_in_use_by_pilot_in_use.push other\r\n                    if include_upgrade.solitary?\r\n                        uniques_in_use_by_pilot_in_use.push include_upgrade.slot\r\n                # we should also add upgrades with the same unique name like some selected upgrades or the pilot. However, finding them is teadious\r\n                # we should also add uniques used by a linked ship. however, while it is easy to allow selecting them, it is harder to properly add them - as one need to make sure the order of selecting ship + linked ship matters\r\n\r\n            # filter for uniques in use\r\n            allowed_quickbuilds_containing_uniques_in_use = []\r\n            loop: for id, quickbuild of quickbuilds_matching_ship_and_faction\r\n                if exportObj.pilots[quickbuild.pilot]?.unique? and exportObj.pilots[quickbuild.pilot] in @uniques_in_use.Pilot and not (exportObj.pilots[quickbuild.pilot] in uniques_in_use_by_pilot_in_use)\r\n                    allowed_quickbuilds_containing_uniques_in_use.push quickbuild.id\r\n                    continue\r\n                if exportObj.pilots[quickbuild.pilot]?.max_per_squad? and @countPilots(exportObj.pilots[quickbuild.pilot].canonical_name) >= exportObj.pilots[quickbuild.pilot].max_per_squad and not (exportObj.pilots[quickbuild.pilot] in uniques_in_use_by_pilot_in_use)\r\n                    allowed_quickbuilds_containing_uniques_in_use.push quickbuild.id\r\n                    continue\r\n                if quickbuild.upgrades? \r\n                    for upgrade in quickbuild.upgrades\r\n                        upgradedata = exportObj.upgrades[upgrade]\r\n                        if not upgradedata?\r\n                            console.log(\"There was an Issue including the upgrade \" + upgrade + \" in some quickbuild. Please report that Issue!\")\r\n                            continue\r\n                        if upgradedata.unique? and upgradedata in @uniques_in_use.Upgrade and not (upgradedata in uniques_in_use_by_pilot_in_use)\r\n                            # check, if unique is used by this ship or it's linked ship\r\n                            if ship_selector == null or not (upgrade in exportObj.quickbuildsById[ship_selector.quickbuildId].upgrades or (ship_selector.linkedShip and upgrade in (exportObj.quickbuildsById[ship_selector.linkedShip?.quickbuildId].upgrades ? [])))\r\n                                allowed_quickbuilds_containing_uniques_in_use.push quickbuild.id\r\n                                break\r\n                        # check if solitary type is already claimed\r\n                        if upgradedata.solitary? and upgradedata.slot in @uniques_in_use['Slot'] and not (upgradedata.slot in uniques_in_use_by_pilot_in_use)\r\n                            allowed_quickbuilds_containing_uniques_in_use.push quickbuild.id\r\n                            break\r\n            \r\n            retval = ({id: quickbuild.id, text: \"#{if exportObj.settings?.initiative_prefix? and exportObj.settings.initiative_prefix then exportObj.pilots[quickbuild.pilot].skill + ' - ' else ''}#{if exportObj.pilots[quickbuild.pilot].display_name then exportObj.pilots[quickbuild.pilot].display_name else quickbuild.pilot}#{quickbuild.suffix} (#{quickbuild.threat})\", points: quickbuild.threat, ship: quickbuild.ship, disabled: quickbuild.id in allowed_quickbuilds_containing_uniques_in_use} for quickbuild in quickbuilds_matching_ship_and_faction)\r\n\r\n        if sorted\r\n            retval = retval.sort exportObj.sortHelper\r\n        retval\r\n\r\n\r\n    standard_restriction_check: (pilot, set_pilot) ->\r\n        if pilot.upgrades?\r\n            for upgrade in pilot.upgrades\r\n                upgrade_data = exportObj.upgrades[upgrade]\r\n                if upgrade_data.unique?\r\n                    for ship in @ships\r\n                        if not (ship.pilot?.name? and set_pilot?.name? and ship.pilot.name == set_pilot.name)\r\n                            for shipupgrade in ship.upgrades\r\n                                if shipupgrade?.data?.canonical_name == upgrade_data.canonical_name\r\n                                    return false\r\n        return true\r\n\r\n    dfl_filter_func = ->\r\n        true\r\n\r\n    countUpgrades: (canonical_name) ->\r\n        # returns number of upgrades with given canonical name equipped\r\n        count = 0\r\n        for ship in @ships\r\n            if not ship.pilot?.upgrades?\r\n                for upgrade in ship.upgrades\r\n                    if upgrade?.data?.canonical_name == canonical_name\r\n                        count++\r\n        count\r\n\r\n    countPilots: (canonical_name) ->\r\n        # returns number of pilots with given canonical name\r\n        count = 0\r\n        for ship in @ships\r\n            if ship?.pilot?.canonical_name.getXWSBaseName() == canonical_name?.getXWSBaseName()\r\n                count++\r\n        count\r\n\r\n    isShip: (ship, name) ->\r\n        # console.log \"returning #{f} #{name}\"\r\n        if ship instanceof Array\r\n            for f in ship\r\n                if f == name\r\n                    return true\r\n            false\r\n        else\r\n            ship == name\r\n\r\n    isCardOverLimit: (card,isPilot) ->\r\n        cardLimit = 0\r\n        if card.unique?\r\n            cardLimit = 1\r\n        else if card.restricted?\r\n            cardLimit = card.restricted\r\n        else if card.max_per_squad?\r\n            cardLimit = card.max_per_squad\r\n\r\n        if isPilot \r\n            count = @countPilots(card.canonical_name) \r\n        else \r\n            count = @countUpgrades(card.canonical_name)\r\n\r\n        if (cardLimit !=0) and (count >= cardLimit)\r\n            return true\r\n        return false\r\n\r\n    getAvailableUpgradesIncluding: (slot, include_upgrade, ship, this_upgrade_obj, term='', filter_func=@dfl_filter_func, sorted=true) ->\r\n        # Returns data formatted for Select2\r\n        upgrades_in_use = (upgrade.data for upgrade in ship.upgrades)\r\n\r\n        available_upgrades = (upgrade for upgrade_name, upgrade of exportObj.upgrades when exportObj.slotsMatching(upgrade.slot, slot) and ( @matcher(upgrade_name, term) or (upgrade.display_name and @matcher(upgrade.display_name, term)) ) and (not upgrade.ship? or @isShip(upgrade.ship, ship.data.name)) and (not upgrade.faction? or @isOurFaction(upgrade.faction, ship.pilot.faction)) and (@isItemAvailable(upgrade)) and (not upgrade.standard?))\r\n\r\n        # available_upgrades = (upgrade for upgrade_name, upgrade of exportObj.upgrades when exportObj.slotsMatching(upgrade.slot, slot) and ( @matcher(upgrade_name, term) or (upgrade.display_name and @matcher(upgrade.display_name, term)) ) and (not upgrade.ship? or @isShip(upgrade.ship, ship.data.name)) and (not upgrade.faction? or ((@faction != \"All\") and @isOurFaction(upgrade.faction)) or ((@faction == \"All\") and (not ship.pilot? or (ship.pilot.faction == upgrade.faction)))) and (@isItemAvailable(upgrade)))\r\n\r\n        if filter_func != @dfl_filter_func\r\n            available_upgrades = (upgrade for upgrade in available_upgrades when filter_func(upgrade))\r\n\r\n        points_without_include_upgrade = ship.upgrade_points_total - this_upgrade_obj.getPoints(include_upgrade)\r\n\r\n        eligible_upgrades = (upgrade for upgrade_name, upgrade of available_upgrades when (upgrade not in @uniques_in_use['Upgrade']) and ship.standardized_check(upgrade) and ship.restriction_check((if (ship.builder.isXwa and upgrade.restrictionsxwa?) then upgrade.restrictionsxwa else (if upgrade.restrictions then upgrade.restrictions else undefined)),this_upgrade_obj, this_upgrade_obj.getPoints(upgrade), points_without_include_upgrade, upgrade) and upgrade not in upgrades_in_use and (not @isCardOverLimit(upgrade,false)) and (not upgrade.solitary? or (upgrade.slot not in @uniques_in_use['Slot'] or include_upgrade?.solitary?)))\r\n\r\n        for equipped_upgrade in (upgrade.data for upgrade in ship.upgrades when upgrade?.data?)\r\n            eligible_upgrades.removeItem equipped_upgrade\r\n\r\n        # Re-enable selected upgrade\r\n        if include_upgrade? and ((( @matcher(include_upgrade.name, term) or (include_upgrade.display_name and @matcher(include_upgrade.display_name, term)))))\r\n            eligible_upgrades.push include_upgrade\r\n\r\n        retval = ({ id: upgrade.id, text: \"#{if upgrade.display_name then upgrade.display_name else upgrade.name} (#{this_upgrade_obj.getPoints(upgrade)}#{if upgrade.variablepoints then '*' else ''})\", points: this_upgrade_obj.getPoints(upgrade), name: upgrade.name, display_name: upgrade.display_name, disabled: upgrade not in eligible_upgrades } for upgrade in available_upgrades)\r\n        if sorted\r\n            retval = retval.sort exportObj.sortHelper\r\n\r\n        # Possibly adjust the upgrade\r\n        if this_upgrade_obj?adjustment_func?\r\n            (this_upgrade_obj.adjustment_func(upgrade) for upgrade in retval)\r\n        else\r\n            retval\r\n\r\n    getSquadDialsAsHTML: () ->\r\n        dialHTML = \"\"\r\n        added_dials = {}\r\n        for ship in @ships\r\n            if ship.pilot? # There is always one \"empty\" ship at the bottom of each squad, that we want to skip. \r\n                maneuvers_unmodified = ship.data.maneuvers\r\n                maneuvers_modified = ship.effectiveStats().maneuvers\r\n                if not added_dials[ship.data.name]? or not (maneuvers_modified.toString() in added_dials[ship.data.name]) # we only want to add each dial once per ship (if two ships share a dial, add two copies of the dial)\r\n                    added_dials[ship.data.name] = (added_dials[ship.data.name] ? []).concat [maneuvers_modified.toString()] # save maneuver as string, as that is easier to compare than arrays (if e.g. two ships of same type, one with and one without R4 are in a squad, we add 2 dials)\r\n                    dialHTML += '<div class=\"fancy-dial\">' + \r\n                                \"\"\"<h4 class=\"ship-name-dial\">#{if ship.data.display_name? then ship.data.display_name else ship.data.name}\"\"\" +\r\n                                \"\"\"#{if maneuvers_modified.toString() != maneuvers_unmodified.toString() then \" (\" + @uitranslation(\"modified\") + \")\" else \"\"}</h4>\"\"\" +\r\n                                @getManeuverTableHTML(maneuvers_modified, maneuvers_unmodified) + '</div>'\r\n\r\n        return \"\"\"\r\n                    <div class=\"print-dials-container\">\r\n                        #{dialHTML}\r\n                    </div>\r\n                \"\"\"\r\n                # dialHTML = @builder.getManeuverTableHTML(effective_stats.maneuvers, @data.maneuvers)\r\n\r\n\r\n    # Converts a maneuver table for into an HTML table.\r\n    getManeuverTableHTML: (maneuvers, baseManeuvers) ->\r\n        if not maneuvers? or maneuvers.length == 0\r\n            return @uitranslation(\"Missing maneuver info.\")\r\n\r\n        # Preprocess maneuvers to see which bearings are never used so we\r\n        # don't render them.\r\n        bearings_without_maneuvers = [0...maneuvers[0].length]\r\n        for bearings in maneuvers\r\n            for difficulty, bearing in bearings\r\n                if difficulty > 0\r\n                    bearings_without_maneuvers.removeItem bearing\r\n        # console.log \"bearings without maneuvers:\"\r\n        # console.dir bearings_without_maneuvers\r\n\r\n        outTable = \"<table><tbody>\"\r\n\r\n        for speed in [maneuvers.length - 1 .. 0]\r\n\r\n            haveManeuver = false\r\n            for v in maneuvers[speed]\r\n                if v > 0\r\n                    haveManeuver = true\r\n                    break\r\n\r\n            continue if not haveManeuver\r\n\r\n            outTable += \"<tr><td>#{speed}</td>\"\r\n            for turn in [0 ... maneuvers[speed].length]\r\n                continue if turn in bearings_without_maneuvers\r\n\r\n                outTable += \"<td>\"\r\n                if maneuvers[speed][turn] > 0\r\n\r\n                    color = switch maneuvers[speed][turn]\r\n                        when 1 then \"dodgerblue\"\r\n                        when 2 then \"white\"\r\n                        when 3 then \"red\"\r\n                        when 4 then \"purple\"\r\n\r\n                     # we need this to change the color to b/w in case we want to print b/w\r\n\r\n                    maneuverClass = switch maneuvers[speed][turn]\r\n                        when 1 then \"svg-blue-maneuver\"\r\n                        when 2 then \"svg-white-maneuver\"\r\n                        when 3 then \"svg-red-maneuver\"\r\n                        when 4 then \"svg-purple-maneuver\"\r\n\r\n                    outTable += \"\"\"<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"30px\" height=\"30px\" viewBox=\"0 0 200 200\">\"\"\"\r\n\r\n                    outlineColor = \"black\"\r\n                    maneuverClass2 = \"svg-base-maneuver\"\r\n                    if maneuvers[speed][turn] != baseManeuvers[speed][turn]\r\n                        outlineColor = \"DarkSlateGrey\" # highlight manuevers modified by another card (e.g. R2 Astromech makes all 1 & 2 speed maneuvers green)\r\n                        maneuverClass2 = \"svg-modified-maneuver\"\r\n\r\n                    if speed == 0 and turn == 2\r\n                        outTable += \"\"\"<rect class=\"svg-maneuver-stop #{maneuverClass} #{maneuverClass2}\" x=\"50\" y=\"50\" width=\"100\" height=\"100\" style=\"fill:#{color}; stroke-width:5; stroke:#{outlineColor}\" />\"\"\"\r\n                    else\r\n                        transform = \"\"\r\n                        className = \"\"\r\n                        switch turn\r\n                            when 0\r\n                                # turn left\r\n                                linePath = \"M160,180 L160,70 80,70\"\r\n                                innerPath = \"M160,175 L160,70 70,70\"\r\n                                trianglePath = \"M80,100 V40 L30,70 Z\"\r\n                            when 1\r\n                                # bank left\r\n                                linePath = \"M150,180 S150,120 80,60\"\r\n                                innerPath = \"M150,175 S150,120 80,60\"\r\n                                trianglePath = \"M80,100 V40 L30,70 Z\"\r\n                                transform = \"transform='translate(-5 -15) rotate(45 70 90)' \"\r\n                            when 2\r\n                                # straight\r\n                                linePath = \"M100,180 L100,100 100,80\"\r\n                                innerPath = \"M100,175 L100,120 100,70\"\r\n                                trianglePath = \"M70,80 H130 L100,30 Z\"\r\n                            when 3\r\n                                # bank right\r\n                                linePath = \"M50,180 S50,120 120,60\"\r\n                                innerPath = \"M50,175 S50,120 120,60\"\r\n                                trianglePath = \"M120,100 V40 L170,70 Z\"\r\n                                transform = \"transform='translate(5 -15) rotate(-45 130 90)' \"\r\n                            when 4\r\n                                # turn right\r\n                                linePath = \"M40,180 L40,70 120,70\"\r\n                                innerPath = \"M40,175 L40,70 130,70\"\r\n                                trianglePath = \"M120,100 V40 L170,70 Z\"\r\n                            when 5\r\n                                # k-turn/u-turn\r\n                                linePath = \"M50,180 L50,100 C50,10 140,10 140,100 L140,120\"\r\n                                innerPath = \"M50,175 L50,100 C50,10 140,10 140,100 L140,130\"\r\n                                trianglePath = \"M170,120 H110 L140,180 Z\"\r\n                            when 6\r\n                                # segnor's loop left\r\n                                linePath = \"M150,180 S150,120 80,60\"\r\n                                innerPath = \"M150,175 S150,120 85,65\"\r\n                                trianglePath = \"M80,100 V40 L30,70 Z\"\r\n                                transform = \"transform='translate(0 50)'\"\r\n                            when 7\r\n                                # segnor's loop right\r\n                                linePath = \"M50,180 S50,120 120,60\"\r\n                                innerPath = \"M50,175 S50,120 115,65\"\r\n                                trianglePath = \"M120,100 V40 L170,70 Z\"\r\n                                transform = \"transform='translate(0 50)'\"\r\n                            when 8\r\n                                # tallon roll left\r\n                                linePath = \"M160,180 L160,70 80,70\"\r\n                                innerPath = \"M160,175 L160,70 85,70\"\r\n                                trianglePath = \"M60,100 H100 L80,140 Z\"\r\n                            when 9\r\n                                # tallon roll right\r\n                                linePath = \"M40,180 L40,70 120,70\"\r\n                                innerPath = \"M40,175 L40,70 115,70\"\r\n                                trianglePath = \"M100,100 H140 L120,140 Z\"\r\n                            when 10\r\n                                # backward left\r\n                                linePath = \"M50,180 S50,120 120,60\"\r\n                                innerPath = \"M50,175 S50,120 120,60\"\r\n                                trianglePath = \"M120,100 V40 L170,70 Z\"\r\n                                transform = \"transform='translate(5 -15) rotate(-45 130 90)' \"\r\n                                className = 'backwards'\r\n                            when 11\r\n                                # backward straight\r\n                                linePath = \"M100,180 L100,100 100,80\"\r\n                                innerPath = \"M100,175 L100,100 100,70\"\r\n                                trianglePath = \"M70,80 H130 L100,30 Z\"\r\n                                className = 'backwards'\r\n                            when 12\r\n                                # backward right\r\n                                linePath = \"M150,180 S150,120 80,60\"\r\n                                innerPath = \"M150,175 S150,120 80,60\"\r\n                                trianglePath = \"M80,100 V40 L30,70 Z\"\r\n                                transform = \"transform='translate(-5 -15) rotate(45 70 90)' \"\r\n                                className = 'backwards'\r\n\r\n                        outTable += $.trim \"\"\"\r\n                          <g class=\"maneuver #{className}\">\r\n                            <path class = 'svg-maneuver-outer #{maneuverClass} #{maneuverClass2}' stroke-width='25' fill='none' stroke='#{outlineColor}' d='#{linePath}' />\r\n                            <path class = 'svg-maneuver-triangle #{maneuverClass} #{maneuverClass2}' d='#{trianglePath}' fill='#{color}' stroke-width='5' stroke='#{outlineColor}' #{transform}/>\r\n                            <path class = 'svg-maneuver-inner #{maneuverClass} #{maneuverClass2}' stroke-width='15' fill='none' stroke='#{color}' d='#{innerPath}' />\r\n                          </g>\r\n                        \"\"\"\r\n\r\n                    outTable += \"</svg>\"\r\n                outTable += \"</td>\"\r\n            outTable += \"</tr>\"\r\n        outTable += \"</tbody></table>\"\r\n        outTable\r\n\r\n    formatActions: (actions,seperation,keyword=[]) ->\r\n        action_icons = []\r\n        for action in actions\r\n            color = \"\"\r\n            prefix = seperation\r\n            if \"Droid\" in keyword\r\n                action = action.replace('Focus', 'Calculate')\r\n            # Search and filter each type of action by its prefix and then reformat it for html\r\n            if action.search('> ') != -1\r\n                action = action.replace(/> /gi, '')\r\n                prefix = \"\"\" <i class=\"xwing-miniatures-font xwing-miniatures-font-linked\"></i> \"\"\"\r\n            if action.search('F-') != -1 \r\n                color = \"force \"\r\n                action = action.replace(/F-/gi, '')\r\n            if action.search('W-') != -1 \r\n                prefix = \"White \"\r\n                action = action.replace(/W-/gi, '')\r\n            else if action.search('R-') != -1 \r\n                color = \"red \"\r\n                action = action.replace(/R-/gi, '')\r\n            action = action.toLowerCase().replace(/[^0-9a-z]/gi, '')\r\n            action_icons.push \"\"\"#{prefix}<i class=\"xwing-miniatures-font #{color}xwing-miniatures-font-#{action}\"></i>\"\"\"\r\n        actionlist = action_icons.join ''\r\n        return actionlist.replace(seperation,'')\r\n\r\n    listStandardUpgrades: (upgrades) ->\r\n        upgrade_names = ''\r\n        for upgrade in upgrades\r\n            formattedname = upgrade.split \" (\"\r\n            upgrade_names += ', ' + formattedname[0]\r\n        return upgrade_names.substr 2\r\n\r\n    getPilotsMatchingUpgrade: (term='',sorted = true) ->\r\n        pilots = []\r\n        for pilot_name, pilot_data of exportObj.pilots\r\n            if pilot_data.upgrades?\r\n                for upgrade in pilot_data.upgrades\r\n                    if @matcher(upgrade, term)\r\n                        pilots.push\r\n                            id: pilot_data.name\r\n                            name: pilot_data.name\r\n                            display_name: pilot_data.display_name\r\n                            chassis: pilot_data.chassis\r\n                            canonical_name: pilot_data.canonical_name\r\n                            xws: pilot_data.name.canonicalize()\r\n                            icon: if pilot_data.icon then pilot_data.icon else pilot_data.name.canonicalize()\r\n        if sorted\r\n            pilots.sort exportObj.sortHelper\r\n        return pilots\r\n\r\n    showTooltip: (type, data, additional_opts, container = @info_container, force_update = false) ->\r\n        if data != @tooltip_currently_displaying or force_update\r\n            switch type\r\n                when 'Ship'\r\n                    # we get all pilots for the ship, to display stuff like available slots which are treated as pilot properties, not ship properties (which makes sense, as they depend on the pilot, e.g. talent or force slots)\r\n                    possible_inis = []\r\n                    possible_costs = []\r\n                    possible_loadout = []\r\n                    slot_types = {} # one number per slot: 0: not available for that ship. 1: always available for that ship. 2: available for some pilots on that ship. 3: slot two times availabel for that ship 4: slot one or two times available (depending on pilot) 5: slot zero to two times available 6: slot three times available (no mixed-case implemented) -1: undefined\r\n                    for slot of exportObj.upgradesBySlotCanonicalName\r\n                        slot_types[slot] = -1\r\n                    for name, pilot of exportObj.pilots\r\n                        # skip all pilots with wrong ship or faction\r\n                        if pilot.ship != data.name or not @isOurFaction(pilot.faction) \r\n                            continue\r\n                        if not (pilot.skill in possible_inis)\r\n                            possible_inis.push(pilot.skill)\r\n                        if @isBeta and pilot.pointsbeta?\r\n                            possible_costs.push(pilot.pointsbeta)\r\n                        else\r\n                            possible_costs.push(pilot.points)\r\n                        if @isBeta and pilot.loadoutbeta?\r\n                            possible_loadout.push(pilot.loadoutbeta)\r\n                        else\r\n                            if pilot.loadout? then possible_loadout.push(pilot.loadout)\r\n                        if pilot.slots?\r\n                            for slot, state of slot_types\r\n                                switch pilot.slots.filter((item) => item == slot).length\r\n                                    when 1\r\n                                        switch state\r\n                                            when -1\r\n                                                slot_types[slot] = 1\r\n                                            when 0\r\n                                                slot_types[slot] = 2\r\n                                            when 3\r\n                                                slot_types[slot] = 4\r\n                                    when 0\r\n                                        switch state\r\n                                            when -1\r\n                                                slot_types[slot] = 0\r\n                                            when 1\r\n                                                slot_types[slot] = 2\r\n                                            when 3,4\r\n                                                slot_types[slot] = 5\r\n                                    when 2\r\n                                        switch state\r\n                                            when -1\r\n                                                slot_types[slot] = 3\r\n                                            when 0,2\r\n                                                slot_types[slot] = 5\r\n                                            when 1\r\n                                                slot_types[slot] = 4\r\n                                    when 3\r\n                                        slot_types[slot] = 6\r\n                                \r\n                    possible_inis.sort()\r\n        \r\n                    container.find('.info-type').text exportObj.translate(\"types\", type)\r\n                    container.find('.info-name').html \"\"\"#{if data.display_name then data.display_name else data.name}#{if exportObj.isReleased(data) then \"\" else \" (#{@uitranslation('unreleased')})\"}\"\"\"\r\n                    if @collection?.counts?\r\n                        ship_count = @collection.counts?.ship?[data.name] ? 0\r\n                        container.find('.info-collection').text @uitranslation(\"collectionContentShips\", ship_count)\r\n                        container.find('.info-collection').show()\r\n                    else\r\n                        container.find('.info-collection').hide()\r\n                    first = true\r\n                    inis = String(possible_inis[0])\r\n                    for ini in possible_inis\r\n                        if not first\r\n                            inis += \", \" + ini\r\n                        first = false\r\n                    container.find('tr.info-skill td.info-data').text inis\r\n                    container.find('tr.info-skill').toggle(ini != undefined)\r\n\r\n                    # display point range for that ship (and faction) \r\n                    point_range_text = \"#{Math.min possible_costs...} - #{Math.max possible_costs...}\"\r\n                    container.find('tr.info-points td.info-data').text point_range_text\r\n                    loadout_range_text = \"#{Math.min possible_loadout...} - #{Math.max possible_loadout...}\"\r\n                    container.find('tr.info-loadout td.info-data').text loadout_range_text\r\n                    container.find('tr.info-points').toggle(possible_costs.length > 0)\r\n                    container.find('tr.info-loadout').toggle(possible_loadout.length > 0)\r\n                    \r\n                    container.find('tr.info-engagement').hide()\r\n                \r\n                    container.find('tr.info-attack td.info-data').text(data.attack)\r\n                    container.find('tr.info-attack-bullseye td.info-data').text(data.attackbull)\r\n                    container.find('tr.info-attack-fullfront td.info-data').text(data.attackf)\r\n                    container.find('tr.info-attack-left td.info-data').text(data.attackl)\r\n                    container.find('tr.info-attack-right td.info-data').text(data.attackr)\r\n                    container.find('tr.info-attack-back td.info-data').text(data.attackb)\r\n                    container.find('tr.info-attack-turret td.info-data').text(data.attackt)\r\n                    container.find('tr.info-attack-doubleturret td.info-data').text(data.attackdt)\r\n        \r\n                    container.find('tr.info-attack').toggle(data.attack?)\r\n                    container.find('tr.info-attack-bullseye').toggle(data.attackbull?)\r\n                    container.find('tr.info-attack-fullfront').toggle(data.attackf?)\r\n                    container.find('tr.info-attack-left').toggle(data.attackl?)\r\n                    container.find('tr.info-attack-right').toggle(data.attackr?)\r\n                    container.find('tr.info-attack-back').toggle(data.attackb?)\r\n                    container.find('tr.info-attack-turret').toggle(data.attackt?)\r\n                    container.find('tr.info-attack-doubleturret').toggle(data.attackdt?)\r\n                \r\n                    container.find('tr.info-ship').hide()        \r\n                    if data.base?\r\n                        container.find('tr.info-base td.info-data').text exportObj.translate(\"gameterms\", data.base)\r\n                    else\r\n                        container.find('tr.info-base td.info-data').text exportObj.translate(\"gameterms\", \"Small\")\r\n                    container.find('tr.info-base').show()\r\n                    container.find('tr.info-faction td.info-data').text [exportObj.translate(\"faction\", faction) for faction in data.factions]\r\n                    container.find('tr.info-faction').hide() # this information is clear from the context, unless we are in card browser\r\n\r\n                    container.find('p.info-restrictions').hide()\r\n\r\n                    for cls in container.find('tr.info-attack td.info-header i.xwing-miniatures-font')[0].classList\r\n                        container.find('tr.info-attack td.info-header i.xwing-miniatures-font').removeClass(cls) if cls.startsWith('xwing-miniatures-font-attack')\r\n                    container.find('tr.info-attack td.info-header i.xwing-miniatures-font').addClass(data.attack_icon ? 'xwing-miniatures-font-attack')\r\n        \r\n                    container.find('tr.info-range').hide()\r\n                    container.find('tr.info-agility td.info-data').text(data.agility)\r\n                    container.find('tr.info-agility').toggle(data.agility?)\r\n                    container.find('tr.info-hull td.info-data').text(data.hull)\r\n                    container.find('tr.info-hull').toggle(data.hull?)\r\n                    \r\n                    recurringicon = ''\r\n                    if data.shieldrecurr?\r\n                        count = 0\r\n                        while count < data.shieldrecurr\r\n                            recurringicon += '<sup><i class=\"fas fa-caret-up\"></i></sup>'\r\n                            ++count\r\n                    container.find('tr.info-shields td.info-data').html (data.shields + recurringicon)\r\n                    container.find('tr.info-shields').toggle(data.shields?)\r\n\r\n                    recurringicon = ''\r\n                    if data.energyrecurr?\r\n                        count = 0\r\n                        while count < data.energyrecurr\r\n                            recurringicon += '<sup><i class=\"fas fa-caret-up\"></i></sup>'\r\n                            ++count\r\n                    container.find('tr.info-energy td.info-data').html (data.energy + recurringicon)\r\n                    container.find('tr.info-energy').toggle(data.energy?)\r\n                    \r\n                    \r\n                    # One may want to check for force sensitive pilots and display the possible values here (like done for ini), but I'll skip this for now. \r\n                    container.find('tr.info-force').hide() \r\n        \r\n                    container.find('tr.info-charge').hide()\r\n        \r\n                    container.find('tr.info-actions td.info-data').html @formatActions(data.actions, \", \", data.keyword ? [])\r\n                    container.find('tr.info-actions').show()\r\n\r\n                    # Display all available slots, put brackets around slots that are only available for some pilots\r\n                    container.find('tr.info-upgrades').show()\r\n                    container.find('tr.info-upgrades td.info-data').html(((if state == 1 then exportObj.translate('sloticon', slot) else (if state == 2 then '('+exportObj.translate('sloticon', slot)+')' else (if state == 3 then (exportObj.translate('sloticon', slot) + exportObj.translate('sloticon', slot)) else (if state == 4 then (exportObj.translate('sloticon', slot) + '(' + exportObj.translate('sloticon', slot) + ')') else (if state == 5 then ('(' + exportObj.translate('sloticon', slot) + exportObj.translate('sloticon', slot) + ')') else (if state == 6 then (exportObj.translate('sloticon',slot) + exportObj.translate('sloticon',slot) + exportObj.translate('sloticon',slot)))))))) for slot, state of slot_types).join(' ') or 'None')\r\n                \r\n                    container.find('p.info-text').hide()\r\n\r\n                    container.find('p.info-chassis').show()\r\n                    container.find('p.info-chassis').html if data.chassis? then \"<strong>#{exportObj.chassis[data.chassis]?.display_name ? data.chassis}:</strong> #{exportObj.chassis[data.chassis].text}\" else \"\"\r\n\r\n                    container.find('p.info-maneuvers').show()\r\n                    container.find('p.info-maneuvers').html(@getManeuverTableHTML(data.maneuvers, data.maneuvers))\r\n                    \r\n                    sources = (exportObj.translate('sources', source) for source in data.sources).sort()\r\n                    container.find('.info-sources.info-data').text if (sources.length > 1) or (not (exportObj.translate('sources', 'Loose Ships') in sources)) then (if sources.length > 0 then sources.join(', ') else exportObj.translate('ui', 'unreleased')) else @uitranslation(\"Only available from 1st edition\")\r\n                    container.find('.info-sources').show()\r\n                when 'Pilot'\r\n                    container.find('.info-type').text exportObj.translate(\"types\", type)\r\n                    container.find('.info-sources.info-data').text (exportObj.translate('sources', source) for source in data.sources).sort().join(', ')\r\n                    container.find('.info-sources').show()\r\n                    if @collection?.counts?\r\n                        pilot_count = @collection.counts?.pilot?[data.name] ? 0\r\n                        ship_count = @collection.counts.ship?[data.ship] ? 0\r\n                        container.find('.info-collection').text @uitranslation(\"collectionContentShipsAndPilots\", ship_count, pilot_count)\r\n                        container.find('.info-collection').show()\r\n                    else\r\n                        container.find('.info-collection').hide()\r\n                        \r\n                    # if the pilot is already selected and has uprades, some stats may be modified\r\n                    if additional_opts?.effectiveStats?\r\n                        effective_stats = additional_opts.effectiveStats()\r\n                    #logic to determine how many dots to use for uniqueness\r\n                    uniquedots = \"\"\r\n                    if data.unique?\r\n                        uniquedots = \"&middot;&nbsp;\"\r\n                    else if data.max_per_squad?\r\n                        count = 0\r\n                        while (count < data.max_per_squad)\r\n                            uniquedots = uniquedots.concat(\"&middot;\")\r\n                            ++count\r\n                        uniquedots = uniquedots.concat(\"&nbsp;\")\r\n                    else if data.restricted?\r\n                        console.log \"Found restricted tag\"\r\n                        count = 0\r\n                        while (count < data.restricted)\r\n                            uniquedots = uniquedots.concat(\"&#9672;\")\r\n                            ++count\r\n                        uniquedots = uniquedots.concat(\"&nbsp;\")\r\n                        \r\n                    container.find('.info-name').html \"\"\"#{uniquedots}#{if data.display_name then data.display_name else data.name}#{if exportObj.isReleased(data) then \"\" else \" (#{exportObj.translate('ui', 'unreleased')})\"}\"\"\"\r\n\r\n                    restriction_info = @restriction_text(data) + @upgrade_effect(data)\r\n                    if restriction_info != '' and data.ship != \"Conversion\"\r\n                        container.find('p.info-restrictions').html restriction_info\r\n                        container.find('p.info-restrictions').show()\r\n                    else\r\n                        container.find('p.info-restrictions').hide()\r\n\r\n                    container.find('p.info-text').html data.text ? ''\r\n                    container.find('p.info-text').show()\r\n\r\n                    ship = exportObj.ships[data.ship]\r\n\r\n                    if effective_stats?.chassis? and (effective_stats.chassis != \"\")\r\n                        chassis_title = effective_stats.chassis\r\n                    else if data.chassis?\r\n                        chassis_title = data.chassis\r\n                    else if ship.chassis?\r\n                        chassis_title = ship.chassis\r\n                    else\r\n                        chassis_title = \"\"\r\n\r\n                    if chassis_title != \"\"\r\n                        container.find('p.info-chassis').html \"<strong>#{exportObj.chassis[chassis_title]?.display_name ? chassis_title}:</strong> #{exportObj.chassis[chassis_title].text}\"\r\n                        container.find('p.info-chassis').show()\r\n                    else\r\n                        container.find('p.info-chassis').hide()\r\n\r\n                    container.find('tr.info-ship td.info-data').text data.ship\r\n                    container.find('tr.info-ship').show()\r\n                    container.find('tr.info-faction td.info-data').text exportObj.translate(\"faction\", data.faction)\r\n                    container.find('tr.info-faction').hide() # this information is clear from the context, unless we are in card browser\r\n                    if ship.base?\r\n                        container.find('tr.info-base td.info-data').text exportObj.translate(\"gameterms\", ship.base)\r\n                    else\r\n                        container.find('tr.info-base td.info-data').text exportObj.translate(\"gameterms\", \"Small\")\r\n                    container.find('tr.info-base').show()\r\n\r\n                    \r\n                    container.find('tr.info-skill td.info-data').text data.skill\r\n                    container.find('tr.info-skill').toggle(data.skill?)\r\n\r\n                    container.find('tr.info-points td.info-data').text (if @isBeta and data.pointsbeta? then data.pointsbeta else data.points)\r\n                    container.find('tr.info-points').show()\r\n\r\n                    container.find('tr.info-loadout td.info-data').text (if @isBeta and data.loadoutbeta? then data.loadoutbeta else data.loadout)\r\n                    if data.upgrades?\r\n                        container.find('tr.info-loadout').hide()\r\n                    else\r\n                        container.find('tr.info-loadout').show()\r\n                    if data.engagement?\r\n                        container.find('tr.info-engagement td.info-data').text data.engagement\r\n                        container.find('tr.info-engagement').show()\r\n                    else\r\n                        container.find('tr.info-engagement').hide()\r\n                    \r\n                    container.find('tr.info-attack td.info-header i.xwing-miniatures-font').addClass(ship.attack_icon ? 'xwing-miniatures-font-attack')\r\n\r\n                    container.find('tr.info-attack td.info-data').text statAndEffectiveStat((data.ship_override?.attack ? ship.attack), effective_stats, 'attack')\r\n                    container.find('tr.info-attack').toggle(((data.ship_override?.attack ? ship.attack) > 0) or (effective_stats?.attack? and effective_stats?.attack > 0))\r\n\r\n                    container.find('tr.info-attack-fullfront td.info-data').text statAndEffectiveStat((data.ship_override?.attackf ? ship.attackf), effective_stats, 'attackf')\r\n                    container.find('tr.info-attack-fullfront').toggle(ship.attackf? or effective_stats?.attackf?)\r\n                    \r\n                    container.find('tr.info-attack-bullseye td.info-data').text statAndEffectiveStat((data.ship_override?.attackbull ? ship.attackbull), effective_stats, 'attackbull')\r\n                    container.find('tr.info-attack-bullseye').toggle(ship.attackbull? or effective_stats?.attackbull?)\r\n\r\n                    container.find('tr.info-attack-left td.info-data').text statAndEffectiveStat((data.ship_override?.attackl ? ship.attackl), effective_stats, 'attackl')\r\n                    container.find('tr.info-attack-left').toggle(ship.attackl? or effective_stats?.attackl?)\r\n\r\n                    container.find('tr.info-attack-right td.info-data').text statAndEffectiveStat((data.ship_override?.attackr ? ship.attackr), effective_stats, 'attackr')\r\n                    container.find('tr.info-attack-right').toggle(ship.attackr? or effective_stats?.attackr?)\r\n                    \r\n                    container.find('tr.info-attack-back td.info-data').text statAndEffectiveStat((data.ship_override?.attackb ? ship.attackb), effective_stats, 'attackb')\r\n                    container.find('tr.info-attack-back').toggle(ship.attackb? or effective_stats?.attackb?)\r\n\r\n                    container.find('tr.info-attack-turret td.info-data').text statAndEffectiveStat((data.ship_override?.attackt ? ship.attackt), effective_stats, 'attackt')\r\n                    container.find('tr.info-attack-turret').toggle(data.ship_override?.attackt? or ship.attackt? or effective_stats?.attackt?)\r\n\r\n                    container.find('tr.info-attack-doubleturret td.info-data').text statAndEffectiveStat((data.ship_override?.attackdt ? ship.attackdt), effective_stats, 'attackdt')\r\n                    container.find('tr.info-attack-doubleturret').toggle(ship.attackdt? or effective_stats?.attackdt?)\r\n\r\n                    container.find('tr.info-range').hide()\r\n                    container.find('td.info-rangebonus').hide()\r\n                    container.find('tr.info-agility td.info-data').text statAndEffectiveStat((data.ship_override?.agility ? ship.agility), effective_stats, 'agility')\r\n                    container.find('tr.info-agility').toggle(data.ship_override?.agility? or ship.agility?)\r\n                    container.find('tr.info-hull td.info-data').text statAndEffectiveStat((data.ship_override?.hull ? ship.hull), effective_stats, 'hull')\r\n                    container.find('tr.info-hull').toggle(data.ship_override?.hull? or ship.hull?)\r\n\r\n                    recurringicon = ''\r\n                    if ship.shieldrecurr?\r\n                        count = 0\r\n                        while count < ship.shieldrecurr\r\n                            recurringicon += '<sup><i class=\"fas fa-caret-up\"></i></sup>'\r\n                            ++count\r\n                    container.find('tr.info-shields td.info-data').html (statAndEffectiveStat((data.ship_override?.shields ? ship.shields), effective_stats, 'shields') + recurringicon)\r\n                    container.find('tr.info-shields').toggle(data.ship_override?.shields? or ship.shields?)\r\n\r\n                    recurringicon = ''\r\n                    if ship.energyrecurr?\r\n                        count = 0\r\n                        while count < ship.energyrecurr\r\n                            recurringicon += '<sup><i class=\"fas fa-caret-up\"></i></sup>'\r\n                            ++count\r\n                    container.find('tr.info-energy td.info-data').html (statAndEffectiveStat((data.ship_override?.energy ? ship.energy), effective_stats, 'energy') + recurringicon)\r\n                    container.find('tr.info-energy').toggle(data.ship_override?.energy? or ship.energy?)\r\n                    \r\n                    \r\n                    if (effective_stats?.force? and effective_stats.force > 0) or data.force?\r\n                        recurringicon = ''\r\n                        forcerecurring = 1\r\n                        if effective_stats?.forcerecurring? \r\n                            forcerecurring = effective_stats.forcerecurring\r\n                        else if data.forcerecurring?\r\n                            forcerecurring = data.forcerecurring\r\n                        count = 0\r\n                        while count < forcerecurring                        \r\n                            recurringicon += '<sup><i class=\"fas fa-caret-up\"></i></sup>'\r\n                            ++count\r\n                        container.find('tr.info-force td.info-data').html (statAndEffectiveStat((data.ship_override?.force ? data.force), effective_stats, 'force') + recurringicon)\r\n                        container.find('tr.info-force').show()\r\n                    else\r\n                        container.find('tr.info-force').hide()\r\n\r\n                    if data.charge?\r\n                        recurringicon = ''\r\n                        if data.recurring?\r\n                            if data.recurring > 0\r\n                                count = 0\r\n                                while count < data.recurring\r\n                                    recurringicon += '<sup><i class=\"fas fa-caret-up\"></i></sup>'\r\n                                    ++count\r\n                            else\r\n                                count = data.recurring\r\n                                while count < 0\r\n                                    recurringicon += '<sub><i class=\"fas fa-caret-down\"></i></sub>'\r\n                                    ++count\r\n                        chargeHTML = $.trim \"\"\"#{data.charge}#{recurringicon}\"\"\"\r\n                        container.find('tr.info-charge td.info-data').html (chargeHTML)\r\n                        container.find('tr.info-charge').show()\r\n                    else\r\n                        container.find('tr.info-charge').hide()\r\n\r\n                    if effective_stats?.actions?\r\n                        container.find('tr.info-actions td.info-data').html @formatActions(data.ship_override?.actions ? effective_stats.actions, \", \")\r\n                    else\r\n                        container.find('tr.info-actions td.info-data').html @formatActions(data.ship_override?.actions ? ship.actions, \", \", data.keyword ? [])\r\n                    \r\n                    container.find('tr.info-actions').show()\r\n                    if @isQuickbuild\r\n                        container.find('tr.info-upgrades').hide()\r\n                    else\r\n                        container.find('tr.info-upgrades').show()\r\n                        if @isBeta and data.slotsbeta?\r\n                            container.find('tr.info-upgrades td.info-data').html(if data.slotsbeta? then (exportObj.translate('sloticon', slot) for slot in data.slotsbeta).join(' ') else (if data.upgrades? then @listStandardUpgrades(data.upgrades) else 'None'))\r\n                        else\r\n                            container.find('tr.info-upgrades td.info-data').html(if data.slots? then (exportObj.translate('sloticon', slot) for slot in data.slots).join(' ') else (if data.upgrades? then @listStandardUpgrades(data.upgrades) else 'None'))\r\n                    container.find('p.info-maneuvers').show()\r\n                    maneuvers_override = data.ship_override?.maneuvers ? ship.maneuvers\r\n                    container.find('p.info-maneuvers').html(@getManeuverTableHTML(effective_stats?.maneuvers ? maneuvers_override, maneuvers_override))\r\n                when 'Quickbuild'\r\n                    container.find('.info-type').text @uitranslation('Quickbuild')\r\n                    container.find('.info-sources').hide() # there are different sources for the pilot and the upgrade cards, so we won't display any\r\n                    container.find('.info-collection').hide() # same here, hard to give a single number telling a user how often he ownes all required cards\r\n                    \r\n                    pilot = exportObj.pilots[data.pilot]\r\n                    ship = exportObj.ships[data.ship]\r\n\r\n                    #logic to determine how many dots to use for uniqueness\r\n                    uniquedots = \"\"\r\n                    if pilot.unique?\r\n                        uniquedots = \"&middot;&nbsp;\"\r\n                    else if pilot.max_per_squad?\r\n                        count = 0\r\n                        while (count < data.max_per_squad)\r\n                            uniquedots = uniquedots.concat(\"&middot;\")\r\n                            ++count\r\n                        uniquedots = uniquedots.concat(\"&nbsp;\")\r\n                    else if data.restricted?\r\n                        count = 0\r\n                        while (count < data.restricted)\r\n                            uniquedots = uniquedots.concat(\"&#9672;\")\r\n                            ++count\r\n                        uniquedots = uniquedots.concat(\"&nbsp;\")\r\n                        \r\n                    container.find('.info-name').html \"\"\"#{uniquedots}#{if pilot.display_name then pilot.display_name else pilot.name}#{if data.suffix? then data.suffix else \"\"}#{if exportObj.isReleased(pilot) then \"\" else \" (#{exportObj.translate('ui', 'unreleased')})\"}\"\"\"\r\n\r\n\r\n                    restriction_info = @restriction_text(data) + @upgrade_effect(data)\r\n                    if restriction_info != ''\r\n                        container.find('p.info-restrictions').html restriction_info ? ''\r\n                        container.find('p.info-restrictions').show()\r\n                    else\r\n                        container.find('p.info-restrictions').hide()\r\n\r\n                    container.find('p.info-text').html pilot.text ? ''\r\n                    container.find('p.info-text').show()\r\n\r\n                    container.find('p.info-chassis').html if pilot.chassis? then \"<strong>#{exportObj.chassis[pilot.chassis]?.display_name ? pilot.chassis}:</strong> #{exportObj.chassis[pilot.chassis].text}\" else (if ship.chassis?then \"<strong>#{ship.chassis}:</strong> #{exportObj.chassis[ship.chassis].text}\" else \"\")\r\n                    container.find('p.info-chassis').show()\r\n\r\n                    container.find('tr.info-ship td.info-data').text data.ship\r\n                    container.find('tr.info-ship').show()\r\n                    container.find('tr.info-faction td.info-data').text exportObj.translate(\"faction\", data.faction)\r\n                    container.find('tr.info-faction').hide() # this information is clear from the context, unless we are in card browser\r\n\r\n                    if ship.base?\r\n                        container.find('tr.info-base td.info-data').text exportObj.translate(\"gameterms\", ship.base)\r\n                    else\r\n                        container.find('tr.info-base td.info-data').text exportObj.translate(\"gameterms\", \"Small\")\r\n                    container.find('tr.info-base').show()\r\n\r\n                    container.find('tr.info-skill td.info-data').text pilot.skill\r\n                    container.find('tr.info-skill').show()\r\n                    container.find('tr.info-points').hide()\r\n                    container.find('tr.info-loadout').hide()\r\n                    container.find('tr.info-engagement td.info-data').text pilot.skill\r\n                    container.find('tr.info-engagement').show()\r\n\r\n                    container.find('tr.info-attack td.info-data').text(pilot.ship_override?.attack ? ship.attack)\r\n                    container.find('tr.info-attack').toggle((pilot.data?.ship_override?.attack ? ship.attack) > 0)\r\n\r\n                    container.find('tr.info-attack-fullfront td.info-data').text(ship.attackf)\r\n                    container.find('tr.info-attack-fullfront').toggle(ship.attackf?)\r\n                    \r\n                    container.find('tr.info-attack-bullseye td.info-data').text(ship.attackbull)\r\n                    container.find('tr.info-attack-bullseye').toggle(ship.attackbull?)\r\n                    container.find('tr.info-attack-left td.info-data').text(ship.attackl)\r\n                    container.find('tr.info-attack-left').toggle(ship.attackl?)\r\n                    container.find('tr.info-attack-right td.info-data').text(ship.attackr)\r\n                    container.find('tr.info-attack-right').toggle(ship.attackr?)\r\n                    container.find('tr.info-attack-back td.info-data').text(ship.attackb)\r\n                    container.find('tr.info-attack-back').toggle(ship.attackb?)\r\n                    container.find('tr.info-attack-turret td.info-data').text(ship.attackt)\r\n                    container.find('tr.info-attack-turret').toggle(ship.attackt?)\r\n                    container.find('tr.info-attack-doubleturret td.info-data').text(ship.attackdt)\r\n                    container.find('tr.info-attack-doubleturret').toggle(ship.attackdt?)\r\n                    \r\n                    container.find('tr.info-attack td.info-header i.xwing-miniatures-font').addClass(ship.attack_icon ? 'xwing-miniatures-font-frontarc')\r\n\r\n                    container.find('tr.info-energy td.info-data').text(pilot.ship_override?.energy ? ship.energy)\r\n                    container.find('tr.info-energy').toggle(pilot.ship_override?.energy? or ship.energy?)\r\n                    container.find('tr.info-range').hide()\r\n                    container.find('td.info-rangebonus').hide()\r\n                    container.find('tr.info-agility td.info-data').text(pilot.ship_override?.agility ? ship.agility)\r\n                    container.find('tr.info-agility').show()\r\n                    container.find('tr.info-hull td.info-data').text(pilot.ship_override?.hull ? ship.hull)\r\n                    container.find('tr.info-hull').show()\r\n                    container.find('tr.info-shields td.info-data').text(pilot.ship_override?.shields ? ship.shields)\r\n                    container.find('tr.info-shields').show()\r\n\r\n                    if effective_stats?.force? or data.force?\r\n                        recurringicon = ''\r\n                        forcerecurring = 1\r\n                        if effective_stats?.forcerecurring?\r\n                            forcerecurring = effective_stats.forcerecurring\r\n                        count = 0\r\n                        while count < forcerecurring\r\n                            recurringicon += '<sup><i class=\"fas fa-caret-up\"></i></sup>'\r\n                            ++count\r\n                        container.find('tr.info-force td.info-data').html ((pilot.ship_override?.force ? pilot.force)+ recurringicon)\r\n                        container.find('tr.info-force').show()\r\n                    else\r\n                        container.find('tr.info-force').hide()\r\n\r\n                    if data.charge?\r\n                        recurringicon = ''\r\n                        if data.recurring?\r\n                            if data.recurring > 0\r\n                                count = 0\r\n                                while count < data.recurring\r\n                                    recurringicon += '<sup><i class=\"fas fa-caret-up\"></i></sup>'\r\n                                    ++count\r\n                            else\r\n                                count = data.recurring\r\n                                while count < 0\r\n                                    recurringicon += '<sub><i class=\"fas fa-caret-down\"></i></sub>'\r\n                                    ++count\r\n                        chargeHTML = $.trim \"\"\"#{data.charge}#{recurringicon}\"\"\"\r\n                        container.find('tr.info-charge td.info-data').html (chargeHTML)\r\n                        container.find('tr.info-charge').show()\r\n                    else\r\n                        container.find('tr.info-charge').hide()\r\n\r\n                    container.find('tr.info-actions td.info-data').html @formatActions(pilot.ship_override?.actions ? exportObj.ships[data.ship].actions, \", \", pilot.keyword ? [])\r\n    \r\n                    container.find('tr.info-actions').show()\r\n                    container.find('tr.info-upgrades').show()\r\n                    container.find('tr.info-upgrades td.info-data').html(((if exportObj.upgrades[upgrade].display_name? then exportObj.upgrades[upgrade].display_name else upgrade) for upgrade in (data.upgrades ? [])).join(', ') or 'None')\r\n                    container.find('p.info-maneuvers').show()\r\n                    container.find('p.info-maneuvers').html(@getManeuverTableHTML(ship.maneuvers, ship.maneuvers))\r\n                when 'Addon'\r\n                    container.find('.info-type').text exportObj.translate(\"slot\", additional_opts.addon_type)\r\n                    if data.standard?\r\n                        matching_pilots = @getPilotsMatchingUpgrade(data.name, false)\r\n                        container.find('.info-sources.info-data').text (pilot.display_name for pilot in matching_pilots).sort().join(', ')\r\n                    else\r\n                        container.find('.info-sources.info-data').text (exportObj.translate('sources', source) for source in data.sources).sort().join(', ')\r\n                    container.find('.info-sources').show()\r\n                    \r\n                    #logic to determine how many dots to use for uniqueness\r\n                    uniquedots = \"\"\r\n                    if data.unique?\r\n                        uniquedots = \"&middot;&nbsp;\"\r\n                    else if data.max_per_squad?\r\n                        count = 0\r\n                        while (count < data.max_per_squad)\r\n                            uniquedots = uniquedots.concat(\"&middot;\")\r\n                            ++count\r\n                        uniquedots = uniquedots.concat(\"&nbsp;\")\r\n                    else if data.restricted?\r\n                        count = 0\r\n                        while (count < data.restricted)\r\n                            uniquedots = uniquedots.concat(\"&#9672;\")\r\n                            ++count\r\n                        uniquedots = uniquedots.concat(\"&nbsp;\")\r\n                    \r\n                    \r\n                    if @collection?.counts? and (not data.standard?)\r\n                        addon_count = @collection.counts?['upgrade']?[data.name] ? 0\r\n                        container.find('.info-collection').text @uitranslation(\"collectionContentUpgrades\", addon_count)\r\n                        container.find('.info-collection').show()\r\n                    else\r\n                        container.find('.info-collection').hide()\r\n                    container.find('.info-name').html \"\"\"#{uniquedots}#{if data.display_name then data.display_name else data.name}#{if (exportObj.isReleased(data) or data.standard?) then  \"\" else \" (#{@uitranslation('unreleased')})\"}#{if data.standard? then \" (S)\" else \"\"}\"\"\"\r\n                    \r\n                    if @isBeta and data.pointsbeta? then points = data.pointsbeta else points = data.points\r\n                    if Array.isArray(points)\r\n                        point_info = \"<i>\" + @uitranslation(\"varPointCostsPoints\", points)\r\n                        switch data.variablepoints\r\n                            when \"Agility\"\r\n                                point_info += @uitranslation(\"varPointCostsConditionAgility\", [0..points.length-1])\r\n                            when \"Initiative\"\r\n                                point_info += @uitranslation(\"varPointCostsConditionIni\", [0..points.length-1])\r\n                            when \"Base\"\r\n                                point_info += @uitranslation(\"varPointCostsConditionBase\")\r\n                            when \"Faction\"\r\n                                point_info += @uitranslation(\"varPointCostsConditionFaction\", data.faction)\r\n                        point_info += \"</i>\"\r\n\r\n                    restriction_info = @restriction_text(data) + @upgrade_effect(data)\r\n                    if point_info? or (restriction_info != '')\r\n                        if point_info? and (restriction_info != '')\r\n                            point_info += \"<br/>\"\r\n                        container.find('p.info-restrictions').html (point_info ? '') + restriction_info\r\n                        container.find('p.info-restrictions').show()\r\n                    else\r\n                        container.find('p.info-restrictions').hide()\r\n\r\n                    container.find('p.info-text').html (data.text ? '')\r\n                    container.find('p.info-text').show()\r\n                    container.find('p.info-chassis').hide()\r\n                    container.find('tr.info-ship').hide()\r\n                    container.find('tr.info-faction').hide()\r\n                    container.find('tr.info-base').hide()\r\n                    container.find('tr.info-skill').hide()\r\n                    container.find('tr.info-points').hide()\r\n                    container.find('tr.info-loadout').hide()\r\n                    container.find('tr.info-engagement').hide()\r\n                    if data.energy?\r\n                        container.find('tr.info-energy td.info-data').text data.energy\r\n                        container.find('tr.info-energy').show()\r\n                    else\r\n                        container.find('tr.info-energy').hide()\r\n                    if data.attack?\r\n                        container.find('tr.info-attack td.info-data').text data.attack\r\n                        container.find('tr.info-attack').show()\r\n                    else\r\n                        container.find('tr.info-attack').hide()\r\n\r\n                    if data.attackb?\r\n                        container.find('tr.info-attack-back td.info-data').text data.attackb\r\n                        container.find('tr.info-attack-back').show()\r\n                    else\r\n                        container.find('tr.info-attack-back').hide()\r\n\r\n                    if data.attackt?\r\n                        container.find('tr.info-attack-turret td.info-data').text data.attackt\r\n                        container.find('tr.info-attack-turret').show()\r\n                    else\r\n                        container.find('tr.info-attack-turret').hide()\r\n\r\n                    if data.attackr?\r\n                        container.find('tr.info-attack-right td.info-data').text data.attackr\r\n                        container.find('tr.info-attack-right').show()\r\n                    else\r\n                        container.find('tr.info-attack-right').hide()\r\n\r\n                    if data.attackl?\r\n                        container.find('tr.info-attack-left td.info-data').text data.attackl\r\n                        container.find('tr.info-attack-left').show()\r\n                    else\r\n                        container.find('tr.info-attack-left').hide()\r\n\r\n                    if data.attackdt?\r\n                        container.find('tr.info-attack-doubleturret td.info-data').text data.attackdt\r\n                        container.find('tr.info-attack-doubleturret').show()\r\n                    else\r\n                        container.find('tr.info-attack-doubleturret').hide()\r\n                        \r\n                    if data.attackbull?\r\n                        container.find('tr.info-attack-bullseye td.info-data').text data.attackbull\r\n                        container.find('tr.info-attack-bullseye').show()\r\n                    else\r\n                        container.find('tr.info-attack-bullseye').hide()\r\n\r\n                    if data.attackf?\r\n                        container.find('tr.info-attack-fullfront td.info-data').text data.attackf\r\n                        container.find('tr.info-attack-fullfront').show()\r\n                    else\r\n                        container.find('tr.info-attack-fullfront').hide()\r\n                        \r\n                    if data.charge?\r\n                        recurringicon = ''\r\n                        if data.recurring?\r\n                            if data.recurring > 0\r\n                                count = 0\r\n                                while count < data.recurring\r\n                                    recurringicon += '<sup><i class=\"fas fa-caret-up\"></i></sup>'\r\n                                    ++count\r\n                            else\r\n                                count = data.recurring\r\n                                while count < 0\r\n                                    recurringicon += '<sub><i class=\"fas fa-caret-down\"></i></sub>'\r\n                                    ++count\r\n                        chargeHTML = $.trim \"\"\"#{data.charge}#{recurringicon}\"\"\"\r\n                        container.find('tr.info-charge td.info-data').html (chargeHTML)\r\n                    container.find('tr.info-charge').toggle(data.charge?)\r\n\r\n                    if data.range?\r\n                        container.find('tr.info-range td.info-data').text data.range\r\n                        container.find('tr.info-range').show()\r\n                    else\r\n                        container.find('tr.info-range').hide()\r\n\r\n                    if data.rangebonus?\r\n                        container.find('td.info-rangebonus').show()\r\n                    else\r\n                        container.find('td.info-rangebonus').hide()\r\n                        \r\n                    if data.force?\r\n                        recurringicon = ''\r\n                        forcerecurring = 1\r\n                        if data.forcerecurring?\r\n                            forcerecurring = data.forcerecurring\r\n                        count = 0\r\n                        while count < forcerecurring\r\n                            recurringicon += '<sup><i class=\"fas fa-caret-up\"></i></sup>'\r\n                            ++count\r\n                        container.find('tr.info-force td.info-data').html (data.force + recurringicon)\r\n                    container.find('tr.info-force').toggle(data.force?)                        \r\n\r\n                    container.find('tr.info-agility').hide()\r\n                    container.find('tr.info-hull').hide()\r\n                    container.find('tr.info-shields').hide()\r\n                    container.find('tr.info-actions').hide()\r\n                    container.find('tr.info-upgrades').hide()\r\n                    container.find('p.info-maneuvers').hide()\r\n                when 'Rules'\r\n                    container.find('.info-type').hide()\r\n                    container.find('.info-sources').hide()\r\n                    container.find('.info-collection').hide()\r\n                    container.find('.info-name').html data.name\r\n                    container.find('.info-name').show()\r\n                    container.find('p.info-restrictions').hide()\r\n                    container.find('p.info-text').html data.text\r\n                    container.find('p.info-text').show()\r\n                    container.find('tr.info-ship').hide()\r\n                    container.find('tr.info-faction').hide()\r\n                    container.find('tr.info-base').hide()\r\n                    container.find('tr.info-skill').hide()\r\n                    container.find('tr.info-points').hide()\r\n                    container.find('tr.info-loadout').hide()\r\n                    container.find('tr.info-agility').hide()\r\n                    container.find('tr.info-hull').hide()\r\n                    container.find('tr.info-shields').hide()\r\n                    container.find('tr.info-actions').hide()\r\n                    container.find('tr.info-upgrades').hide()\r\n                    container.find('p.info-maneuvers').hide()\r\n                    container.find('tr.info-energy').hide()\r\n                    container.find('tr.info-attack').hide()\r\n                    container.find('tr.info-attack-turret').hide()\r\n                    container.find('tr.info-attack-bullseye').hide()\r\n                    container.find('tr.info-attack-fullfront').hide()\r\n                    container.find('tr.info-attack-back').hide()\r\n                    container.find('tr.info-attack-doubleturret').hide()\r\n                    container.find('tr.info-charge').hide()\r\n                    container.find('td.info-rangebonus').hide()\r\n                    container.find('tr.info-range').hide()\r\n                    container.find('tr.info-force').hide()\r\n                when 'MissingStuff'\r\n                    container.find('.info-type').text @uitranslation(\"List of Missing items\")\r\n                    container.find('.info-sources').hide()\r\n                    container.find('.info-collection').hide()\r\n                    container.find('.info-name').html @uitranslation(\"Missing items\")\r\n                    container.find('.info-name').show()\r\n                    missingStuffInfoText = @uitranslation(\"Missing Item List:\")+\"<ul>\"\r\n                    for item in data\r\n                        missingStuffInfoText += \"\"\"<li><strong>#{(if item.display_name? then item.display_name else item.name)}</strong> (\"\"\"\r\n                        first = true\r\n                        for source in item.sources\r\n                            if not first\r\n                                missingStuffInfoText += \", \"\r\n                            missingStuffInfoText += source\r\n                            first = false\r\n                        missingStuffInfoText += \")</li>\"\r\n                    missingStuffInfoText +=\"</ul>\"\r\n                    container.find('p.info-restrictions').hide()\r\n                    container.find('p.info-text').html missingStuffInfoText\r\n                    container.find('p.info-text').show()\r\n                    container.find('tr.info-ship').hide()\r\n                    container.find('tr.info-faction').hide()\r\n                    container.find('tr.info-base').hide()\r\n                    container.find('tr.info-skill').hide()\r\n                    container.find('tr.info-points').hide()\r\n                    container.find('tr.info-loadout').hide()\r\n                    container.find('tr.info-agility').hide()\r\n                    container.find('tr.info-hull').hide()\r\n                    container.find('tr.info-shields').hide()\r\n                    container.find('tr.info-actions').hide()\r\n                    container.find('tr.info-upgrades').hide()\r\n                    container.find('p.info-maneuvers').hide()\r\n                    container.find('tr.info-energy').hide()\r\n                    container.find('tr.info-attack').hide()\r\n                    container.find('tr.info-attack-turret').hide()\r\n                    container.find('tr.info-attack-bullseye').hide()\r\n                    container.find('tr.info-attack-fullfront').hide()\r\n                    container.find('tr.info-attack-back').hide()\r\n                    container.find('tr.info-attack-doubleturret').hide()\r\n                    container.find('tr.info-charge').hide()\r\n                    container.find('td.info-rangebonus').hide()\r\n                    container.find('tr.info-range').hide()\r\n                    container.find('tr.info-force').hide()\r\n                when 'Damage'\r\n                    container.find('.info-type').text exportObj.translate(\"types\", data.type)\r\n                    container.find('.info-sources.info-data').text (exportObj.translate('sources', source) for source in data.sources).sort().join(', ')\r\n                    container.find('.info-sources').show()\r\n\r\n                    if @collection?.counts?\r\n                        addon_count = @collection.counts?['damage']?[data.name] ? 0\r\n                        container.find('.info-collection').text @uitranslation(\"collectionContentUpgrades\", addon_count)\r\n                        container.find('.info-collection').show()\r\n                    else\r\n                        container.find('.info-collection').hide()\r\n                    container.find('.info-name').html \"\"\"#{if data.display_name then data.display_name else data.name} (#{data.quantity}x)\"\"\"\r\n                    \r\n                    container.find('p.info-restrictions').hide()\r\n                    container.find('p.info-text').html (data.text ? '')\r\n                    container.find('p.info-text').show()\r\n                    container.find('p.info-chassis').hide()\r\n                    container.find('tr.info-ship').hide()\r\n                    container.find('tr.info-faction').hide()\r\n                    container.find('tr.info-base').hide()\r\n                    container.find('tr.info-skill').hide()\r\n                    container.find('tr.info-points').hide()\r\n                    container.find('tr.info-loadout').hide()\r\n                    container.find('tr.info-engagement').hide()\r\n                    container.find('tr.info-energy').hide()\r\n                    container.find('tr.info-attack').hide()\r\n                    container.find('tr.info-attack-back').hide()\r\n                    container.find('tr.info-attack-turret').hide()\r\n                    container.find('tr.info-attack-right').hide()\r\n                    container.find('tr.info-attack-left').hide()\r\n                    container.find('tr.info-attack-doubleturret').hide()\r\n                    container.find('tr.info-attack-bullseye').hide()\r\n                    container.find('tr.info-attack-fullfront').hide()\r\n                    container.find('tr.info-charge').hide()\r\n                    container.find('tr.info-range').hide()\r\n                    container.find('td.info-rangebonus').hide()\r\n                    container.find('tr.info-force').hide()     \r\n                    container.find('tr.info-agility').hide()\r\n                    container.find('tr.info-hull').hide()\r\n                    container.find('tr.info-shields').hide()\r\n                    container.find('tr.info-actions').hide()\r\n                    container.find('tr.info-upgrades').hide()\r\n                    container.find('p.info-maneuvers').hide()\r\n\r\n            if container != @mobile_tooltip_modal\r\n                container.find('.info-well').show()\r\n                container.find('.intro').hide()\r\n            @tooltip_currently_displaying = data\r\n\r\n            # fix card viewer to view, if it is fully visible (it might not be e.g. on mobile devices. In that case keep it on its static position, so you can scroll to see it)\r\n            \r\n            if $(window).width() >= 768\r\n                well = container.find('.info-well')\r\n                if $.isElementInView(well, true)\r\n                    well.css('position','fixed')\r\n                else\r\n                    well.css('position','static')\r\n        \r\n    _randomizerLoopBody: (data) =>\r\n        if data.keep_running\r\n            if @total_points == data.max_points\r\n                # ToDo: Check if we meet the requirement of minimum 3 ships?\r\n                # Ships are done, now start equipping upgrades to them!\r\n                data.keep_running = false\r\n                if @isQuickbuild\r\n                    data.keep_running = false\r\n                    return\r\n                    \r\n                for ship in @ships\r\n                    expensive_slots = []\r\n                    if ship.pilot.loadout? and not ship.pilot.upgrades?\r\n                        while ship.upgrade_points_total < ship.pilot.loadout\r\n                            # we wan't to utilize newly added upgrade slots, so we will check for slots iteratively\r\n                            unused_addons = []\r\n                            for upgrade in ship.upgrades\r\n                                unused_addons.push upgrade unless upgrade.data? or (upgrade.occupied_by? and upgrade.occupied_by != null) or upgrade in expensive_slots\r\n                            if unused_addons.length == 0\r\n                                break # it's fine to not spend all points - otherwise few-slot ships will always receive the same upgrade(s)\r\n                            # select random slot\r\n                            addon = unused_addons[$.randomInt unused_addons.length]\r\n                            # select and equip random upgrade\r\n                            available_upgrades = (upgrade for upgrade in @getAvailableUpgradesIncluding(addon.slot, null, ship, addon,'', @dfl_filter_func, sorted = false) when (exportObj.upgradesById[upgrade.id].sources.intersects(data.allowed_sources) and ((not data.collection_only) or @collection.checkShelf('upgrade', upgrade.name))) and not upgrade.disabled)\r\n                            if available_upgrades.length > 0\r\n                                upgrade =  available_upgrades[$.randomInt available_upgrades.length] \r\n                                await addon.setById upgrade.id\r\n                            else\r\n                                # that slot has only expensive stuff. ignore it in the future!\r\n                                expensive_slots.push addon\r\n                        \r\n            else if @total_points < data.max_points\r\n                # need to add more ships\r\n                # Add random ship\r\n                # try to find a ship that is cheap enough. If none exist, pick an expensive one and remove a random ship in the next iteration\r\n                available_ships = @getAvailableShipsMatchingAndCheapEnough(data.max_points - @total_points, '', false, data.collection_only)\r\n                if available_ships.length == 0\r\n                    available_ships = @getAvailableShipsMatching('', false, data.collection_only)\r\n                if (available_ships.length > 0) and ((@ships.length < data.ship_limit) or (data.ship_limit == 0))\r\n                    ship_type = available_ships[$.randomInt available_ships.length].name\r\n                    available_pilots = @getAvailablePilotsForShipIncluding(ship_type)\r\n                    if available_pilots.length == 0 \r\n                        # edge case: It might have been a ship selected, that has only unique pilots - which all have been already selected \r\n                        return\r\n                    pilot = available_pilots[$.randomInt available_pilots.length]\r\n                    if not pilot.disabled and (if @isQuickbuild then exportObj.pilots[exportObj.quickbuildsById[pilot.id].pilot] else exportObj.pilotsById[pilot.id]).sources.intersects(data.allowed_sources) and ((not data.collection_only) or @collection.checkShelf('pilot', (if @isQuickbuild then exportObj.quickbuildsById[pilot.id] else pilot.name)))\r\n                        new_ship = @addShip()\r\n                        new_ship.setPilotById pilot.id\r\n\r\n            else\r\n                # need to remove a ship, cause we are too expensive\r\n                @removeShip @ships[$.randomInt @ships.length]\r\n            # continue the \"loop\"\r\n            window.setTimeout @_makeRandomizerLoopFunc(data), 0\r\n        else\r\n            #console.log \"Clearing timer #{data.timer}, iterations=#{data.iterations}, keep_running=#{data.keep_running}\"\r\n            # we have to stop randomizing, but should do a final check on our point costs. (in case our last step was adding something expensive)\r\n            while @total_points > data.max_points\r\n                @removeShip @ships[$.randomInt @ships.length]\r\n\r\n            if data.fill_zero_pts\r\n                for ship in @ships\r\n                    for addon in ship.upgrades\r\n                        continue unless not (addon.data? or (addon.occupied_by? and addon.occupied_by != null))\r\n                        available_upgrades = (upgrade for upgrade in @getAvailableUpgradesIncluding(addon.slot, null, addon.ship, addon,'', @dfl_filter_func, sorted = false) when (exportObj.upgradesById[upgrade.id].sources.intersects(data.allowed_sources) and (upgrade.points < 1) and ((not data.collection_only) or @collection.checkShelf('upgrade', upgrade.name))))\r\n                        upgrade = if available_upgrades.length > 0 then available_upgrades[$.randomInt available_upgrades.length] else undefined\r\n                        if upgrade and not upgrade.disabled\r\n                            addon.setById upgrade.id\r\n                        \r\n            window.clearTimeout data.timer\r\n            # Update all selectors\r\n            for ship in @ships\r\n                ship.updateSelections()\r\n            @suppress_automatic_new_ship = false\r\n            @addShip()\r\n\r\n    _makeRandomizerLoopFunc: (data) =>\r\n        () =>\r\n            @_randomizerLoopBody(data)\r\n\r\n    randomSquad: (max_points=50, allowed_sources=null, timeout_ms=1000, ship_limit=0, collection_only=true, fill_zero_pts=false) ->\r\n        @backend_status.fadeOut 'slow'\r\n        @suppress_automatic_new_ship = true\r\n        \r\n        if allowed_sources.length < 1\r\n            allowed_sources = null\r\n        \r\n        # Clear all existing ships\r\n        while @ships.length > 0\r\n            @removeShip @ships[0]\r\n        throw new Error(\"Ships not emptied\") if @ships.length > 0\r\n        data =\r\n            max_points: max_points\r\n            ship_limit: ship_limit\r\n            keep_running: true\r\n            allowed_sources: allowed_sources ? exportObj.expansions\r\n            collection_only: @collection? and (@collection.checks.collectioncheck == \"true\") and collection_only\r\n            fill_zero_pts: fill_zero_pts\r\n        stopHandler = () =>\r\n            #console.log \"*** TIMEOUT *** TIMEOUT *** TIMEOUT ***\"\r\n            data.keep_running = false\r\n        data.timer = window.setTimeout stopHandler , timeout_ms\r\n        #console.log \"Timer set for #{timeout_ms}ms, timer is #{data.timer}\"\r\n        window.setTimeout @_makeRandomizerLoopFunc(data), 0\r\n        @resetCurrentSquad()\r\n        @current_squad.name = @uitranslation('Random Squad')\r\n        @container.trigger 'xwing-backend:squadNameChanged'\r\n\r\n    setBackend: (backend) ->\r\n        @backend = backend\r\n        if @waiting_for_backend?\r\n            for meth in @waiting_for_backend\r\n                meth()\r\n\r\n    upgrade_effect: (card) ->\r\n        removestext = text = comma = ''\r\n        if card.modifier_func\r\n            statchange =\r\n                attack: 0\r\n                attackf: 0\r\n                attackbull: 0\r\n                attackb: 0\r\n                attackt: 0\r\n                attackl: 0\r\n                attackr: 0\r\n                attackdt: 0\r\n                energy: 0\r\n                agility: 0\r\n                hull: 0\r\n                shields: 0\r\n                force: 0\r\n                actions: []\r\n                maneuvers: [0, 0]\r\n            card.modifier_func(statchange)\r\n            if statchange.attack != 0\r\n                text += comma + \"%FRONTARC% (#{statchange.attack})\"\r\n                comma = ', '\r\n            if statchange.attackf != 0\r\n                text += comma + \"%FULLFRONTARC% (#{statchange.attackf})\"\r\n                comma = ', '\r\n            if statchange.attackbull != 0\r\n                text += comma + \"%BULLSEYEARC% (#{statchange.attackbull})\"\r\n                comma = ', '\r\n            if statchange.attackb != 0\r\n                text += comma + \"%REARARC% (#{statchange.attackb})\"\r\n                comma = ', '\r\n            if statchange.attackt != 0\r\n                text += comma + \"%SINGLETURRETARC% (#{statchange.attackt})\"\r\n                comma = ', '\r\n            if statchange.attackl != 0\r\n                text += comma + \"%LEFTARC% (#{statchange.attackl})\"\r\n                comma = ', '\r\n            if statchange.attackr != 0\r\n                text += comma + \"%RIGHTARC% (#{statchange.attackr})\"\r\n                comma = ', '\r\n            if statchange.attackdt != 0\r\n                text += comma + \"%DOUBLETURRETARC% (#{statchange.attackdt})\"\r\n                comma = ', '\r\n            if statchange.energy != 0\r\n                text += comma + \"%ENERGY% (#{statchange.energy})\"\r\n                comma = ', '\r\n            if statchange.agility != 0\r\n                text += comma + \"%AGILITY% (#{statchange.agility})\"\r\n                comma = ', '\r\n            if statchange.hull != 0\r\n                text += comma + \"%HULL% (#{statchange.hull})\"\r\n                comma = ', '\r\n            if statchange.shields != 0\r\n                text += comma + \"%SHIELD% (#{statchange.shields})\"\r\n                comma = ', '\r\n            if statchange.actions.length > 0\r\n                text += comma + @formatActions(statchange.actions, \", \")\r\n                comma = ', '\r\n        if card.confersAddons\r\n            for addonname in card.confersAddons\r\n                if addonname.slot == \"Force\" then text += comma + \"%FORCEPOWER%\" else text += comma + \"%#{addonname.slot.toUpperCase().replace(/[^a-z0-9]/gi, '')}%\" \r\n                comma = ', '\r\n        if card.unequips_upgrades\r\n            comma = ''\r\n            for slot in card.unequips_upgrades\r\n                removestext += comma + \"%#{slot.toUpperCase().replace(/[^a-z0-9]/gi, '')}%\" \r\n                comma = ', '\r\n        if text != ''\r\n            data = \r\n                text: \"</br><b>#{@uitranslation(\"adds\", text)}</b>\"\r\n            if removestext != ''\r\n                data.text += \"</br><b>#{@uitranslation(\"removes\", removestext)}</b>\"\r\n            return exportObj.fixIcons(data)\r\n        else\r\n            return ''\r\n\r\n    restriction_text: (card) ->\r\n        uniquetext = comma = othertext = text = ''\r\n        ignoreShip = false\r\n        standardized = card.standardized?\r\n        if (@isBeta and card.standardizedbeta?) then standardized = card.standardizedbeta\r\n        if card.restrictions? then card_restrictions = card.restrictions\r\n        if (@isBeta and card.restrictionsbeta?) then card_restrictions = card.restrictionsbeta\r\n        if card_restrictions?\r\n            for r in card_restrictions\r\n                switch r[0]\r\n                    when \"FactionOrUnique\"\r\n                        othertext += comma + exportObj.translate('faction', \"#{r[2]}\")                \r\n                        uniquetext = exportObj.translate('restrictions', \" or Squad Including\") + \" #{r[1]}\"\r\n                    when \"Base\"\r\n                        for b, index in r\r\n                            if b == \"Base\" \r\n                                text += comma\r\n                                continue\r\n                            text += \"#{b} \"\r\n                            if index < r.length - 1 then text += \"or \" else text += exportObj.translate('restrictions', \"Ship\")\r\n                    when \"Action\"\r\n                        array = [r[1]]\r\n                        text += comma + @formatActions(array,\"\", [])\r\n                    when \"Equipped\"\r\n                        text += comma + \"%#{r[1].toUpperCase().replace(/[^a-z0-9]/gi, '')}% Equipped\"\r\n                    when \"Slot\"\r\n                        text += comma + exportObj.translate('restrictions', \"Extra\") + \" %#{r[1].toUpperCase().replace(/[^a-z0-9]/gi, '')}%\"\r\n                    when \"Keyword\"\r\n                        text += comma + exportObj.translate('restrictions', \"#{r[1]}\")\r\n                        ignoreShip = true\r\n                    when \"AttackArc\"\r\n                        text += comma + \"%REARARC%\"\r\n                    when \"ShieldsGreaterThan\"\r\n                        text += comma + \"%SHIELD% > #{r[1]}\"\r\n                    when \"EnergyGreatterThan\"\r\n                        text += comma + \"%ENERGY% > #{r[1]}\"\r\n                    when \"InitiativeGreaterThan\"\r\n                        text += comma + exportObj.translate('restrictions', \"Initiative\") + \" > #{r[1]}\"\r\n                    when \"InitiativeLessThan\"\r\n                        text += comma + exportObj.translate('restrictions', \"Initiative\")+ \" < #{r[1]}\"\r\n                    when \"HasForce\"\r\n                        text += comma + (if r[1] then \"\" else \"No \") + \"%FORCE%\"\r\n                    when \"AgilityEquals\"\r\n                        text += comma + exportObj.translate('restrictions', \"Agility\") + \" = #{r[1]}\"\r\n                    when \"isUnique\"\r\n                        if r[1] == true\r\n                            text += comma + exportObj.translate('restrictions', \"Limited\")\r\n                        else\r\n                            text += comma + exportObj.translate('restrictions', \"Non-Limited\")\r\n                    when \"Format\"\r\n                        text += comma + exportObj.translate('restrictions', \"#{r[1]} Ship\")\r\n                    when \"Faction\"\r\n                        othertext += comma + exportObj.translate('faction', \"#{r[1]}\")\r\n                comma = ', '\r\n        if not card.skill\r\n            if othertext == ''\r\n                if card.faction\r\n                    if card.faction instanceof Array\r\n                        for factionitem in card.faction\r\n                            othertext += comma + exportObj.translate('faction', \"#{factionitem}\")\r\n                            comma = ' or '\r\n                    else\r\n                        othertext += comma + exportObj.translate('faction', \"#{card.faction}\")\r\n                    comma = ', '\r\n            if card.ship and ignoreShip == false\r\n                if card.ship instanceof Array\r\n                    for shipname in card.ship\r\n                        othertext += comma + shipname\r\n                        comma = ' or '\r\n                else\r\n                    othertext += comma + card.ship\r\n                comma = ', '\r\n            if card.solitary\r\n                othertext += comma + exportObj.translate('gameterms', \"Solitary\")\r\n                comma = ', '\r\n            if standardized\r\n                othertext += comma + exportObj.translate('gameterms', \"Standardized\")\r\n                comma = ', '\r\n        text += othertext + uniquetext\r\n        if text != ''\r\n            data = \r\n                text: \"<i><b>\" + exportObj.translate('restrictions', \"Restrictions\") + \":</b> \" + text + \"</i>\"\r\n            return exportObj.fixIcons(data)\r\n        else\r\n            return ''\r\n\r\n\r\n    describeSquad: ->\r\n        if @getNotes().trim() == '' then  ((ship.pilot.name for ship in @ships when ship.pilot?).join ', ') else @getNotes()\r\n\r\n    listCards: ->\r\n        card_obj = {}\r\n        for ship in @ships\r\n            if ship.pilot?\r\n                card_obj[ship.pilot.name] = null\r\n                for upgrade in ship.upgrades\r\n                    card_obj[upgrade.data.name] = null if upgrade.data?\r\n        return Object.keys(card_obj).sort()\r\n\r\n    getNotes: ->\r\n        @notes.val()\r\n\r\n    getTag: ->\r\n        @tag.val()\r\n        \r\n    getObstacles: ->\r\n        @current_obstacles\r\n\r\n    isSquadPossibleWithCollection: ->\r\n        # If the collection is uninitialized or empty, don't actually check it.\r\n        if Object.keys(@collection?.expansions ? {}).length == 0\r\n            # console.log \"collection not ready or is empty\"\r\n            return [true, []]\r\n        else if @collection?.checks.collectioncheck != \"true\"\r\n            # console.log \"collection check not enabled\"\r\n            return [true, []]\r\n        @collection.reset()\r\n        validity = true\r\n        missingStuff = []\r\n        for ship in @ships\r\n            if ship.pilot?\r\n                # Try to get both the physical model and the pilot card.\r\n                ship_is_available = @collection.use('ship', ship.pilot.ship)\r\n                pilot_is_available = @collection.use('pilot', ship.pilot.name)\r\n                # console.log \"#{@faction}: Ship #{ship.pilot.ship} available: #{ship_is_available}\"\r\n                # console.log \"#{@faction}: Pilot #{ship.pilot.name} available: #{pilot_is_available}\"\r\n                validity = false unless ship_is_available and pilot_is_available\r\n                missingStuff.push ship.data unless ship_is_available\r\n                missingStuff.push ship.pilot unless pilot_is_available\r\n                if not ship.pilot.upgrades?\r\n                    for upgrade in ship.upgrades\r\n                        if upgrade.data?\r\n                            upgrade_is_available = @collection.use('upgrade', upgrade.data.name)\r\n                            # console.log \"#{@faction}: Upgrade #{upgrade.data.name} available: #{upgrade_is_available}\"\r\n                            validity = false unless upgrade_is_available or upgrade.data.standard?\r\n                            missingStuff.push upgrade.data unless upgrade_is_available or upgrade.data.standard?\r\n        [validity, missingStuff]\r\n\r\n    checkCollection: ->\r\n        # console.log \"#{@faction}: Checking validity of squad against collection...\"\r\n        if @collection?\r\n            [squadPossible, missingStuff] = @isSquadPossibleWithCollection()\r\n            @collection_invalid_container.toggleClass 'd-none', squadPossible\r\n            @collection_invalid_container.on 'mouseover', (e) =>\r\n                @showTooltip 'MissingStuff', missingStuff\r\n\r\n    toXWS: ->\r\n        # Often you will want JSON.stringify(builder.toXWS())\r\n        versioninfo = \"50P-1.0\"\r\n        rules = \"XWA\"\r\n\r\n        xws =\r\n            description: @getNotes()\r\n            faction: exportObj.toXWSFaction[@faction]\r\n            name: @current_squad.name\r\n            pilots: []\r\n            points: @total_points\r\n            vendor:\r\n                yasb:\r\n                    builder: 'YASB - X-Wing 2.5 XWA'\r\n                    builder_url: window.location.href.split('?')[0]\r\n                    link: @getPermaLink()\r\n            version: versioninfo\r\n            ruleset: rules\r\n            # there is no point to have this version identifier, if we never actually increase it, right?\r\n\r\n        for ship in @ships\r\n            if ship.pilot?\r\n                xws.pilots.push ship.toXWS()\r\n\r\n        # Associate multisection ships\r\n        # This maps id to list of pilots it comprises\r\n        multisection_id_to_pilots = {}\r\n        last_id = 0\r\n        unmatched = (pilot for pilot in xws.pilots when pilot.multisection?)\r\n        for _ in [0...(unmatched.length ** 2)]\r\n            break if unmatched.length == 0\r\n            # console.log \"Top of loop, unmatched: #{m.name for m in unmatched}\"\r\n            unmatched_pilot = unmatched.shift()\r\n            unmatched_pilot.multisection_id ?= last_id++\r\n            multisection_id_to_pilots[unmatched_pilot.multisection_id] ?= [unmatched_pilot]\r\n            break if unmatched.length == 0\r\n            # console.log \"Finding matches for #{unmatched_pilot.name} (assigned id=#{unmatched_pilot.multisection_id})\"\r\n            matches = []\r\n            for candidate in unmatched\r\n                # console.log \"-> examine #{candidate.name}\"\r\n                if unmatched_pilot.name in candidate.multisection\r\n                    matches.push candidate\r\n                    unmatched_pilot.multisection.removeItem candidate.name\r\n                    candidate.multisection.removeItem unmatched_pilot.name\r\n                    candidate.multisection_id = unmatched_pilot.multisection_id\r\n                    # console.log \"-> MATCH FOUND #{candidate.name}, assigned id=#{candidate.multisection_id}\"\r\n                    multisection_id_to_pilots[candidate.multisection_id].push candidate\r\n                    if unmatched_pilot.multisection.length == 0\r\n                        # console.log \"-> No more sections to match for #{unmatched_pilot.name}\"\r\n                        break\r\n            for match in matches\r\n                if match.multisection.length == 0\r\n                    # console.log \"Dequeue #{match.name} since it has no more sections to match\"\r\n                    unmatched.removeItem match\r\n\r\n        for pilot in xws.pilots\r\n            delete pilot.multisection if pilot.multisection?\r\n\r\n        obstacles = @getObstacles()\r\n        if obstacles? and obstacles.length > 0\r\n            xws.obstacles = obstacles\r\n\r\n        xws\r\n\r\n    toMinimalXWS: ->\r\n        # Just what's necessary\r\n        xws = @toXWS()\r\n\r\n        # Keep mandatory stuff only\r\n        for own k, v of xws\r\n            delete xws[k] unless k in ['faction', 'pilots', 'version']\r\n\r\n        for own k, v of xws.pilots\r\n            delete xws[k] unless k in ['id', 'upgrades', 'multisection_id']\r\n\r\n        xws\r\n\r\n    loadFromXWS: (xws, cb) ->\r\n        success = null\r\n        error = null\r\n        \r\n        if xws.version?\r\n            version_list = (parseInt x for x in xws.version.split('.'))\r\n        else\r\n            version_list = [0,2] # Version tag is optional, so let's just assume it is some 2.0 xws if no version is given\r\n\r\n        switch\r\n            # Not doing backward compatibility pre-1.x\r\n            when version_list > [0, 1] or xws.ruleset == 'BETA'\r\n                xws_faction = exportObj.fromXWSFaction[xws.faction]\r\n\r\n                if @faction != xws_faction\r\n                        throw new Error(\"Attempted to load XWS for #{xws.faction} but builder is #{@faction}\")\r\n\r\n                if xws.name?\r\n                    @current_squad.name = xws.name\r\n                if xws.description?\r\n                    @notes.val xws.description\r\n\r\n                if xws.obstacles?\r\n                    @current_squad.additional_data.obstacles = xws.obstacles\r\n\r\n                @suppress_automatic_new_ship = true\r\n                @removeAllShips()\r\n\r\n                success = true\r\n                error = \"\"\r\n\r\n                # we use our current gamemode as default, but switch to standard if we are in BETA but the loaded xws specifies AMG or vice versa\r\n                if @isStandard then gamemode = 'h' else if @isEpic then gamemode = 'e' else if @isBeta then gamemode = 'b' else gamemode = 's'\r\n                if xws.ruleset? and xws.ruleset == 'BETA' then gamemode = 'b' else if xws.ruleset? and xws.ruleset == 'AMG' and gamemode == 'b' then gamemode = 'h'\r\n                serialized_squad = \"\"\r\n\r\n                for pilot in xws.pilots\r\n                    new_ship = @addShip()\r\n                    # we add some backward compatibility here, to allow imports from Launch Bay Next Squad Builder\r\n                    # According to xws-spec, for 2nd edition we use id instead of name\r\n                    # however, we will accept a name instead of an id as well.\r\n                    \r\n                    if pilot.id\r\n                        pilotxws = pilot.id\r\n                    else if pilot.name\r\n                        pilotxws = pilot.name\r\n                    else\r\n                        success = false\r\n                        error = \"Pilot without identifier\"\r\n                        break\r\n\r\n                    # add pilot id\r\n                    if exportObj.pilotsByFactionXWS[xws_faction][pilotxws]? \r\n                        serialized_squad +=  exportObj.pilotsByFactionXWS[xws_faction][pilotxws][0].id\r\n                    else if exportObj.pilotsByUniqueName[pilotxws] and exportObj.pilotsByUniqueName[pilotxws].length == 1\r\n                        serialized_squad +=  exportObj.pilotsByUniqueName[pilotxws][0].id\r\n                    \r\n                    else\r\n                        for key, possible_pilots of exportObj.pilotsByUniqueName\r\n                            for possible_pilot in possible_pilots\r\n                                if (possible_pilot.xws and possible_pilot.xws == pilotxws) or (not possible_pilot.xws and key == pilotxws)\r\n                                    serialized_squad += possible_pilot.id\r\n                                    break\r\n\r\n                    # game mode version check: pilot and ship\r\n                    if not exportObj.standardCheck(pilot, true) and gamemode == 'h'\r\n                        gamemode = 's'\r\n\r\n                    serialized_squad += \"X\"\r\n\r\n                    # add upgrade ids\r\n                    # Turn all the upgrades into a flat list so we can keep trying to add them\r\n                    addons = []\r\n                    for upgrade_type, upgrade_canonicals of pilot.upgrades ? {}\r\n                        for upgrade_canonical in upgrade_canonicals\r\n                            # console.log upgrade_type, upgrade_canonical\r\n                            slot = null\r\n                            slot = exportObj.fromXWSUpgrade[upgrade_type] ? upgrade_type.capitalize()\r\n                            if upgrade_canonical?\r\n                                upgrade = exportObj.upgradesBySlotXWSName[slot][upgrade_canonical] ?= exportObj.upgradesBySlotCanonicalName[slot][upgrade_canonical]\r\n                                if not upgrade?\r\n                                    console.log(\"Failed to load xws upgrade: \" + upgrade_canonical)\r\n                                    error += \"Skipped upgrade \" + upgrade_canonical\r\n                                    success = false\r\n                                    continue\r\n                                serialized_squad += upgrade.id\r\n                                serialized_squad += \"W\"\r\n                                if not exportObj.standardCheck(upgrade, true) and gamemode == 'h'\r\n                                    gamemode = 's'\r\n                    serialized_squad += \"XY\"\r\n\r\n                serialized_squad_intro = \"v9Z\" + gamemode + \"Z50Z\" # serialization v9, extended squad, 50 points\r\n                # serialization schema SHIPID:UPGRADEID,UPGRADEID,...,UPGRADEID:;SHIPID:UPGRADEID,...\r\n\r\n                serialized_squad = serialized_squad_intro + serialized_squad\r\n\r\n                afterLoad = () =>\r\n                    @current_squad.dirty = true\r\n                    @container.trigger 'xwing-backend:squadNameChanged'\r\n                    @container.trigger 'xwing-backend:squadDirtinessChanged'\r\n                    cb\r\n                        success: success\r\n                        error: error\r\n\r\n                @loadFromSerialized(serialized_squad, afterLoad)\r\n\r\n            else\r\n                success = false\r\n                error = \"Unsupported XWS version\"\r\n                cb success, error\r\n\r\n\r\n        cb\r\n            success: success\r\n            error: error\r\n\r\nclass Ship\r\n    constructor: (args) ->\r\n        # args\r\n        @builder = args.builder\r\n        @container = args.container\r\n\r\n        # internal state\r\n        @pilot = null\r\n        @data = null # ship data\r\n        @quickbuildId = -1\r\n        @linkedShip = null # some quickbuilds contain two ships, this variable may reference a Ship beeing part of the same quickbuild card\r\n        @primary = true # only the primary ship of a linked ship pair will contribute points and serialization id\r\n        @upgrades = []\r\n        @upgrade_points_total = 0\r\n        @wingmates = [] # stores wingmates (quickbuild stuff only) \r\n        @destroystate = 0\r\n        @uitranslation = @builder.uitranslation\r\n        @usesbetaSlots = false # flag if we use beta slots. This is needed, if we switch betwen BETA/AMG points to rebuild the pilot if the slots change\r\n\r\n        @setupUI()\r\n\r\n    destroy: (cb) ->\r\n        @resetPilot()\r\n        @resetAddons()\r\n        @teardownUI()\r\n        idx = @builder.ships.indexOf this\r\n        if idx < 0\r\n            throw new Error(\"Ship not registered with builder\")\r\n        @builder.ships.splice idx, 1\r\n        # remove all wingmates, if we are wingleader\r\n        if @wingmates.length > 0\r\n            @setWingmates(0)\r\n        # check if there is a linked ship\r\n        if @linkedShip != null\r\n            # remove us from the wing, if we are part of a wing\r\n            if @linkedShip.wingmates?.length > 0 and this in @linkedShip.wingmates\r\n                @linkedShip.removeFromWing(this)\r\n            # we are not part of a wing, so we just want to also remove the linked ship\r\n            else\r\n                # unlink us from the linked ship, so we are not in a infinite recursive trap (it will otherwise attempt to remove us)\r\n                @linkedShip.linkedShip = null\r\n                await new Promise((resolve,reject) =>@builder.removeShip @linkedShip, resolve)\r\n        cb()\r\n\r\n    copyFrom: (other) ->\r\n        throw new Error(\"Cannot copy from self\") if other is this\r\n        #console.log \"Attempt to copy #{other?.pilot?.name}\"\r\n        return unless other.pilot? and other.data?\r\n        #console.log \"Setting pilot to ID=#{other.pilot.id}\"\r\n        if @builder.isQuickbuild\r\n            # check if pilot is unique. In that case the whole ship may not be copied, but the cheapest alternative will be selected\r\n            no_uniques_involved = not @builder.isCardOverLimit(other.pilot,true)\r\n            if no_uniques_involved\r\n                # also check all upgrades\r\n                for upgrade in other.upgrades\r\n                    if @builder.isCardOverLimit(upgrade,false) or upgrade.data?.solitary?\r\n                        no_uniques_involved = false                \r\n            if no_uniques_involved\r\n                # still no uniques, so we can copy that ship as is\r\n                @setPilotById other.quickbuildId\r\n            else\r\n                # try to select another pilot for the same ship instead\r\n                available_pilots = (pilot_data for pilot_data in @builder.getAvailablePilotsForShipIncluding(other.data.name) when not pilot_data.disabled)\r\n                if available_pilots.length > 0\r\n                    @setPilotById available_pilots[0].id, true\r\n                else\r\n                    return\r\n        else \r\n            if @builder.isCardOverLimit(other.pilot,true)\r\n                # Look for cheapest generic or available unique, otherwise do nothing\r\n                available_pilots = (pilot_data for pilot_data in @builder.getAvailablePilotsForShipIncluding(other.data.name) when not pilot_data.disabled)\r\n                if available_pilots.length > 0\r\n                    await @setPilotById available_pilots[0].id, true\r\n\r\n                else\r\n                    return\r\n            else\r\n                await @setPilotById other.pilot.id, true\r\n\r\n            # filter out upgrades that can be copied\r\n            other_upgrades = {}\r\n            for upgrade in other.upgrades\r\n                if upgrade?.data? and not upgrade.isStandardized() and not upgrade.data.standard? and not @builder.isCardOverLimit(upgrade.data,false)\r\n                    other_upgrades[upgrade.slot] ?= []\r\n                    other_upgrades[upgrade.slot].push upgrade\r\n            # set them aside any upgrades that don't fill requirements due to additional slots and then attempt to fill them\r\n            delayed_upgrades = {}\r\n            for upgrade in @upgrades\r\n                if not upgrade.isOccupied() # an earlier set double-slot upgrade may already use this slot\r\n                    other_upgrade = (other_upgrades[upgrade.slot] ? []).shift()\r\n                    if other_upgrade?\r\n                        await upgrade.setById other_upgrade.data.id\r\n                        # it would be cool if upgrade.setById would return whether it succeeded (as promise), so we could attempt to add all\r\n                        # upgrades, wait for all promises to resolve, and then retry the rejected upgrades. Instead, we wait for each upgrade individually.\r\n                        if not upgrade.lastSetValid\r\n                            delayed_upgrades[other_upgrade.data.id] = upgrade\r\n            for id, upgrade of delayed_upgrades\r\n                upgrade.setById id\r\n            # Do one final pass on upgrades to see if there are any more upgrades we can assign\r\n            for upgrade in @upgrades\r\n                if not upgrade.isOccupied()\r\n                    other_upgrade = (other_upgrades[upgrade.slot] ? []).shift()\r\n                    if other_upgrade?\r\n                        upgrade.setById other_upgrade.data.id\r\n            \r\n            @addStandardizedUpgrades()\r\n        @updateSelections()\r\n        @builder.container.trigger 'xwing:pointsUpdated'\r\n        @builder.current_squad.dirty = true\r\n        @builder.container.trigger 'xwing-backend:squadDirtinessChanged'\r\n\r\n    setShipType: (ship_type) ->\r\n        @pilot_selector.data('select2').container.show()\r\n        if ship_type != @pilot?.ship\r\n            if not @builder.isQuickbuild\r\n                @setPilot (exportObj.pilotsById[result.id] for result in @builder.getAvailablePilotsForShipIncluding(ship_type) when ((not exportObj.pilotsById[result.id].restriction_func? or exportObj.pilotsById[result.id].restriction_func(@)) and not (exportObj.pilotsById[result.id] in @builder.uniques_in_use.Pilot)))[0]\r\n            else\r\n                # get the first available pilot\r\n                quickbuild_id = (result.id for result in @builder.getAvailablePilotsForShipIncluding(ship_type) when not result.disabled)[0]\r\n                @setPilotById quickbuild_id\r\n                \r\n        @checkPilotSelectorQueryModal()\r\n                \r\n        # Clear ship background class\r\n        for cls in @row.attr('class').split(/\\s+/)\r\n            if cls.indexOf('ship-') == 0\r\n                @row.removeClass cls\r\n\r\n        # Show delete button\r\n        @remove_button.fadeIn 'fast'\r\n        @copy_button.fadeIn 'fast'\r\n        if @builder.show_points_destroyed == true\r\n            @points_destroyed_button.fadeIn 'fast'\r\n\r\n        @row.addClass \"ship-#{ship_type.toLowerCase().replace(/[^a-z0-9]/gi, '')}\"\r\n\r\n        @builder.container.trigger 'xwing:shipUpdated'\r\n\r\n    setPilotById: (id, noautoequip = false) ->\r\n        #sets pilot of this ship according to given id. Id might be pilotId or quickbuildId depending on mode. \r\n        if not @builder.isQuickbuild\r\n            @setPilot exportObj.pilotsById[parseInt id], noautoequip\r\n        else\r\n            if id != @quickbuildId\r\n                @wingmate_selector.parent().hide()\r\n                if @wingmates? and @wingmates.length > 0\r\n                    # remove any wingmates, as the wing leader was just removed from the list\r\n                    @setWingmates(0)\r\n                    # @linkedShip = null the ghost hera has wingmates and a linked phantom. We can't assume that we are done here...\r\n                @quickbuildId = id\r\n                @builder.current_squad.dirty = true\r\n                await @resetPilot()\r\n                await @resetAddons()\r\n                if id? and id > -1\r\n                    quickbuild = exportObj.quickbuildsById[parseInt id]\r\n                    new_pilot = exportObj.pilots[quickbuild.pilot]\r\n                    @data = exportObj.ships[quickbuild.ship]\r\n                    @builder.isUpdatingPoints = true # prevents unneccesary validations while still adding stuff\r\n                    if new_pilot?.unique?\r\n                        await new Promise((resolve,reject) => @builder.container.trigger 'xwing:claimUnique', [ new_pilot, 'Pilot', resolve ])\r\n                    @pilot = new_pilot\r\n                    @setupAddons() if @pilot?\r\n                    @copy_button.show()\r\n                    @setShipType @pilot.ship\r\n\r\n                    # if this card contains more than one ship, make sure the other one is added as well\r\n                    if quickbuild.wingmate? && not @linkedShip?\r\n                        # try to join wingleader, if we have not been created by him\r\n                        for ship in @builder.ships\r\n                            if ship.quickbuildId == quickbuild.linkedId\r\n                                # found our leader. join him.\r\n                                ship.joinWing(this)\r\n                                @linkedShip = ship\r\n                                @primary = false\r\n                                @builder.isUpdatingPoints = false\r\n                                @builder.container.trigger 'xwing:pointsUpdated'\r\n                                @builder.container.trigger 'xwing-backend:squadDirtinessChanged'\r\n                                return # we are done.\r\n                    if @linkedShip\r\n                        # we are already linked to some other ship\r\n                        if quickbuild.linkedId? \r\n                            # we will stay linked to another ship, so just set the linked one to an new pilot es well\r\n                            @linkedShip.setPilotById quickbuild.linkedId\r\n                            @linkedShip.primary = false unless quickbuild.wingmate?\r\n                        else\r\n                            # take care of associated ship\r\n                            if @linkedShip.wingmates?.length > 0\r\n                                # we are no longer part of a wing\r\n                                @linkedShip.removeFromWing(this)\r\n                            else\r\n                                # we are no longer part of a linked pair, so the linked ship should be removed\r\n                                @linkedShip.linkedShip = null\r\n                                await new Promise((resolve,reject) => @builder.removeShip @linkedShip, resolve)\r\n                            @linkedShip = null\r\n                    else if quickbuild.linkedId?\r\n                        # we nare not already linked to another ship, but need one. Let's set one up\r\n                        @linkedShip = @builder.ships.slice(-1)[0]\r\n                        # during squad building there is an empty ship at the bottom, use that one and add a new empty one. \r\n                        # during squad loading there is no empty ship at the bottom, so we just create a new one and use it\r\n                        if @linkedShip.data != null\r\n                            @linkedShip = @builder.addShip()\r\n                        else \r\n                            @builder.addShip()\r\n                        @linkedShip.linkedShip = this\r\n                        @linkedShip.setPilotById quickbuild.linkedId\r\n                        # for pairs the first selected ship is master, so as we have been created first, we set the other ship to false\r\n                        # for wings the wingleader is always master, so we don't set the other ship to false, if we are just a wingmate\r\n                        @linkedShip.primary = false unless quickbuild.wingmate?\r\n                    @primary = !quickbuild.wingmate?\r\n                    if quickbuild?.wingleader? \r\n                        @wingmate_selector.parent().show()\r\n                        @wingmate_selector.val quickbuild.wingmates[0]\r\n                        @wingmate_selector.attr \"min\", quickbuild.wingmates[0]\r\n                        @wingmate_selector.attr \"max\", quickbuild.wingmates[quickbuild.wingmates.length - 1]\r\n                        @setWingmates quickbuild.wingmates[0]\r\n                    @builder.isUpdatingPoints = false\r\n                    @builder.container.trigger 'xwing:pointsUpdated'\r\n                else\r\n                    @copy_button.hide()\r\n                @row.removeClass('unsortable')\r\n                @builder.container.trigger 'xwing:pointsUpdated'\r\n                @builder.container.trigger 'xwing-backend:squadDirtinessChanged'\r\n\r\n    addStandardizedUpgrades: ->\r\n        if @hasFixedUpgrades\r\n            return # standard ships bypass\r\n        idx = @builder.standard_list['Ship'].indexOf @data?.name\r\n        if idx > -1\r\n            upgrade_to_be_equipped = @builder.standard_list['Upgrade'][idx]\r\n            restrictions = (if upgrade_to_be_equipped.restrictions then upgrade_to_be_equipped.restrictions else undefined)\r\n            # first check if we already have that upgrade equipped. No need to do anything if we do. \r\n            for upgrade in @upgrades\r\n                if upgrade.data?.name == upgrade_to_be_equipped.name\r\n                    return\r\n            # now look for empty slots that could be equipped\r\n            for upgrade in @upgrades\r\n                if exportObj.slotsMatching(upgrade.slot, @builder.standard_list['Upgrade'][idx].slot)\r\n                    if @restriction_check(restrictions,upgrade) and not upgrade.data?\r\n                        upgrade.setData upgrade_to_be_equipped\r\n                        return\r\n\r\n    addToStandardizedList: (upgrade_data) ->\r\n        # check first if standard combo exists and return if it does\r\n        idx = @builder.standard_list['Ship'].indexOf @data.name\r\n        if idx > -1\r\n            if @builder.standard_list['Upgrade'][idx]?.name == upgrade_data.name\r\n                return\r\n        @builder.standard_list['Upgrade'].push upgrade_data\r\n        @builder.standard_list['Ship'].push @data.name\r\n\r\n    removeStandardizedList: (upgrade_data) ->\r\n        # removes the ship upgrade combo from the stanard list array\r\n        idx = @builder.standard_list['Ship'].indexOf @data.name\r\n        if idx > -1\r\n            if @builder.standard_list['Upgrade'][idx]?.name == upgrade_data.name\r\n                @builder.standard_list['Upgrade'].splice idx,1 \r\n                @builder.standard_list['Ship'].splice idx,1\r\n                \r\n                # now remove all upgrades of the same name\r\n                for ship in @builder.ships\r\n                    if ship.data?.name == @data.name and ship != this\r\n                        for upgrade in ship.upgrades\r\n                            if upgrade.data?.name == upgrade_data.name\r\n                                upgrade.setData null\r\n                                break\r\n\r\n    checkStandardizedList: (ship_name) ->\r\n        # check first if standard combo exists and return if it does\r\n        idx = @builder.standard_list['Ship'].indexOf ship_name\r\n        if idx > -1\r\n            if @builder.standard_list['Upgrade'][idx]?.name?\r\n                return @builder.standard_list['Upgrade'][idx]\r\n        else\r\n            return undefined\r\n\r\n    setPilot: (new_pilot, noautoequip = false) ->\r\n        # don't call this method directly, unless you know what you do. Use setPilotById for proper quickbuild handling\r\n\r\n        if new_pilot != @pilot or (@builder.isBeta and not @usesbetaSlots and @pilot.slotsbeta?) or (@usesbetaSlots and not @builder.isBeta)\r\n            @builder.current_squad.dirty = true\r\n            same_ship = @pilot? and new_pilot?.ship == @pilot.ship\r\n            old_upgrades = {}\r\n            if same_ship and not @pilot.upgrades?\r\n                # track addons and try to reassign them\r\n                for upgrade in @upgrades\r\n                    if upgrade?.data?\r\n                        old_upgrades[upgrade.slot] ?= []\r\n                        old_upgrades[upgrade.slot].push upgrade.data.id\r\n            await @resetPilot()\r\n            await @resetAddons()\r\n            if new_pilot?\r\n                @data = exportObj.ships[new_pilot?.ship]\r\n                if new_pilot?.unique?\r\n                    await new Promise((resolve,reject) => @builder.container.trigger 'xwing:claimUnique', [ new_pilot, 'Pilot', resolve])\r\n                @pilot = new_pilot\r\n                @setupAddons() if @pilot?\r\n                @copy_button.show()\r\n                @setShipType @pilot.ship\r\n                if (@pilot.autoequip? or (exportObj.ships[@pilot.ship].autoequip? and not same_ship)) and not noautoequip\r\n                    autoequip = (@pilot.autoequip ? []).concat(exportObj.ships[@pilot.ship].autoequip ? [])\r\n                    for upgrade_name in autoequip\r\n                        auto_equip_upgrade = exportObj.upgrades[upgrade_name]\r\n                        for upgrade in @upgrades\r\n                            if exportObj.slotsMatching(upgrade.slot, auto_equip_upgrade.slot)\r\n                                upgrade.setData auto_equip_upgrade\r\n                if same_ship and not @pilot.upgrades?\r\n                    # two cycles, in case an old upgrade is adding slots that are required for other old upgrades\r\n                    for _ in [1..2]\r\n                        delayed_upgrades = {}\r\n                        for upgrade in @upgrades\r\n                            # check if there exits old upgrades for this slot - if so, try to add the first of them\r\n                            old_upgrade = (old_upgrades[upgrade.slot] ? []).shift()\r\n                            if old_upgrade?\r\n                                await upgrade.setById old_upgrade\r\n                                if not upgrade.lastSetValid\r\n                                    # failed to add an upgrade, even though the required slot was there - retry later\r\n                                    # perhaps another card is providing an required restriction (e.g. an action)\r\n                                    delayed_upgrades[old_upgrade] = upgrade\r\n                        for id, upgrade of delayed_upgrades\r\n                            upgrade.setById id\r\n                        # last check for standardized\r\n                    # see if ship is supposed to be standardized\r\n                    standard_upgrade_to_check = @checkStandardizedList(@pilot.ship)\r\n                    standard_check = false\r\n                    for upgrade in @upgrades\r\n                        if standard_upgrade_to_check? and (upgrade?.data?.name? and (upgrade.data.name == standard_upgrade_to_check.name))\r\n                            standard_check = true                         \r\n                    if standard_upgrade_to_check? and (standard_check == false)\r\n                        @removeStandardizedList(standard_upgrade_to_check)\r\n\r\n            else\r\n                @copy_button.hide()\r\n            @row.removeClass('unsortable')\r\n            @builder.container.trigger 'xwing:pointsUpdated'\r\n            @builder.container.trigger 'xwing-backend:squadDirtinessChanged'\r\n\r\n    resetPilot: ->\r\n        if @pilot?.unique?\r\n            await new Promise((resolve,reject) => @builder.container.trigger 'xwing:releaseUnique', [ @pilot, 'Pilot', resolve ])\r\n        @pilot = null\r\n\r\n    setupAddons: ->\r\n        if not @builder.isQuickbuild\r\n            if @pilot.upgrades?\r\n                @hasFixedUpgrades = true\r\n                @usesbetaSlots = false\r\n                for upgrade_name in @pilot.upgrades ? []\r\n                    upgrade_data = exportObj.upgrades[upgrade_name]\r\n                    if not upgrade_data?\r\n                        console.log(\"Unknown Upgrade: \" + upgrade_name)\r\n                        continue\r\n                    upgrade = new exportObj.QuickbuildUpgrade\r\n                        ship: this\r\n                        container: @addon_container\r\n                        slot: upgrade_data.slot\r\n                        upgrade: upgrade_data\r\n                    upgrade.setData upgrade_data\r\n                    @upgrades.push upgrade\r\n            else\r\n                @hasFixedUpgrades = false\r\n                if (@builder.isBeta and @pilot.slotsbeta?) \r\n                    pilotslots = @pilot.slotsbeta \r\n                    @usesbetaSlots = true\r\n                else \r\n                    @usesbetaSlots = false\r\n                    pilotslots = @pilot.slots\r\n\r\n                for slot in pilotslots ? []\r\n                    @upgrades.push new exportObj.Upgrade\r\n                        ship: this\r\n                        container: @addon_container\r\n                        slot: slot\r\n        else \r\n            # Upgrades from quickbuild\r\n            for upgrade_name in exportObj.quickbuildsById[@quickbuildId].upgrades ? []\r\n                upgrade_data = exportObj.upgrades[upgrade_name]\r\n                if not upgrade_data?\r\n                    console.log(\"Unknown Upgrade: \" + upgrade_name)\r\n                    continue\r\n                upgrade = new exportObj.QuickbuildUpgrade\r\n                    ship: this\r\n                    container: @addon_container\r\n                    slot: upgrade_data.slot\r\n                    upgrade: upgrade_data\r\n                upgrade.setData upgrade_data\r\n                @upgrades.push upgrade\r\n\r\n    resetAddons: ->\r\n        upgrades_destroyed = []\r\n        for upgrade in @upgrades\r\n                upgrades_destroyed.push(new Promise((resolve,reject) => upgrade.destroy resolve))  if upgrade?\r\n        Promise.all(upgrades_destroyed).then(@upgrades = [])\r\n\r\n\r\n    getPoints: ->\r\n        if not @builder.isQuickbuild\r\n            if @pilot?\r\n                effective_stats = @effectiveStats()\r\n                points = effective_stats?.points\r\n                loadout = effective_stats?.loadout\r\n\r\n            else\r\n                points = 0\r\n                loadout = 0\r\n            @points_container.find('div').text \"#{points}\"\r\n            @points_container.find('.upgrade-points').text if @pilot?.loadout? then \"(#{@upgrade_points_total}/#{loadout})\" else \"\"\r\n            if points > 0\r\n                @points_container.fadeTo 'fast', 1\r\n            else\r\n                @points_container.fadeTo 0, 0\r\n            points\r\n        else    \r\n            quickbuild = exportObj.quickbuildsById[@quickbuildId]\r\n            threat = if @primary then quickbuild?.threat ? 0 else 0 \r\n            if quickbuild?.wingleader?\r\n                threat = quickbuild.threat[quickbuild.wingmates.indexOf(@wingmates.length)]\r\n            @points_container.find('span').text threat\r\n            if threat > 0\r\n                @points_container.fadeTo 'fast', 1\r\n            else\r\n                @points_container.fadeTo 0, 0\r\n            threat\r\n\r\n    setWingmates: (wingmates) ->\r\n        # creates/destroys wingmates to match number given as argument\r\n        # todo: Check if number is valid for this quickbuild wing?\r\n        if @wingmates?.length == wingmates\r\n            # nothing to do, we already have correct number of wingmates. \r\n            return\r\n        if !@wingmates? || @wingmates.length == 0\r\n            # if no wingmates are set yet, create an empty list\r\n            @wingmates = []\r\n        quickbuild = exportObj.quickbuildsById[@quickbuildId]\r\n        while @wingmates.length < wingmates \r\n            # create more wingmates\r\n            newMate = @builder.ships.slice(-1)[0]\r\n            # during squad building there is an empty ship at the bottom, use that one and add a new empty one. \r\n            # during squad loading there is no empty ship at the bottom, so we just create a new one and use it\r\n            if newMate.data != null\r\n                newMate = @builder.addShip()\r\n            else \r\n                @builder.addShip()\r\n            newMate.linkedShip = this # link new mate to us\r\n            @wingmates.push(newMate)\r\n            newMate.setPilotById quickbuild.wingmateId\r\n            # for pairs the first selected ship is master, so as we have been created first, we set the other ship to false\r\n            # for wings the wingleader is always master, so we don't set the other ship to false, if we are just a wingmate\r\n            newMate.primary = false\r\n            @primary = true # he should not try to steal our primary position, as he is aware of beeing not squad leader, but in case he's not just set it. \r\n        while @wingmates.length > wingmates\r\n            # destroy wingmates\r\n            dyingMate = @wingmates.pop()\r\n            dyingMate.linkedShip = null # prevent the mate from killing us\r\n            await new Promise((resolve,reject) => @builder.removeShip dyingMate, resolve)\r\n        @wingmate_selector.val wingmates\r\n\r\n    removeFromWing: (ship) ->\r\n        # remove requested ship from wing\r\n        @wingmates.removeItem(ship)\r\n        # check if the wing is still valid, otherwise destroy it. \r\n        quickbuild = exportObj.quickbuildsById[@quickbuildId]\r\n        if !(@wingmates.length in quickbuild.wingmates)\r\n            @destroy $.noop\r\n        @wingmate_selector.val @wingmates.length\r\n\r\n    joinWing: (ship) ->\r\n        # remove requested ship from wing\r\n        @wingmates.push(ship)\r\n        # check if the wing is still valid, otherwise destroy the added ship\r\n        quickbuild = exportObj.quickbuildsById[@quickbuildId]\r\n        if !(@wingmates.length in quickbuild.wingmates)\r\n            ship.destroy $.noop\r\n            @removeFromWing(ship)\r\n        @wingmate_selector.val @wingmates.length\r\n\r\n\r\n    updateSelections: ->\r\n        if @pilot?\r\n            @ship_selector.select2 'data',\r\n                id: @pilot.ship\r\n                text: if exportObj.ships[@pilot.ship].display_name then exportObj.ships[@pilot.ship].display_name else @pilot.ship\r\n                chassis: if exportObj.ships[@pilot.ship].chassis then exportObj.ships[@pilot.ship].chassis else \"\"\r\n                xws: exportObj.ships[@pilot.ship].name.canonicalize()\r\n                icon: if exportObj.ships[@pilot.ship].icon then exportObj.ships[@pilot.ship].icon else exportObj.ships[@pilot.ship].name.canonicalize()\r\n            @pilot_selector.select2 'data',\r\n                id: @pilot.id\r\n                text: \"#{if exportObj.settings?.initiative_prefix? and exportObj.settings.initiative_prefix then @pilot.skill + ' - ' else ''}#{if @pilot.display_name then @pilot.display_name else @pilot.name}#{if @quickbuildId != -1 then exportObj.quickbuildsById[@quickbuildId].suffix else \"\"} (#{if @quickbuildId != -1 then (if @primary then exportObj.quickbuildsById[@quickbuildId].threat else 0) else (if (@builder.isBeta and @pilot.pointsbeta?) then @pilot.pointsbeta else @pilot.points)}#{if (@quickbuildId != -1 or not @pilot.loadout?) then \"\" else (if @builder.isBeta and @pilot.loadoutbeta? then \"/#{@pilot.loadoutbeta}\" else \"/#{@pilot.loadout}\")})\"\r\n                chassis: if @pilot.chassis? then @pilot.chassis else \"\"\r\n            @pilot_selector.data('select2').container.show()\r\n            for upgrade in @upgrades\r\n                points = upgrade.getPoints()\r\n                upgrade.updateSelection points\r\n        else\r\n            @pilot_selector.select2 'data', null\r\n            #@pilot_selector.data('select2').container.toggle(@ship_selector.val() != '')\r\n            \r\n    checkPilotSelectorQueryModal: ->    \r\n        if $(window).width() >= 768\r\n            @pilot_query_modal.hide()\r\n        else \r\n            if @pilot then @pilot_query_modal.show()\r\n\r\n    setupUI: ->\r\n        @row = $ document.createElement 'DIV'\r\n        @row.addClass 'row ship mb-5 mb-sm-0 unsortable'\r\n        @row.insertBefore @builder.notes_container\r\n\r\n        @row.append $.trim \"\"\"\r\n            <div class=\"col-md-3\">\r\n                <div class=\"form-group d-flex\">\r\n                    <input class=\"ship-selector-container\" type=\"hidden\"></input>\r\n                    <div class=\"d-block d-md-none input-group-append\">\r\n                        <button class=\"btn btn-secondary ship-query-modal\"><i class=\"fas fa-question\"></i></button>\r\n                    </div>\r\n                <br />\r\n                </div>\r\n                <div class=\"form-group d-flex\">\r\n                    <input type=\"hidden\" class=\"pilot-selector-container\"></input>\r\n                    <div class=\"d-block d-md-none input-group-append\">\r\n                        <button class=\"btn btn-secondary pilot-query-modal\"><i class=\"fas fa-question\"></i></button>\r\n                    <br />\r\n                    </div>\r\n                </div>\r\n                <label class=\"wingmate-label\">\r\n                #{@uitranslation(\"Wingmates\")}: \r\n                    <input type=\"number\" class=\"wingmate-selector\"></input>\r\n                </label>\r\n            </div>\r\n            <div class=\"col-md-1 points-display-container\">\r\n                 <div></div>\r\n                 <div class=\"upgrade-points\"></div>\r\n            </div>\r\n            <div class=\"col-md-6 addon-container\">  </div>\r\n            <div class=\"col-md-2 button-container\">\r\n                <button class=\"btn btn-danger remove-pilot side-button\"><span class=\"d-none d-sm-block\" data-toggle=\"tooltip\" title=\"#{@uitranslation(\"Remove Pilot\")}\"><i class=\"fa fa-times\"></i></span><span class=\"d-block d-sm-none\"> #{@uitranslation(\"Remove Pilot\")}</span></button>\r\n                <button class=\"btn btn-light copy-pilot side-button\"><span class=\"d-none d-sm-block\" data-toggle=\"tooltip\" title=\"#{@uitranslation(\"Clone Pilot\")}\"><i class=\"far fa-copy\"></i></span><span class=\"d-block d-sm-none\"> #{@uitranslation(\"Clone Pilot\")}</span></button>\r\n                <button class=\"btn btn-light points-destroyed side-button\" points-state\"><span class=\"d-none d-sm-block destroyed-type\" data-toggle=\"tooltip\" title=\"#{@uitranslation(\"Points Destroyed\")}\"><i class=\"fas fa-circle\"></i></i></span><span class=\"d-block d-sm-none destroyed-type-mobile\"> #{@uitranslation(\"Undamaged\")}</span></button>\r\n            </div>\r\n        \"\"\"\r\n        @row.find('.button-container span').tooltip()\r\n\r\n        @ship_selector = $ @row.find('input.ship-selector-container')\r\n        @pilot_selector = $ @row.find('input.pilot-selector-container')\r\n        @wingmate_selector = $ @row.find('input.wingmate-selector')\r\n        @ship_query_modal = $ @row.find('button.ship-query-modal')\r\n        @pilot_query_modal = $ @row.find('button.pilot-query-modal')\r\n        \r\n        \r\n        @ship_query_modal.click (e) =>\r\n            if @pilot\r\n                @builder.showTooltip 'Ship', exportObj.ships[@pilot.ship], null, @builder.mobile_tooltip_modal, true\r\n                @builder.mobile_tooltip_modal.modal 'show'\r\n                \r\n        @pilot_query_modal.click (e) =>\r\n            if @pilot\r\n                @builder.showTooltip 'Pilot', @pilot, (@ if @pilot), @builder.mobile_tooltip_modal, true\r\n                @builder.mobile_tooltip_modal.modal 'show'\r\n\r\n            \r\n        shipResultFormatter = (object, container, query) ->\r\n            return \"\"\"<i class=\"xwing-miniatures-ship xwing-miniatures-ship-#{object.icon}\"></i> #{object.text}\"\"\"\r\n\r\n        shipSelectionFormatter = (object, container) ->\r\n            return \"\"\"<i class=\"xwing-miniatures-ship xwing-miniatures-ship-#{object.icon}\"></i> #{object.text}\"\"\"\r\n            \r\n        @ship_selector.select2\r\n            width: '100%'\r\n            placeholder: exportObj.translate 'ui', 'shipSelectorPlaceholder'\r\n            query: (query) =>\r\n                data = {results: []}\r\n                data.results = @builder.getAvailableShipsMatching(query.term)\r\n                query.callback(data)\r\n            minimumResultsForSearch: if $.isMobile() then -1 else 0\r\n            formatResultCssClass: (obj) =>\r\n                if @builder.collection? and (@builder.collection.checks.collectioncheck == \"true\")\r\n                    not_in_collection = false\r\n                    if @pilot? and obj.id == exportObj.ships[@pilot.ship].id\r\n                        # Currently selected ship; mark as not in collection if it's neither\r\n                        # on the shelf nor on the table\r\n                        unless (@builder.collection.checkShelf('ship', obj.name) or @builder.collection.checkTable('pilot', obj.name))\r\n                            not_in_collection = true\r\n                    else\r\n                        # Not currently selected; check shelf only\r\n                        not_in_collection = not @builder.collection.checkShelf('ship', obj.name)\r\n                    if not_in_collection then 'select2-result-not-in-collection' else ''\r\n                else\r\n                    ''\r\n            formatResult: shipResultFormatter\r\n            formatSelection: shipResultFormatter\r\n\r\n        @ship_selector.on 'select2-focus', (e) =>\r\n            if $.isMobile()\r\n                $('.select2-container .select2-focusser').remove()\r\n                $('.select2-search input').prop('focus',false).removeClass('select2-focused')\r\n        @ship_selector.on 'change', (e) =>\r\n            @setShipType @ship_selector.val()\r\n        @ship_selector.data('select2').results.on 'mousemove-filtered', (e) =>\r\n            select2_data = $(e.target).closest('.select2-result').data 'select2-data'\r\n            @builder.showTooltip 'Ship', exportObj.ships[select2_data.id] if select2_data?.id?\r\n        @ship_selector.data('select2').container.on 'mouseover', (e) =>\r\n            @builder.showTooltip 'Ship', exportObj.ships[@pilot.ship] if @pilot\r\n\r\n        @pilot_selector.select2\r\n            width: '100%'\r\n            placeholder: exportObj.translate  'ui', 'pilotSelectorPlaceholder'\r\n            query: (query) =>\r\n                data = {results: []}\r\n                data.results = @builder.getAvailablePilotsForShipIncluding(@ship_selector.val(), (if not @builder.isQuickbuild then @pilot else @quickbuildId), query.term, true, @)\r\n                query.callback(data)\r\n            minimumResultsForSearch: if $.isMobile() then -1 else 0\r\n            formatResultCssClass: (obj) =>\r\n                if @builder.collection? and (@builder.collection.checks.collectioncheck == \"true\")\r\n                    not_in_collection = false\r\n                    name = \"\"\r\n                    if @builder.isQuickbuild\r\n                        name = exportObj.quickbuildsById[obj.id]?.pilot ? \"unknown pilot\"\r\n                    else\r\n                        name = obj.name\r\n                    if obj.id == @pilot?.id\r\n                        # Currently selected pilot; mark as not in collection if it's neither\r\n                        # on the shelf nor on the table\r\n                        unless (@builder.collection.checkShelf('pilot', name) or @builder.collection.checkTable('pilot', name))\r\n                            not_in_collection = true\r\n                    else\r\n                        # Not currently selected; check shelf only\r\n                        not_in_collection = not @builder.collection.checkShelf('pilot', name)\r\n                    if not_in_collection then 'select2-result-not-in-collection' else ''\r\n                else\r\n                    ''\r\n        @pilot_selector.on 'select2-focus', (e) =>\r\n            if $.isMobile()\r\n                $('.select2-container .select2-focusser').remove()\r\n                $('.select2-search input').prop('focus',false).removeClass('select2-focused')\r\n        @pilot_selector.on 'change', (e) =>\r\n            @setPilotById @pilot_selector.select2('val')\r\n            @builder.current_squad.dirty = true\r\n            @builder.container.trigger 'xwing-backend:squadDirtinessChanged'\r\n            @builder.backend_status.fadeOut 'slow'\r\n        @pilot_selector.data('select2').results.on 'mousemove-filtered', (e) =>\r\n            select2_data = $(e.target).closest('.select2-result').data 'select2-data'\r\n            if @builder.isQuickbuild\r\n                @builder.showTooltip 'Quickbuild', exportObj.quickbuildsById[select2_data.id], {ship: @data?.name} if select2_data?.id?\r\n            else\r\n                @builder.showTooltip 'Pilot', exportObj.pilotsById[select2_data.id] if select2_data?.id?\r\n        @pilot_selector.data('select2').container.on 'mouseover', (e) =>\r\n            @builder.showTooltip 'Pilot', @pilot, @ if @pilot\r\n\r\n        @pilot_selector.data('select2').container.hide()\r\n\r\n        if @builder.isQuickbuild\r\n            @wingmate_selector.on 'change', (e) =>\r\n                @setWingmates parseInt @wingmate_selector.val()\r\n                @builder.current_squad.dirty = true\r\n                @builder.container.trigger 'xwing-backend:squadDirtinessChanged'\r\n                @builder.backend_status.fadeOut 'slow'\r\n            @wingmate_selector.on 'mousemove-filtered', (e) =>\r\n                return\r\n                # TODO: show tooltip of wingmate\r\n            #    select2_data = $(e.target).closest('.select2-result').data 'select2-data'\r\n            #    if @builder.isQuickbuild\r\n            #        @builder.showTooltip 'Quickbuild', exportObj.quickbuildsById[select2_data.id], {ship: @data?.name} if select2_data?.id?\r\n            #    else\r\n            #        @builder.showTooltip 'Pilot', exportObj.wingmatesById[select2_data.id] if select2_data?.id?\r\n            #@wingmate_selector.on 'mouseover', (e) =>\r\n            #    @builder.showTooltip 'Pilot', @wingmate, @ if @wingmate\r\n    \r\n        @wingmate_selector.parent().hide()\r\n\r\n        @points_container = $ @row.find('.points-display-container')\r\n        @points_container.fadeTo 0, 0\r\n\r\n        @addon_container = $ @row.find('div.addon-container')\r\n\r\n        @remove_button = $ @row.find('button.remove-pilot')\r\n        @remove_button.click (e) =>\r\n            e.preventDefault()\r\n            @row.slideUp 'fast', () =>\r\n                @builder.removeShip this\r\n                @backend_status?.fadeOut 'slow'\r\n        @remove_button.hide()\r\n\r\n        @copy_button = $ @row.find('button.copy-pilot')\r\n        @copy_button.click (e) =>\r\n            for ship in @builder.ships\r\n                if ship.row.hasClass(\"unsortable\")\r\n                    ship.copyFrom(this)\r\n                    break\r\n                \r\n        @copy_button.hide()\r\n\r\n        @checkPilotSelectorQueryModal()\r\n        \r\n        @points_destroyed_button_span = $ @row.find('.destroyed-type')\r\n        @points_destroyed_button_span_mobile = $ @row.find('.destroyed-type-mobile')\r\n\r\n        @points_destroyed_button = $ @row.find('button.points-destroyed')\r\n        @points_destroyed_button.click (e) =>\r\n            switch @destroystate\r\n                when 0\r\n                    @destroystate++\r\n                    @points_destroyed_button.addClass \"btn-warning\"\r\n                    @points_destroyed_button.removeClass \"btn-light\"\r\n                    @points_destroyed_button_span_mobile.text @uitranslation(\"Half Damaged\")\r\n                    @points_destroyed_button_span.html '<i class=\"fas fa-adjust\"></i>'\r\n                when 1\r\n                    @destroystate++\r\n                    @points_destroyed_button.addClass \"btn-danger\"\r\n                    @points_destroyed_button.removeClass \"btn-warning\"\r\n                    @points_destroyed_button_span_mobile.text @uitranslation(\"Fully Destroyed\")\r\n                    @points_destroyed_button_span.html '<i class=\"far fa-circle\"></i>'\r\n                when 2\r\n                    @destroystate = 0\r\n                    @points_destroyed_button.addClass \"btn-light\"\r\n                    @points_destroyed_button.removeClass \"btn-danger\"\r\n                    @points_destroyed_button_span_mobile.text @uitranslation(\"Undamaged\")\r\n                    @points_destroyed_button_span.html '<i class=\"fas fa-circle\"></i>'\r\n\r\n\r\n            @builder.container.trigger 'xwing:pointsUpdated'\r\n        @points_destroyed_button.hide()\r\n    \r\n    teardownUI: ->\r\n        @row.text ''\r\n        @row.remove()\r\n\r\n    toString: ->\r\n        if @pilot?\r\n            @uitranslation(\"PilotFlyingShip\", (if @pilot.display_name then @pilot.display_name else @pilot.name), (if @data.display_name then @data.display_name else @data.name))\r\n        else\r\n            if @data.display_name then @data.display_name else @data.name\r\n\r\n    toHTML: ->\r\n        effective_stats = @effectiveStats()\r\n        action_bar = @builder.formatActions(effective_stats.actions,\"<div class=\\\"action-separator\\\">&nbsp;&vert;&nbsp;</div>\", @pilot.keyword ? [])\r\n\r\n        attack_icon = @data.attack_icon ? 'xwing-miniatures-font-frontarc'\r\n\r\n        engagementHTML = if (@pilot.engagement?) then $.trim \"\"\"\r\n            <span class=\"info-data info-skill\">ENG #{@pilot.engagement}</span>\r\n        \"\"\" else ''\r\n            \r\n        attackHTML = if (effective_stats.attack?) then $.trim \"\"\"\r\n            <i class=\"xwing-miniatures-font header-attack #{attack_icon}\"></i>\r\n            <span class=\"info-data info-attack\">#{statAndEffectiveStat((@pilot.ship_override?.attack ? @data.attack), effective_stats, 'attack')}</span>\r\n        \"\"\" else ''\r\n        \r\n        if effective_stats.attackbull?\r\n            attackbullHTML = $.trim \"\"\"<i class=\"xwing-miniatures-font header-attack xwing-miniatures-font-bullseyearc\"></i>\r\n            <span class=\"info-data info-attack\">#{statAndEffectiveStat((@pilot.ship_override?.attackbull ? @data.attackbull), effective_stats, 'attackbull')}</span>\"\"\" \r\n        else\r\n            attackbullHTML = ''\r\n            \r\n        if effective_stats.attackb?\r\n            attackbHTML = $.trim \"\"\"<i class=\"xwing-miniatures-font header-attack xwing-miniatures-font-reararc\"></i>\r\n            <span class=\"info-data info-attack\">#{statAndEffectiveStat((@pilot.ship_override?.attackb ? @data.attackb), effective_stats, 'attackb')}</span>\"\"\" \r\n        else\r\n            attackbHTML = ''\r\n\r\n        if effective_stats.attackf?\r\n            attackfHTML = $.trim \"\"\"<i class=\"xwing-miniatures-font header-attack xwing-miniatures-font-fullfrontarc\"></i>\r\n            <span class=\"info-data info-attack\">#{statAndEffectiveStat((@pilot.ship_override?.attackf ? @data.attackf), effective_stats, 'attackf')}</span>\"\"\" \r\n        else\r\n            attackfHTML = ''\r\n            \r\n        if effective_stats.attackt?\r\n            attacktHTML = $.trim \"\"\"<i class=\"xwing-miniatures-font header-attack xwing-miniatures-font-singleturretarc\"></i>\r\n            <span class=\"info-data info-attack\">#{statAndEffectiveStat((@pilot.ship_override?.attackt ? @data.attackt), effective_stats, 'attackt')}</span>\"\"\" \r\n        else\r\n            attacktHTML = ''\r\n            \r\n        if effective_stats.attackl?\r\n            attacklHTML = $.trim \"\"\"<i class=\"xwing-miniatures-font header-attack xwing-miniatures-font-leftarc\"></i>\r\n            <span class=\"info-data info-attack\">#{statAndEffectiveStat((@pilot.ship_override?.attackl ? @data.attackl), effective_stats, 'attackl')}</span>\"\"\" \r\n        else\r\n            attacklHTML = ''\r\n            \r\n        if effective_stats.attackr?\r\n            attackrHTML = $.trim \"\"\"<i class=\"xwing-miniatures-font header-attack xwing-miniatures-font-rightarc\"></i>\r\n            <span class=\"info-data info-attack\">#{statAndEffectiveStat((@pilot.ship_override?.attackr ? @data.attackr), effective_stats, 'attackr')}</span>\"\"\" \r\n        else\r\n            attackrHTML = ''\r\n            \r\n        if effective_stats.attackdt?\r\n            attackdtHTML = $.trim \"\"\"<i class=\"xwing-miniatures-font header-attack xwing-miniatures-font-doubleturretarc\"></i>\r\n            <span class=\"info-data info-attack\">#{statAndEffectiveStat((@pilot.ship_override?.attackdt ? @data.attackdt), effective_stats, 'attackdt')}</span>\"\"\" \r\n        else\r\n            attackdtHTML = ''\r\n\r\n        \r\n        recurringicon = ''\r\n        if @data.energyrecurr?\r\n            count = 0\r\n            while count < @data.energyrecurr\r\n                recurringicon += '<sup><i class=\"fas fa-caret-up\"></i></sup>'\r\n                ++count\r\n        \r\n        energyHTML = if (@pilot.ship_override?.energy? or @data.energy?) then $.trim \"\"\"\r\n            <i class=\"xwing-miniatures-font header-energy xwing-miniatures-font-energy\"></i>\r\n            <span class=\"info-data info-energy\">#{statAndEffectiveStat((@pilot.ship_override?.energy ? @data.energy), effective_stats, 'energy')}#{recurringicon}</span>\r\n        \"\"\" else ''\r\n        \r\n\r\n        if effective_stats.force?\r\n            recurringicon = ''\r\n            if effective_stats.forcerecurring?\r\n                count = 0\r\n                while count < effective_stats.forcerecurring \r\n                    recurringicon += '<sup><i class=\"fas fa-caret-up\"></i></sup>'\r\n                    ++count\r\n            else\r\n                recurringicon += '<sup><i class=\"fas fa-caret-up\"></i></sup>'\r\n        forceHTML = if (effective_stats.force? and effective_stats.force > 0) then $.trim \"\"\"\r\n            <i class=\"xwing-miniatures-font header-force xwing-miniatures-font-forcecharge\"></i>\r\n            <span class=\"info-data info-force\">#{statAndEffectiveStat((@pilot.ship_override?.force ? @pilot.force ? 0), effective_stats, 'force')}#{recurringicon}</span>\r\n        \"\"\" else ''\r\n\r\n        if @pilot.charge?\r\n            recurringicon = ''\r\n            if @pilot.recurring?\r\n                if @pilot.recurring > 0\r\n                    count = 0\r\n                    while count < @pilot.recurring\r\n                        recurringicon += '<sup><i class=\"fas fa-caret-up\"></i></sup>'\r\n                        ++count\r\n                else\r\n                    count = @pilot.recurring\r\n                    while count < 0\r\n                        recurringicon += '<sub><i class=\"fas fa-caret-down\"></i></sub>'\r\n                        ++count\r\n            chargeHTML = $.trim \"\"\"<i class=\"xwing-miniatures-font header-charge xwing-miniatures-font-charge\"></i><span class=\"info-data info-charge\">#{statAndEffectiveStat((@pilot.ship_override?.charge ? @pilot.charge), effective_stats, 'charge')}#{recurringicon}</span>\"\"\"\r\n        else \r\n            chargeHTML = ''\r\n\r\n        shieldRECUR = ''\r\n        if @data.shieldrecurr?\r\n            count = 0\r\n            while count < @data.shieldrecurr\r\n                shieldRECUR += \"\"\"<sup><i class=\"fas fa-caret-up\"></i></sup>\"\"\"\r\n                ++count\r\n            \r\n        shieldIconHTML = ''\r\n        if effective_stats.shields\r\n            for _ in [effective_stats.shields..2] by -1\r\n                shieldIconHTML += \"\"\"<i class=\"xwing-miniatures-font header-shield xwing-miniatures-font-shield expanded-hull-or-shield\"></i>\"\"\"\r\n            shieldIconHTML += \"\"\"<i class=\"xwing-miniatures-font header-shield xwing-miniatures-font-shield\"></i>\"\"\"\r\n\r\n        hullIconHTML = ''\r\n        if effective_stats.hull\r\n            for _ in [effective_stats.hull..2] by -1\r\n                hullIconHTML += \"\"\"<i class=\"xwing-miniatures-font header-hull xwing-miniatures-font-hull expanded-hull-or-shield\"></i>\"\"\"\r\n            hullIconHTML += \"\"\"<i class=\"xwing-miniatures-font header-hull xwing-miniatures-font-hull\"></i>\"\"\"\r\n\r\n        shieldHTML = if (effective_stats.shields? and effective_stats.shields > 0) then $.trim \"\"\"\r\n            <span class=\"info-data info-shields\">#{statAndEffectiveStat((@pilot.ship_override?.shields ? @data.shields), effective_stats, 'shields')}#{shieldRECUR}</span>\r\n        \"\"\" else ''\r\n\r\n        html = $.trim \"\"\"\r\n            <div class=\"fancy-pilot-header\">\r\n                <div class=\"pilot-header-text\">#{if @pilot.display_name then @pilot.display_name else @pilot.name} <i class=\"xwing-miniatures-ship xwing-miniatures-ship-#{@data.name.canonicalize()}\"></i><span class=\"fancy-ship-type\"> #{if @data.display_name then @data.display_name else @data.name}</span></div>\r\n                <div class=\"mask\">\r\n                    <div class=\"outer-circle\">\r\n                        <div class=\"inner-circle pilot-points\">#{if @quickbuildId != -1 then (if @primary then @getPoints() else '*') else (if (@builder.isBeta and @pilot.pointsbeta?) then @pilot.pointsbeta else @pilot.points)}</div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"fancy-pilot-stats\">\r\n                <div class=\"pilot-stats-content\">\r\n                    <span class=\"info-data info-skill\">INI #{statAndEffectiveStat(@pilot.skill, effective_stats, 'skill')}</span>\r\n                    #{engagementHTML}\r\n                    #{attackbullHTML}\r\n                    #{attackHTML}\r\n                    #{attackbHTML}\r\n                    #{attackfHTML}\r\n                    #{attacktHTML}\r\n                    #{attacklHTML}\r\n                    #{attackrHTML}\r\n                    #{attackdtHTML}\r\n                    <i class=\"xwing-miniatures-font header-agility xwing-miniatures-font-agility\"></i>\r\n                    <span class=\"info-data info-agility\">#{statAndEffectiveStat((@pilot.ship_override?.agility ? @data.agility), effective_stats, 'agility')}</span>                    \r\n                    #{hullIconHTML}\r\n                    <span class=\"info-data info-hull\">#{statAndEffectiveStat((@pilot.ship_override?.hull ? @data.hull), effective_stats, 'hull')}</span>\r\n                    #{shieldIconHTML}\r\n                    #{shieldHTML}\r\n                    #{energyHTML}\r\n                    #{forceHTML}\r\n                    #{chargeHTML}\r\n                    <br />\r\n                    <div class=\"action-bar\">\r\n                        #{action_bar}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        \"\"\"\r\n        \r\n        \r\n        if @pilot.text\r\n            html += $.trim \"\"\"\r\n                <div class=\"fancy-pilot-text\">#{@pilot.text}</div>\r\n            \"\"\"\r\n        if effective_stats?.chassis? and (effective_stats.chassis != \"\")\r\n            chassis_title = effective_stats.chassis\r\n        else if @data.chassis? \r\n            chassis_title = @data.chassis\r\n        else\r\n            chassis_title = \"\"\r\n        if chassis_title != \"\"\r\n            html += $.trim \"\"\"\r\n                <div class=\"fancy-pilot-chassis\"><strong>#{exportObj.chassis[chassis_title]?.display_name ? chassis_title}:</strong> #{exportObj.chassis[chassis_title].text}</div>\r\n            \"\"\"\r\n\r\n        slotted_upgrades = (upgrade for upgrade in @upgrades when upgrade.data?)\r\n\r\n        if slotted_upgrades.length > 0\r\n            html += $.trim \"\"\"\r\n                <div class=\"fancy-upgrade-container\">\r\n            \"\"\"\r\n\r\n            for upgrade in slotted_upgrades\r\n                points = upgrade.getPoints()\r\n                html += upgrade.toHTML points\r\n\r\n            html += $.trim \"\"\"\r\n                </div>\r\n            \"\"\"\r\n        \r\n        HalfPoints = Math.floor @getPoints() / 2\r\n        \r\n\r\n        Threshold = Math.floor (effective_stats['hull'] + effective_stats['shields']) / 2\r\n        \r\n        html += $.trim \"\"\"\r\n            <div class=\"ship-points-total\">\r\n                <strong>#{@uitranslation(\"Ship Cost\")}: #{@getPoints()}, #{@uitranslation(\"Loadout\")}: (#{@upgrade_points_total}#{if (@builder.isBeta and @pilot.loadoutbeta?) then \"/#{@pilot.loadoutbeta}\" else (if @pilot.loadout? then \"/#{@pilot.loadout}\" else \"\")}), #{@uitranslation(\"Half Points\")}: #{HalfPoints}, #{@uitranslation(\"Damage Threshold\")}: #{Threshold}</strong> \r\n            </div>\r\n        \"\"\"\r\n\r\n        \"\"\"<div class=\"fancy-ship\">#{html}</div>\"\"\"\r\n\r\n    toTableRow: ->\r\n        table_html = $.trim \"\"\"\r\n            <tr class=\"simple-pilot\">\r\n                <td class=\"name\">#{if @pilot.display_name then @pilot.display_name else @pilot.name} &mdash; #{if @data.display_name then @data.display_name else @data.name}</td>\r\n                <td class=\"points\">#{if @quickbuildId != -1 then (if @primary then exportObj.quickbuildsById[@quickbuildId].threat else 0) else (if (@builder.isBeta and @pilot.pointsbeta?) then @pilot.pointsbeta else @pilot.points)}</td>\r\n            </tr>\r\n        \"\"\"\r\n\r\n        slotted_upgrades = (upgrade for upgrade in @upgrades when upgrade.data?)\r\n        if slotted_upgrades.length > 0\r\n            for upgrade in slotted_upgrades\r\n                points = upgrade.getPoints()\r\n                table_html += upgrade.toTableRow points\r\n\r\n        table_html += \"\"\"<tr class=\"simple-ship-total\"><td colspan=\"2\">#{@uitranslation(\"Ship Cost\")}: #{@getPoints()}</td></tr>\"\"\"\r\n        \r\n        halfPoints = Math.floor @getPoints() / 2        \r\n        threshold = Math.floor (@effectiveStats()['hull'] + @effectiveStats()['shields']) / 2\r\n\r\n        table_html += \"\"\"<tr class=\"simple-ship-half-points\"><td colspan=\"2\">#{@uitranslation(\"Loadout\")}: (#{@upgrade_points_total}#{if (@builder.isBeta and @pilot.loadoutbeta?) then \"/#{@pilot.loadoutbeta}\" else (if @pilot.loadout? then \"/#{@pilot.loadout}\" else \"\")}) #{@uitranslation(\"Half Points\")}: #{halfPoints} #{@uitranslation(\"Damage Threshold\")}: #{threshold}</td></tr>\"\"\"\r\n\r\n        table_html += '<tr><td>&nbsp;</td><td></td></tr>'\r\n        table_html\r\n\r\n    toSimpleCopy: ->\r\n        simplecopy = \"\"\"#{@pilot.display_name} – #{@data.display_name} (#{if @quickbuildId != -1 then (if @primary then exportObj.quickbuildsById[@quickbuildId].threat else 0) else (if (@builder.isBeta and @pilot.pointsbeta?) then @pilot.pointsbeta else @pilot.points)})    \\n\"\"\"\r\n        slotted_upgrades = (upgrade for upgrade in @upgrades when upgrade.data?)\r\n        if slotted_upgrades.length > 0\r\n            simplecopy +=\"    \"\r\n            simplecopy_upgrades= []\r\n            for upgrade in slotted_upgrades\r\n                points = upgrade.getPoints()\r\n                upgrade_simplecopy = upgrade.toSimpleCopy points\r\n                simplecopy_upgrades.push upgrade_simplecopy if upgrade_simplecopy?\r\n            simplecopy += simplecopy_upgrades.join \"    \"\r\n            simplecopy += \"\"\"    \\n\"\"\"\r\n\r\n        halfPoints = Math.floor @getPoints() / 2        \r\n        threshold = Math.floor (@effectiveStats()['hull'] + @effectiveStats()['shields']) / 2\r\n\r\n        simplecopy += \"\"\"#{@uitranslation(\"Ship Cost\")}: #{@getPoints()}  #{@uitranslation(\"Loadout\")}: (#{@upgrade_points_total}#{if (@builder.isBeta and @pilot.loadoutbeta?) then \"/#{@pilot.loadoutbeta}\" else (if @pilot.loadout? then \"/#{@pilot.loadout}\" else \"\")})  #{@uitranslation(\"Half Points\")}: #{halfPoints}  #{@uitranslation(\"Damage Threshold\")}: #{threshold}    \\n    \\n\"\"\"\r\n\r\n        simplecopy\r\n        \r\n        \r\n    toRedditText: ->\r\n        reddit = \"\"\"**#{@pilot.name} (#{if @quickbuildId != -1 then (if @primary then exportObj.quickbuildsById[@quickbuildId].threat else 0) else (if (@builder.isBeta and @pilot.pointsbeta?) then @pilot.pointsbeta else @pilot.points)})**    \\n\"\"\"\r\n        slotted_upgrades = (upgrade for upgrade in @upgrades when upgrade.data?)\r\n        if slotted_upgrades.length > 0\r\n            halfPoints = Math.floor @getPoints() / 2\r\n            threshold = Math.floor (@effectiveStats()['hull'] + @effectiveStats()['shields']) / 2\r\n            reddit +=\"    \"\r\n            reddit_upgrades= []\r\n            for upgrade in slotted_upgrades\r\n                points = upgrade.getPoints()\r\n                upgrade_reddit = upgrade.toRedditText points\r\n                reddit_upgrades.push upgrade_reddit if upgrade_reddit?\r\n            reddit += reddit_upgrades.join \"    \"\r\n            reddit += \"\"\"&nbsp;*#{@uitranslation(\"Ship Cost\")}: #{@getPoints()}  #{@uitranslation(\"Loadout\")}: (#{@upgrade_points_total}#{if (@builder.isBeta and @pilot.loadoutbeta?) then \"/#{@pilot.loadoutbeta}\" else (if @pilot.loadout? then \"/#{@pilot.loadout}\" else \"\")})  #{@uitranslation(\"Half Points\")}: #{halfPoints}  #{@uitranslation(\"Damage Threshold\")}: #{threshold}*    \\n\"\"\"\r\n            \r\n        reddit\r\n\r\n    toTTSText: ->\r\n        tts = \"\"\"#{exportObj.toTTS(@pilot.name)}\"\"\"\r\n        slotted_upgrades = (upgrade for upgrade in @upgrades when upgrade.data?)\r\n        if slotted_upgrades.length > 0 and not @pilot.upgrades?\r\n            for upgrade in slotted_upgrades\r\n                upgrade_tts = upgrade.toTTSText()\r\n                tts += (\" + \" + upgrade_tts) if upgrade_tts?\r\n        tts += \" / \"\r\n\r\n    toSerialized: ->\r\n        # PILOT_ID:UPGRADEID1,UPGRADEID2:CONFERREDADDONTYPE1.CONFERREDADDONID1,CONFERREDADDONTYPE2.CONFERREDADDONID2\r\n        if @builder.isQuickbuild\r\n            if (!@wingmates? || @wingmates.length == 0) then \"\"\"#{@quickbuildId}X\"\"\" else \"\"\"#{@quickbuildId}X#{@wingmates.length}\"\"\"\r\n        else\r\n            upgrades = \"\"\"#{upgrade?.data?.id ? \"\" for upgrade, i in @upgrades}\"\"\".replace(/,/g, \"W\")\r\n            [\r\n                @pilot.id,\r\n                upgrades,\r\n            ].join 'X'\r\n\r\n\r\n    fromSerialized: (version, serialized) ->\r\n    # adds a ship from the given serialized data to the squad. \r\n    # returns true, if all upgrades have been added successfully, false otherwise\r\n    # returning false does not necessary mean nothing has been added, but some stuff might have been dropped (e.g. 0-0-0 if vader is not yet in the squad)\r\n        everythingadded = true\r\n        switch version\r\n            when 1, 2, 3, 4, 5, 6, 7, 8\r\n                # v 1-3 are 1st Ed\r\n                # v 4-8 are 2nd Ed \r\n                # v 9+ are 2.5 Ed \r\n                # v 10 are XWA 50 points structure\r\n                console.log \"Incorrect Version!\"\r\n                @old_version_container.toggleClass 'd-none', false\r\n\r\n            when 9, 10\r\n                pilot_splitter = 'X'\r\n                upgrade_splitter = 'W'\r\n                [ pilot_id, upgrade_ids, conferredaddon_pairs ] = serialized.split pilot_splitter\r\n                upgrade_ids = upgrade_ids.split upgrade_splitter\r\n                # set the pilot\r\n                await @setPilotById parseInt(pilot_id), true\r\n                # make sure the pilot is valid \r\n                return false unless @validate\r\n                \r\n                if !@builder.isQuickbuild\r\n                    # iterate over upgrades to be added, and remove all that have been successfully added\r\n                    for _ in [1 ... 3] # try adding each upgrade a few times, as the required slots might be added in by titles etc and are not yet available on the first try\r\n                        `upgradeloop: //` \r\n                        for i in [upgrade_ids.length - 1 ... -1]\r\n                            upgrade_id = upgrade_ids[i]\r\n                            upgrade = exportObj.upgradesById[upgrade_id]\r\n                            if not upgrade? \r\n                                upgrade_ids.splice(i,1) # Remove unknown or empty ID\r\n                                if upgrade_id != \"\"\r\n                                    console.log(\"Unknown upgrade id \" + upgrade_id + \" could not be added. Please report that error\")\r\n                                    everythingadded = false\r\n                                continue\r\n                            for upgrade_selection in @upgrades\r\n                                if upgrade_selection?.data?.name == upgrade.name\r\n                                    # for some reason the correct upgrade already was equipped (e.g. an earlier ship alread had a standardized that was added on creation here)\r\n                                    upgrade_ids.splice(i,1) # was already added successfully, remove from list\r\n                                    `continue upgradeloop`\r\n\r\n                            for upgrade_selection in @upgrades\r\n                                if exportObj.slotsMatching(upgrade.slot, upgrade_selection.slot) and not upgrade_selection.isOccupied()\r\n                                    await upgrade_selection.setById upgrade_id\r\n                                    if upgrade_selection.lastSetValid\r\n                                        upgrade_ids.splice(i,1) # added successfully, remove from list\r\n                                    break\r\n                else \r\n                    # we are in quickbuild. Number of wingmates might be provided as upgrade ID of a quickbuild\r\n                    if upgrade_ids.length > 0 && @wingmates.length > 0 # check if we are actually a wingleader\r\n                        @setWingmates(upgrade_ids[0])\r\n                everythingadded &= upgrade_ids.length == 0\r\n                          \r\n        @updateSelections()\r\n        everythingadded\r\n\r\n    effectiveStats: ->\r\n        stats =\r\n            attack: @pilot.ship_override?.attack ? @data.attack\r\n            attackf: @pilot.ship_override?.attackf ? @data.attackf\r\n            attackbull: @pilot.ship_override?.attackbull ? @data.attackbull\r\n            attackb: @pilot.ship_override?.attackb ? @data.attackb\r\n            attackt: @pilot.ship_override?.attackt ? @data.attackt\r\n            attackl: @pilot.ship_override?.attackl ? @data.attackl\r\n            attackr: @pilot.ship_override?.attackr ? @data.attackr\r\n            attackdt: @pilot.ship_override?.attackdt ? @data.attackdt\r\n            energy: @pilot.ship_override?.energy ? @data.energy\r\n            agility: @pilot.ship_override?.agility ? @data.agility\r\n            hull: @pilot.ship_override?.hull ? @data.hull\r\n            shields: @pilot.ship_override?.shields ? @data.shields\r\n            force: (@pilot.ship_override?.force ? @pilot.force) ? 0\r\n            forcerecurring: @pilot.forcerecurring ? 1\r\n            charge: @pilot.ship_override?.charge ? @pilot.charge\r\n            actions: (@pilot.ship_override?.actions ? @data.actions).slice 0\r\n            chassis: @pilot.chassis ? @data.chassis ? \"\"\r\n            points: @pilot.points ? 0\r\n            loadout: @pilot.loadout ? 0\r\n            skill: @pilot.skill ? 0\r\n\r\n        # override when in BETA mode\r\n        if @builder.isBeta\r\n            if @pilot.pointsbeta? then stats.points = @pilot.pointsbeta\r\n            if @pilot.loadoutbeta? then stats.loadout = @pilot.loadoutbeta\r\n\r\n        # need a deep copy of maneuvers array\r\n        maneuvers_override = @pilot.ship_override?.maneuvers ? @data.maneuvers\r\n        stats.maneuvers = []\r\n        for s in [0 ... (maneuvers_override ? []).length]\r\n            stats.maneuvers[s] = maneuvers_override[s].slice 0\r\n\r\n        # Droid conversion of Focus to Calculate\r\n        if @pilot.keyword? and (\"Droid\" in @pilot.keyword) and stats.actions?\r\n            new_stats = []\r\n            for statentry in stats.actions\r\n                new_stats.push statentry.replace(\"Focus\",\"Calculate\")\r\n            stats.actions = new_stats\r\n\r\n        for upgrade in @upgrades\r\n            if upgrade?.data?.chassis? then stats.chassis = upgrade.data.chassis\r\n            upgrade.data.modifier_func(stats) if upgrade?.data?.modifier_func?\r\n        @pilot.modifier_func(stats) if @pilot?.modifier_func?\r\n\r\n        if exportObj.chassis[stats.chassis]? and exportObj.chassis[stats.chassis].modifier_func?\r\n            exportObj.chassis[stats.chassis].modifier_func(stats)\r\n\r\n        stats\r\n\r\n    validate: ->\r\n        # while we load a squad we defer the validation to after everything is loaded, as there might be a lot of mutual dependencies.\r\n        if @builder.isCurrentlyLoadingSquad\r\n            return true\r\n        # Remove addons that violate their validation functions (if any) one by one until everything checks out\r\n        # Returns true, if nothing has been changed, and false otherwise\r\n        # check if we are an empty selection, which is always valid\r\n        if not @pilot?\r\n            return true \r\n        unchanged = true\r\n        max_checks = 8 # that's a lot of addons\r\n        \r\n        if @builder.isEpic #Command Epic adding\r\n            if @pilot.slots? and not (\"Command\" in @pilot.slots)\r\n                addCommand = true\r\n                for upgrade in @upgrades\r\n                    if (\"Command\" == upgrade.slot) and (this == upgrade.ship)\r\n                        addCommand = false\r\n                if addCommand == true\r\n                    @upgrades.push new exportObj.Upgrade\r\n                        ship: this\r\n                        container: @addon_container\r\n                        slot: \"Command\"\r\n        else if !@builder.isQuickbuild #cleanup Command upgrades\r\n            for i in [@upgrades.length - 1 ... -1]\r\n                upgrade = @upgrades[i]\r\n                if upgrade.slot == \"Command\"\r\n                    upgrade.destroy $.noop\r\n                    @upgrades.splice i,1\r\n\r\n        for i in [0...max_checks]\r\n            valid = true\r\n            pilot_func = @pilot?.validation_func ? @pilot?.restriction_func ? undefined\r\n            pilot_upgrades_check = @pilot.upgrades?\r\n            if (pilot_func? and not pilot_func(this, @pilot)) or not (@builder.isItemAvailable(@pilot, true))\r\n                # we go ahead and happily remove ourself. Of course, when calling a method like validate on an object, you have to expect that it will dissappear, right?\r\n                @builder.removeShip this \r\n                return false # no need to check anything further, as we do not exist anymore \r\n            # everything is limited in X-Wing 2.0, so we need to check if any upgrade is equipped more than once\r\n            equipped_upgrades = []\r\n            @upgrade_points_total = 0\r\n            for upgrade in @upgrades\r\n                meets_restrictions = true\r\n                if not pilot_upgrades_check\r\n                    func = upgrade?.data?.validation_func ? undefined\r\n                    if func?\r\n                        meets_restrictions = meets_restrictions and upgrade?.data?.validation_func(this, upgrade)\r\n                    # moved occupied slots off of validation func\r\n                    if @builder.isBeta and upgrade?.data?.also_occupies_upgrades_beta?\r\n                        for upgradeslot in upgrade.data.also_occupies_upgrades_beta\r\n                            if not upgrade.occupiesAnUpgradeSlot(upgradeslot)\r\n                                # perhaps the upgrade simply does not occupy the required slots, because the slots\r\n                                # did not (yet) exist when the upgrade was added - so we give it another chance\r\n                                upgrade.deoccupyOtherUpgrades()\r\n                                upgrade.occupyOtherUpgrades()\r\n                                # now we try again and keep the result (if we are not in this if branch, we don't need to change meets_restrictions\r\n                                meets_restrictions = meets_restrictions and upgrade.occupiesAnUpgradeSlot(upgradeslot)\r\n                    else\r\n                        if upgrade?.data?.also_occupies_upgrades?\r\n                            for upgradeslot in upgrade.data.also_occupies_upgrades\r\n                                if not upgrade.occupiesAnUpgradeSlot(upgradeslot)\r\n                                    # perhaps the upgrade simply does not occupy the required slots, because the slots\r\n                                    # did not (yet) exist when the upgrade was added - so we give it another chance\r\n                                    upgrade.deoccupyOtherUpgrades()\r\n                                    upgrade.occupyOtherUpgrades()\r\n                                    # now we try again and keep the result (if we are not in this if branch, we don't need to change meets_restrictions)\r\n                                    meets_restrictions = meets_restrictions and upgrade.occupiesAnUpgradeSlot(upgradeslot)\r\n\r\n                    restrictions = if upgrade?.data?.restrictionsbeta? and @builder.isBeta then upgrade?.data?.restrictionsbeta else upgrade?.data?.restrictions ? undefined\r\n                    # always perform this check, even if no special restrictions for this upgrade exists, to check for allowed points\r\n                    meets_restrictions = meets_restrictions and @restriction_check(restrictions, upgrade, upgrade.getPoints(), @upgrade_points_total)\r\n\r\n                # ignore those checks if this is a pilot with upgrades or quickbuild\r\n                if (not meets_restrictions or (upgrade?.data? and (upgrade.data in equipped_upgrades or (upgrade.data.faction? and not @builder.isOurFaction(upgrade.data.faction,@pilot.faction)) or not @builder.isItemAvailable(upgrade.data)))) and not pilot_upgrades_check and not @builder.isQuickbuild\r\n                    console.log \"Invalid upgrade: #{upgrade?.data?.name} on pilot #{@pilot?.name}\"\r\n                    await upgrade.setById null\r\n                    valid = false\r\n                    unchanged = false\r\n                    break\r\n                if upgrade?.data? and upgrade.data\r\n                    equipped_upgrades.push(upgrade?.data)\r\n                @upgrade_points_total += upgrade.getPoints()\r\n            break if valid\r\n        @updateSelections()\r\n        unchanged\r\n\r\n    checkUnreleasedContent: ->\r\n        if @pilot? and not exportObj.isReleased @pilot\r\n            #console.log \"#{@pilot.name} is unreleased\"\r\n            return true\r\n\r\n        for upgrade in @upgrades\r\n            if upgrade?.data? and (not exportObj.isReleased upgrade.data) and (not upgrade.data.standard?)\r\n                #console.log \"#{upgrade.data.id} is unreleased\"\r\n                return true\r\n\r\n        false\r\n\r\n    hasAnotherUnoccupiedSlotLike: (upgrade_obj, upgradeslot) ->\r\n        for upgrade in @upgrades\r\n            continue if upgrade == upgrade_obj or not exportObj.slotsMatching(upgrade.slot, upgradeslot) or upgrade.slot == \"HardpointShip\" or upgrade.slot == \"VersatileShip\"\r\n            return true unless upgrade.isOccupied()\r\n        false\r\n\r\n    hasFilledSlotLike: (upgrade_obj, upgradeslot) ->\r\n        for upgrade in @upgrades\r\n            continue if upgrade == upgrade_obj or not exportObj.slotsMatching(upgrade.slot, upgradeslot)\r\n            if upgrade.isOccupied()\r\n                return true\r\n        false\r\n\r\n\r\n    restriction_check: (restrictions, upgrade_obj, points = 0, current_upgrade_points = 0, upgrade_data = undefined) ->\r\n        effective_stats = @effectiveStats()\r\n        if @pilot.loadout?\r\n            loadout = effective_stats.loadout\r\n            if (points + current_upgrade_points > loadout)\r\n                return false\r\n        if restrictions?\r\n            for r in restrictions\r\n                switch r[0]\r\n                    when \"FactionOrUnique\"\r\n                        if @pilot.faction != r[2] and not @checkListForUnique(r[1].toLowerCase().replace(/[^0-9a-z]/gi, '').replace(/\\s+/g, '-')) then return false\r\n                    when \"Base\"\r\n                        check = false\r\n                        for b in r\r\n                            if b == \"Base\" then continue\r\n                            if b.startsWith(\"Non-\") then base = b.substring(4) else base = b # check if its an non- case then remove the non-\r\n                            switch base\r\n                                when \"Small\"\r\n                                    if not @data.base? then check = true\r\n                                when \"Standard\"\r\n                                    if not (@data.base? and @data.base == \"Huge\") then check = true\r\n                                else\r\n                                    if @data.base? and @data.base == base then check = true\r\n                            if b != base then check = !check # invert results for non- result\r\n                            if check == true then break\r\n                        if check == false then return false\r\n                    when \"Action\"\r\n                        if r[1].startsWith(\"W-\")\r\n                            w = r[1].substring(2)\r\n                            if w not in effective_stats.actions then return false\r\n                        else\r\n                            check = false\r\n                            for action in effective_stats.actions\r\n                                if action.includes(r[1]) and not action.includes(\">\")\r\n                                    check = true\r\n                            if check is false then return false\r\n                    when \"Keyword\"\r\n                        if not (@checkKeyword(r[1])) then return false\r\n                    when \"Equipped\"\r\n                        if not ((@doesSlotExist(r[1]) and @hasFilledSlotLike(upgrade_obj, r[1]))) then return false\r\n                    when \"Slot\"\r\n                        if (not @hasAnotherUnoccupiedSlotLike(upgrade_obj, r[1]) and not upgrade_obj?.occupiesAnUpgradeSlot?(r[1])) or  upgrade_obj.slot == \"HardpointShip\" or  upgrade_obj.slot == \"VersatileShip\"  then return false\r\n                    when \"AttackArc\"\r\n                        if not @data.attackb? then return false\r\n                    when \"ShieldsGreaterThan\"\r\n                        if not (@data.shields > r[1]) then return false\r\n                    when \"EnergyGreatterThan\"\r\n                        if not (effective_stats.energy > r[1]) then return false\r\n                    when \"InitiativeGreaterThan\"\r\n                        if not (@pilot.skill > r[1]) then return false\r\n                    when \"InitiativeLessThan\"\r\n                        if not (@pilot.skill < r[1]) then return false\r\n                    when \"HasForce\"\r\n                        if @pilot.force? != r[1] then false\r\n                    when \"AgilityEquals\"\r\n                        if not (effective_stats.agility == r[1]) then return false\r\n                    when \"isUnique\"\r\n                        if r[1] != (@pilot.unique? or @pilot.max_per_squad? or @pilot.restricted?) then return false\r\n                    when \"Format\"\r\n                        switch r[1]\r\n                            when \"Epic\"\r\n                                if not (@data.name in exportObj.epicExclusionsList) then return false\r\n                            when \"Standard\"\r\n                                if @data.name in exportObj.epicExclusionsList then return false\r\n        return true\r\n\r\n    standardized_check: (upgrade_data) ->\r\n        # condition checks\r\n        checkstandard = false\r\n        if @builder.isBeta\r\n            if upgrade_data.standardizedbeta?\r\n                checkstandard = upgrade_data.standardizedbeta\r\n        else \r\n            if upgrade_data.standardized?\r\n                checkstandard = true\r\n\r\n        if checkstandard\r\n            for ship in @builder.ships\r\n                if ship?.data? and ship.data.name == @data.name\r\n                    if @builder.isBeta\r\n                        if upgrade_data.restrictionsbeta? then restrictions = upgrade_data.restrictionsbeta else (if upgrade_data.restrictions? then restrictions = upgrade_data.restrictions)\r\n                    if restrictions? and ship.restriction_check(restrictions, upgrade_data) and not (ship.pilot?.upgrades?)\r\n                        if ship.pilot.loadout? and (upgrade_data.points + ship.upgrade_points_total > ship.pilot.loadout)\r\n                            return false\r\n                        slotfree = false\r\n                        for upgrade in ship.upgrades\r\n                            if upgrade_data.slot == upgrade.slot and not upgrade.data?\r\n                                slotfree = true\r\n                        if slotfree == false\r\n                            return false\r\n        return true\r\n\r\n    doesSlotExist: (slot) ->\r\n        for upgrade in @upgrades\r\n            if exportObj.slotsMatching(upgrade.slot, slot)\r\n                return true\r\n        false\r\n    \r\n    isSlotOccupied: (slot_name) ->\r\n        for upgrade in @upgrades\r\n            if exportObj.slotsMatching(upgrade.slot, slot_name)\r\n                return true unless upgrade.isOccupied()\r\n        false\r\n\r\n    checkKeyword: (keyword) ->\r\n        if @data.name?.includes(keyword)\r\n            return true\r\n        if @pilot.chassis?\r\n            if @pilot.chassis == keyword\r\n                return true\r\n        else \r\n            if @data.chassis? and @data.chassis == keyword\r\n                return true\r\n        for words in @data.keyword ? []\r\n            if words == keyword\r\n                return true\r\n        for words in @pilot.keyword ? []\r\n            if words == keyword\r\n                return true\r\n        for upgrade in @upgrades\r\n            if upgrade.chassis? and upgrade.chassis == keyword\r\n                return true\r\n            for word in upgrade?.data?.keyword ? []\r\n                if word == keyword\r\n                    return true\r\n        false\r\n\r\n    checkListForUnique: (name) ->\r\n        for t, things of @builder.uniques_in_use\r\n            if t != 'Slot'\r\n                return true if name in (thing.canonical_name.getXWSBaseName() for thing in things)\r\n        false\r\n\r\n    toXWS: ->\r\n        xws =\r\n            id: (@pilot.xws ? @pilot.canonical_name)\r\n            name: (@pilot.xws ? @pilot.canonical_name) # name is no longer part of xws 2.0.0, and was replaced by id. However, we will add it here for some kind of backward compatibility. May be removed, as soon as everybody is using id. \r\n            points: @getPoints()\r\n            #ship: @data.canonical_name\r\n            ship: @data.name.canonicalize()\r\n\r\n        if @data.multisection\r\n            xws.multisection = @data.multisection.slice 0\r\n\r\n        upgrade_obj = {}\r\n\r\n        if not @pilot.upgrades\r\n            for upgrade in @upgrades\r\n                if upgrade?.data?\r\n                    upgrade.toXWS upgrade_obj\r\n\r\n        if Object.keys(upgrade_obj).length > 0\r\n            xws.upgrades = upgrade_obj\r\n\r\n        xws\r\n\r\n    getConditions: ->\r\n        if Set?\r\n            conditions = new Set()\r\n            if @pilot?.applies_condition?\r\n                if @pilot.applies_condition instanceof Array\r\n                    for condition in @pilot.applies_condition\r\n                        conditions.add(exportObj.conditionsByCanonicalName[condition])\r\n                else\r\n                    conditions.add(exportObj.conditionsByCanonicalName[@pilot.applies_condition])\r\n            for upgrade in @upgrades\r\n                if upgrade?.data?.applies_condition?\r\n                    if upgrade.data.applies_condition instanceof Array\r\n                        for condition in upgrade.data.applies_condition\r\n                            conditions.add(exportObj.conditionsByCanonicalName[condition])\r\n                    else\r\n                        conditions.add(exportObj.conditionsByCanonicalName[upgrade.data.applies_condition])\r\n            conditions\r\n        else\r\n            console.warn 'Set not supported in this JS implementation, not implementing conditions'\r\n            []\r\n\r\nclass GenericAddon\r\n    constructor: (args) ->\r\n        # args\r\n        @ship = args.ship\r\n        @container = $ args.container\r\n\r\n        # internal state\r\n        @data = null\r\n        @unadjusted_data = null\r\n        @conferredAddons = []\r\n        @serialization_code = 'X'\r\n        @occupied_by = null\r\n        @occupying = []\r\n        @destroyed = false\r\n\r\n        # Overridden by children\r\n        @type = null\r\n        @dataByName = null\r\n        @dataById = null\r\n\r\n        @adjustment_func = args.adjustment_func if args.adjustment_func?\r\n        @filter_func = args.filter_func if args.filter_func?\r\n        @placeholderMod_func = if args.placeholderMod_func? then args.placeholderMod_func else (x) => x\r\n\r\n    destroy: (cb, args...) ->\r\n        return cb(args) if @destroyed\r\n        if @data?.unique?\r\n            await new Promise((resolve,reject) =>@ship.builder.container.trigger 'xwing:releaseUnique', [ @data, @type, resolve ])\r\n        if @isStandardized()\r\n            isLastShip = true\r\n            for ship in @ship.builder.ships\r\n                if ship.data? and (@ship.data.name == ship.data.name) and (@ship != ship)\r\n                    isLastShip = false\r\n            if isLastShip == true\r\n                @ship.removeStandardizedList(@data)\r\n        @destroyed = true\r\n        @rescindAddons()\r\n        @deoccupyOtherUpgrades()\r\n        @selector.select2 'destroy'\r\n        @selectorwrap.remove()\r\n        cb args\r\n\r\n    isStandardized: ->\r\n        if @ship.builder.isBeta\r\n            if @data?.standardizedbeta?\r\n                return @data.standardizedbeta\r\n        if @data?.standardized?\r\n            return true\r\n        return false\r\n\r\n    setupSelector: (args) ->\r\n        @selectorwrap = $ document.createElement 'div'\r\n        @selectorwrap.addClass 'form-group d-flex upgrade-box'\r\n        \r\n        @selector = $ document.createElement 'INPUT'\r\n        @selector.attr 'type', 'hidden'\r\n\r\n        @selectorwrap.append @selector\r\n        @selectorwrap.append $.trim '''\r\n            <div class=\"input-group-addon\">\r\n                <button class=\"btn btn-secondary d-block d-md-none upgrade-query-modal\"><i class=\"fas fa-question\"></i></button>\r\n            </div>\r\n        '''\r\n        @upgrade_query_modal = $ @selectorwrap.find('button.upgrade-query-modal')\r\n        \r\n        @container.append @selectorwrap\r\n        args.minimumResultsForSearch = -1 if $.isMobile()\r\n        args.formatResultCssClass = (obj) =>\r\n            if @ship.builder.collection?\r\n                not_in_collection = false\r\n                if obj.id == @data?.id\r\n                    # Currently selected card; mark as not in collection if it's neither\r\n                    # on the shelf nor on the table\r\n                    unless (@ship.builder.collection.checkShelf(@type.toLowerCase(), obj.name) or @ship.builder.collection.checkTable(@type.toLowerCase(), obj.name)) \r\n                        not_in_collection = true\r\n                else\r\n                    # Not currently selected; check shelf only\r\n                    not_in_collection = not @ship.builder.collection.checkShelf(@type.toLowerCase(), obj.name)\r\n                if not_in_collection then 'select2-result-not-in-collection' else ''\r\n            else\r\n                ''\r\n        \r\n        args.formatSelection = (obj, container) =>\r\n            icon = switch @type\r\n                when 'Upgrade'\r\n                    @slot.toLowerCase().replace(/[^0-9a-z]/gi, '')\r\n                else\r\n                    @type.toLowerCase().replace(/[^0-9a-z]/gi, '')\r\n                    \r\n            icon = icon.replace(\"configuration\", \"config\")\r\n                        .replace(\"force\", \"forcepower\")\r\n                \r\n            # Append directly so we don't have to disable markup escaping\r\n            $(container).append \"\"\"<i class=\"xwing-miniatures-font xwing-miniatures-font-#{icon}\"></i> #{obj.text}\"\"\"\r\n            # If you return a string, Select2 will render it\r\n            undefined\r\n\r\n        @selector.select2 args\r\n        \r\n        @upgrade_query_modal.click (e) =>\r\n            if @data\r\n                # console.log \"#{@data.name}\"\r\n                @ship.builder.showTooltip 'Addon', @data, ({addon_type: @type} if @data?) , @ship.builder.mobile_tooltip_modal, true\r\n                @ship.builder.mobile_tooltip_modal.modal 'show'\r\n\r\n        @selector.on 'select2-focus', (e) =>\r\n            if $.isMobile()\r\n                $('.select2-container .select2-focusser').remove()\r\n                $('.select2-search input').prop('focus',false).removeClass('select2-focused')\r\n        @selector.on 'change', (e) =>\r\n            @setById @selector.select2('val')\r\n            @ship.builder.current_squad.dirty = true\r\n            @ship.builder.container.trigger 'xwing-backend:squadDirtinessChanged'\r\n            @ship.builder.backend_status.fadeOut 'slow'\r\n        @selector.data('select2').results.on 'mousemove-filtered', (e) =>\r\n            select2_data = $(e.target).closest('.select2-result').data 'select2-data'\r\n            @ship.builder.showTooltip 'Addon', @dataById[select2_data.id], {addon_type: @type} if select2_data?.id?\r\n        @selector.data('select2').container.on 'mouseover', (e) =>\r\n            @ship.builder.showTooltip 'Addon', @data, {addon_type: @type} if @data?\r\n\r\n    setById: (id) ->\r\n        @setData @dataById[parseInt id]\r\n\r\n    setByName: (name) ->\r\n        @setData @dataByName[$.trim name]\r\n\r\n    setData: (new_data) ->\r\n        if new_data?.id != @data?.id\r\n            if @data?.unique? or @data?.solitary?\r\n                await new Promise((resolve,reject) => @ship.builder.container.trigger 'xwing:releaseUnique', [ @unadjusted_data, @type, resolve ])\r\n            if @isStandardized() and not @ship.hasFixedUpgrades\r\n                @ship.removeStandardizedList(@data)\r\n            await @rescindAddons()\r\n            @deoccupyOtherUpgrades()\r\n            if new_data?.unique? or new_data?.solitary?\r\n                try\r\n                    await new Promise((resolve,reject) => @ship.builder.container.trigger 'xwing:claimUnique', [ new_data, @type, resolve ])\r\n                catch alreadyClaimed\r\n                    @ship.builder.container.trigger 'xwing:pointsUpdated'\r\n                    @lastSetValid = false\r\n                    return\r\n            # Need to make a copy of the data, but that means I can't just check equality\r\n            @data = @unadjusted_data = new_data\r\n\r\n            if @data?\r\n                if @data.superseded_by_id\r\n                    return @setById @data.superseded_by_id\r\n                if @adjustment_func?\r\n                    @data = @adjustment_func(@data)\r\n                if not @ship.pilot?.upgrades?\r\n                    @unequipOtherUpgrades()\r\n                    @occupyOtherUpgrades()\r\n                    @conferAddons()\r\n                if @isStandardized() and not @ship.hasFixedUpgrades\r\n                    @ship.addToStandardizedList(@data)\r\n            else\r\n                @deoccupyOtherUpgrades()\r\n\r\n            # this will remove not allowed upgrades (is also done on pointsUpdated). We do it explicitly so we can tell if the setData was successfull\r\n            await @lastSetValid = @ship.validate()\r\n            @ship.builder.container.trigger 'xwing:pointsUpdated'\r\n\r\n    conferAddons: ->\r\n        if @data.confersAddons? and !@ship.builder.isQuickbuild and @data.confersAddons.length > 0\r\n            for addon in @data.confersAddons\r\n                cls = addon.type\r\n                args =\r\n                    ship: @ship\r\n                    container: @container\r\n                args.slot = addon.slot if addon.slot?\r\n                args.adjustment_func = addon.adjustment_func if addon.adjustment_func?\r\n                args.filter_func = addon.filter_func if addon.filter_func?\r\n                args.auto_equip = addon.auto_equip if addon.auto_equip?\r\n                args.placeholderMod_func = addon.placeholderMod_func if addon.placeholderMod_func?\r\n                addon = new cls args\r\n                if addon instanceof exportObj.Upgrade\r\n                    @ship.upgrades.push addon\r\n                else\r\n                    throw new Error(\"Unexpected addon type for addon #{addon}\")\r\n                @conferredAddons.push addon\r\n        if @data.chassis? and !@ship.builder.isQuickbuild and exportObj.chassis[@data.chassis].conferredAddons?\r\n            for addon in exportObj.chassis[@data.chassis].conferredAddons\r\n                cls = addon.type\r\n                args =\r\n                    ship: @ship\r\n                    container: @container\r\n                args.slot = addon.slot if addon.slot?\r\n                args.adjustment_func = addon.adjustment_func if addon.adjustment_func?\r\n                args.filter_func = addon.filter_func if addon.filter_func?\r\n                args.auto_equip = addon.auto_equip if addon.auto_equip?\r\n                args.placeholderMod_func = addon.placeholderMod_func if addon.placeholderMod_func?\r\n                addon = new cls args\r\n                if addon instanceof exportObj.Upgrade\r\n                    @ship.upgrades.push addon\r\n                else\r\n                    throw new Error(\"Unexpected addon type for addon #{addon}\")\r\n                @conferredAddons.push addon\r\n                \r\n    rescindAddons: ->\r\n        destroyed_addons = []\r\n        for addon in @conferredAddons\r\n            destroyed_addons.push(new Promise ((resolve,reject) => addon.destroy resolve))\r\n        await Promise.all destroyed_addons\r\n        for addon in @conferredAddons\r\n            if addon instanceof exportObj.Upgrade\r\n                @ship.upgrades.removeItem addon\r\n            else\r\n                throw new Error(\"Unexpected addon type for addon #{addon}\")\r\n        @conferredAddons = []\r\n\r\n    getPoints: (data = @data, ship = @ship) ->\r\n        # Moar special case jankiness\r\n        if @ship?.builder.isBeta and data?.pointsbeta?\r\n            points = data.pointsbeta\r\n        else \r\n            points = data?.points ? 0\r\n\r\n        if Array.isArray(points)\r\n            switch data.variablepoints\r\n                when \"Agility\"\r\n                    points[ship.data.agility]\r\n                when \"Base\"\r\n                    if ship?.data.base?\r\n                        switch ship.data.base\r\n                            when \"Medium\"\r\n                                points[1]\r\n                            when \"Large\"\r\n                                points[2]\r\n                            when \"Huge\"\r\n                                points[3]\r\n                    else\r\n                        points[0]\r\n                when \"Initiative\"\r\n                    points[ship.pilot.skill]\r\n                when \"Faction\"\r\n                    points[data.faction.indexOf(ship.builder.faction)]\r\n        else\r\n            points\r\n            \r\n    updateSelection: (points) ->\r\n        if @data?\r\n            @selector.select2 'data',\r\n            id: @data.id\r\n            text: \"#{if @data.display_name then @data.display_name else @data.name} (#{points}#{if @data.variablepoints then '*' else ''})\"\r\n        else\r\n            @selector.select2 'data', null\r\n\r\n    toString: ->\r\n        if @data?\r\n            \"#{if @data.display_name then @data.display_name else @data.name} (#{@getPoints()})\"\r\n        else\r\n            \"No #{@type}\"\r\n\r\n    toHTML: (points) ->\r\n        if @data?\r\n            if @data.slot? and @data.slot == \"HardpointShip\"\r\n                upgrade_slot_font = \"hardpoint\"\r\n            else\r\n                upgrade_slot_font = (@data.slot ? @type).toLowerCase().replace(/[^0-9a-z]/gi, '')\r\n\r\n            match_array = @data.text?match(/(<span.*<\\/span>)<br \\/><br \\/>(.*)/)\r\n\r\n            if match_array\r\n                restriction_html = '<div class=\"card-restriction-container\">' + match_array[1] + '</div>'\r\n                text_str = match_array[2]\r\n            else\r\n                restriction_html = ''\r\n                text_str = @data.text\r\n\r\n            attackHTML = \"\"\r\n            if @data.range?\r\n                attackrangebonus = if (@data.rangebonus?) then \"\"\"<span class=\"upgrade-attack-rangebonus\"><i class=\"xwing-miniatures-font xwing-miniatures-font-rangebonusindicator\"></i></span>\"\"\" else ''\r\n                attackStats = $.trim \"\"\"\r\n                        <span class=\"upgrade-attack-range\">#{@data.range}</span>\r\n                        #{attackrangebonus}\r\n                \"\"\"\r\n                attackIcon = if (@data.attack?) then $.trim \"\"\"\r\n                        <span class=\"info-data info-attack\">#{@data.attack}</span>\r\n                        <i class=\"xwing-miniatures-font xwing-miniatures-font-frontarc\"></i>\r\n                \"\"\" else if (@data.attackf?) then $.trim \"\"\"\r\n                        <span class=\"info-data info-attack\">#{@data.attackf}</span>\r\n                        <i class=\"xwing-miniatures-font xwing-miniatures-font-fullfrontarc\"></i>\r\n                \"\"\" else if (@data.attackb?) then $.trim \"\"\"\r\n                        <span class=\"info-data info-attack\">#{@data.attackb}</span>\r\n                        <i class=\"xwing-miniatures-font xwing-miniatures-font-backarc\"></i>\r\n                \"\"\" else if (@data.attackt?) then $.trim \"\"\"\r\n                        <span class=\"info-data info-attack\">#{@data.attackt}</span>\r\n                        <i class=\"xwing-miniatures-font xwing-miniatures-font-singleturretarc\"></i>\r\n                \"\"\" else if (@data.attackdt?) then $.trim \"\"\"\r\n                        <span class=\"info-data info-attack\">#{@data.attackdt}</span>\r\n                        <i class=\"xwing-miniatures-font xwing-miniatures-font-doubleturretarc\"></i>\r\n                \"\"\" else if (@data.attackl?) then $.trim \"\"\"\r\n                        <span class=\"info-data info-attack\">#{@data.attackl}</span>\r\n                        <i class=\"xwing-miniatures-font xwing-miniatures-font-leftarc\"></i>\r\n                \"\"\" else if (@data.attackr?) then $.trim \"\"\"\r\n                        <span class=\"info-data info-attack\">#{@data.attackr}</span>\r\n                        <i class=\"xwing-miniatures-font xwing-miniatures-font-rightarc\"></i>\r\n                \"\"\" else if (@data.attackbull?) then $.trim \"\"\"\r\n                        <span class=\"info-data info-attack\">#{@data.attackbull}</span>\r\n                        <i class=\"xwing-miniatures-font xwing-miniatures-font-bullseyearc\"></i>\r\n                \"\"\" else ''\r\n                attackHTML = $.trim \"\"\"\r\n                    <div class=\"upgrade-attack\">\r\n                        #{attackStats}\r\n                        #{attackIcon}\r\n                    </div>\r\n                \"\"\"\r\n\r\n            if @data.charge?\r\n                recurringicon = ''\r\n                if  @data.recurring?\r\n                    if @data.recurring > 0\r\n                        count = 0\r\n                        while count < @data.recurring\r\n                            recurringicon += '<sup><i class=\"fas fa-caret-up\"></i></sup>'\r\n                            ++count\r\n                    else\r\n                        count = @data.recurring\r\n                        while count < 0\r\n                            recurringicon += '<sub><i class=\"fas fa-caret-down\"></i></sub>'\r\n                            ++count\r\n                chargeHTML = $.trim \"\"\"\r\n                    <div class=\"upgrade-charge\">\r\n                        <span class=\"info-data info-charge\">#{@data.charge}</span>\r\n                        <i class=\"xwing-miniatures-font xwing-miniatures-font-charge\"></i>#{recurringicon}\r\n                    </div>\r\n                    \"\"\"\r\n            else chargeHTML = $.trim ''\r\n\r\n            if (@data.force?)\r\n                forcerecurring = 1\r\n                if @data.forcerecurring?\r\n                    forcerecurring = @data.forcerecurring\r\n                count = 0\r\n                recurringicon = ''\r\n                while count < forcerecurring\r\n                    recurringicon += '<sup><i class=\"fas fa-caret-up\"></i></sup>'\r\n                    ++count\r\n                forceHTML = $.trim \"\"\"\r\n                    <div class=\"upgrade-force\">\r\n                        <span class=\"info-data info-force\">#{@data.force}</span>\r\n                        <i class=\"xwing-miniatures-font xwing-miniatures-font-forcecharge\"></i>#{recurringicon}\r\n                    </div>\r\n                    \"\"\"\r\n            else forceHTML = $.trim ''\r\n            \r\n            $.trim \"\"\"\r\n                <div class=\"upgrade-container\">\r\n                    <div class=\"upgrade-stats\">\r\n                        <div class=\"upgrade-name\"><i class=\"xwing-miniatures-font xwing-miniatures-font-#{upgrade_slot_font}\"></i>#{if @data.display_name then @data.display_name else @data.name}</div>\r\n                        <div class=\"mask\">\r\n                            <div class=\"outer-circle\">\r\n                                <div class=\"inner-circle upgrade-points\">#{points}</div>\r\n                            </div>\r\n                        </div>\r\n                        #{restriction_html}\r\n                    </div>\r\n                    #{attackHTML}\r\n                    #{chargeHTML}\r\n                    #{forceHTML}\r\n                    <div class=\"upgrade-text\">#{text_str}</div>\r\n                    <div style=\"clear: both;\"></div>\r\n                </div>\r\n            \"\"\"\r\n        else\r\n            ''\r\n\r\n    toTableRow: (points) ->\r\n        if @data?\r\n            $.trim \"\"\"\r\n                <tr class=\"simple-addon\">\r\n                    <td class=\"name\">#{if @data.display_name then @data.display_name else @data.name}</td>\r\n                    <td class=\"points\">#{points}</td>\r\n                </tr>\r\n            \"\"\"\r\n        else\r\n            ''\r\n\r\n    toSimpleCopy: (points) ->\r\n        if @data?\r\n            \"\"\"#{@data.name} (#{points})    \\n\"\"\"\r\n        else\r\n            null\r\n            \r\n    toRedditText: (points) ->\r\n        if @data?\r\n            \"\"\"*&nbsp;#{@data.name} (#{points})*    \\n\"\"\"\r\n        else\r\n            null\r\n\r\n    toTTSText: () ->\r\n        if @data?\r\n            \"\"\"#{exportObj.toTTS(@data.name)}\"\"\"\r\n        else\r\n            null\r\n\r\n    toSerialized: ->\r\n        \"\"\"#{@serialization_code}.#{@data?.id ? -1}\"\"\"\r\n\r\n    unequipOtherUpgrades: ->\r\n        for slot in @data?.unequips_upgrades ? []\r\n            for upgrade in @ship.upgrades\r\n                continue if not exportObj.slotsMatching(upgrade.slot, slot) or upgrade == this or not upgrade.isOccupied()\r\n                upgrade.setData null\r\n                break\r\n\r\n    isOccupied: ->\r\n        @data? or @occupied_by?\r\n\r\n    occupyOtherUpgrades: ->\r\n        checkupgrades = []\r\n        if @ship.builder.isBeta and @data?.also_occupies_upgrades_beta?\r\n            checkupgrades = @data?.also_occupies_upgrades_beta\r\n        else\r\n            if @data?.also_occupies_upgrades?\r\n                checkupgrades = @data?.also_occupies_upgrades\r\n\r\n        for slot in checkupgrades\r\n            for upgrade in @ship.upgrades\r\n                continue if not exportObj.slotsMatching(upgrade.slot, slot) or upgrade == this or upgrade.isOccupied()\r\n                @occupy upgrade\r\n                break\r\n\r\n    deoccupyOtherUpgrades: ->\r\n        for upgrade in @occupying\r\n            @deoccupy upgrade\r\n\r\n    occupy: (upgrade) ->\r\n        upgrade.occupied_by = this\r\n        upgrade.selector.select2 'enable', false\r\n        @occupying.push upgrade\r\n\r\n    deoccupy: (upgrade) ->\r\n        upgrade.occupied_by = null\r\n        upgrade.selector.select2 'enable', true\r\n\r\n    occupiesAnUpgradeSlot: (upgradeslot) ->\r\n        for upgrade in @ship.upgrades\r\n            continue if not exportObj.slotsMatching(upgrade.slot, upgradeslot) or upgrade == this or upgrade.data?\r\n            if upgrade.occupied_by? and upgrade.occupied_by == this\r\n                return true\r\n        false\r\n\r\n    toXWS: (upgrade_dict) ->\r\n        (upgrade_dict[exportObj.toXWSUpgrade[@data.slot] ? @data.slot.canonicalize()] ?= []).push (@data.xws ? @data.canonical_name)\r\n\r\nclass exportObj.Upgrade extends GenericAddon\r\n    constructor: (args) ->\r\n        # args\r\n        super args\r\n        @slot = args.slot\r\n        @type = 'Upgrade'\r\n        @dataById = exportObj.upgradesById\r\n        @dataByName = exportObj.upgrades\r\n        @serialization_code = 'U'\r\n\r\n        @setupSelector()\r\n\r\n    setupSelector: ->\r\n        super\r\n            width: '100%'\r\n            placeholder: @placeholderMod_func(exportObj.translate 'ui', 'upgradePlaceholder', @slot)\r\n            allowClear: true\r\n            query: (query) =>\r\n                data = {results: []}\r\n                data.results = @ship.builder.getAvailableUpgradesIncluding(@slot, @data, @ship, this, query.term, @filter_func)\r\n                query.callback(data)\r\n\r\nclass exportObj.RestrictedUpgrade extends exportObj.Upgrade\r\n    constructor: (args) ->\r\n        super args\r\n        @serialization_code = 'u'\r\n        if args.auto_equip?\r\n            @setById args.auto_equip\r\n\r\nclass exportObj.QuickbuildUpgrade extends GenericAddon\r\n    constructor: (args) ->\r\n        super args\r\n        @slot = args.slot\r\n        @type = 'Upgrade'\r\n        @dataById = exportObj.upgradesById\r\n        @dataByName = exportObj.upgrades\r\n        @serialization_code = 'U'\r\n        @upgrade = args.upgrade\r\n        @setupSelector()\r\n\r\n    setupSelector: ->\r\n        super\r\n            width: '100%'\r\n            allowClear: false\r\n            query: (query) =>\r\n                data = {\r\n                    results: [{\r\n                            id: @upgrade.id\r\n                            text: if @upgrade.display_name then @upgrade.display_name else @upgrade.name\r\n                            points: 0\r\n                            name: @upgrade.name\r\n                            display_name: @upgrade.display_name\r\n                        }]\r\n                }\r\n                query.callback(data)\r\n\r\n    getPoints: (args) ->\r\n        0\r\n            \r\n    updateSelection: (args) ->\r\n        if @data?\r\n            @selector.select2 'data',\r\n            id: @data.id\r\n            text: \"#{if @data.display_name then @data.display_name else @data.name}\"\r\n        else\r\n            @selector.select2 'data', null\r\n            \r\n        \r\n\r\nSERIALIZATION_CODE_TO_CLASS =\r\n    'U': exportObj.Upgrade\r\n    'u': exportObj.RestrictedUpgrade\r\n\r\nexportObj = exports ? this\r\n\r\nexportObj.fromXWSFaction =\r\n    'rebelalliance': 'Rebel Alliance'\r\n    'rebels': 'Rebel Alliance'\r\n    'rebel': 'Rebel Alliance'\r\n    'galacticempire': 'Galactic Empire'\r\n    'imperial': 'Galactic Empire'\r\n    'scumandvillainy': 'Scum and Villainy'\r\n    'firstorder': 'First Order'\r\n    'resistance': 'Resistance'\r\n    'galacticrepublic': 'Galactic Republic'\r\n    'separatistalliance': 'Separatist Alliance'\r\n\r\nexportObj.toXWSFaction =\r\n    'Rebel Alliance': 'rebelalliance'\r\n    'Galactic Empire': 'galacticempire'\r\n    'Scum and Villainy': 'scumandvillainy'\r\n    'First Order': 'firstorder'\r\n    'Resistance': 'resistance'\r\n    'Galactic Republic': 'galacticrepublic'\r\n    'Separatist Alliance': 'separatistalliance'\r\n\r\nexportObj.toXWSUpgrade =\r\n    'Modification': 'modification'\r\n    'Force':'force-power'\r\n    'Tactical Relay':'tactical-relay'\r\n\r\nexportObj.fromXWSUpgrade =\r\n    'amd': 'Astromech'\r\n    'astromechdroid': 'Astromech'\r\n    'ept': 'Talent'\r\n    'elitepilottalent': 'Talent'\r\n    'system': 'Sensor'\r\n    'mod': 'Modification'\r\n    'force-power':'Force'\r\n    'tactical-relay':'Tactical Relay'\r\n\r\nSPEC_URL = 'https://github.com/elistevens/xws-spec'\r\nSQUAD_TO_XWS_URL = 'https://squad2xws.herokuapp.com/translate/'\r\n\r\nexportObj.loadXWSButton = (xws_import_modal) ->\r\n        import_status = $ xws_import_modal.find('.xws-import-status')\r\n        import_status.text exportObj.translate('ui', 'Loading...')\r\n        do (import_status) =>\r\n            loadxws = (xws) =>\r\n                $(window).trigger 'xwing:activateBuilder', [exportObj.fromXWSFaction[xws.faction], (builder) =>\r\n                    if builder.current_squad.dirty and builder.backend?\r\n                        xws_import_modal.modal 'hide'\r\n                        builder.backend.warnUnsaved builder, =>\r\n                            builder.loadFromXWS xws, (res) =>\r\n                                unless res.success\r\n                                    xws_import_modal.modal 'show'\r\n                                    import_status.text res.error\r\n                    else\r\n                        builder.loadFromXWS xws, (res) =>\r\n                            if res.success\r\n                                xws_import_modal.modal 'hide'\r\n                            else\r\n                                import_status.text res.error\r\n                ]\r\n\r\n            input = xws_import_modal.find('.xws-content').val()\r\n            try\r\n                # try if we got a JSON input\r\n                xws = JSON.parse input\r\n                loadxws(xws)\r\n            catch e\r\n                # we did not get JSON. Maybe we got an official builder link/uid\r\n                # strip everything before the last /\r\n                uuid = input.split('/').pop()\r\n                jsonurl = SQUAD_TO_XWS_URL + uuid\r\n                # let squad2xws create an xws for us and read this\r\n                ($.getJSON jsonurl, loadxws).catch((e) => import_status.text 'Invalid Input')\r\n"
  ]
}